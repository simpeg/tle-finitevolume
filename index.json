{"kind":"Notebook","sha256":"bc8f371c46461a9eb99e81e7c4588b74566fe52e44add45cd3413562ac5d023f","slug":"index","dependencies":[],"frontmatter":{"title":"Getting Started","authors":[{"name":"Rowan Cockett","orcid":"0000-0002-7859-8394","corresponding":true,"email":"rowan@curvenote.com","affiliations":["University of British Columbia"]},{"name":"Lindsey Heagy","orcid":"0000-0002-1551-5926","affiliations":["University of British Columbia"]},{"name":"Douglas Oldenburg","orcid":"0000-0002-4327-2124","affiliations":["University of British Columbia"]}],"date":"2016/08/01","doi":"10.1190/tle35080703.1","open_access":true,"license":{"content":{"id":"CC-BY-SA-3.0","name":"Creative Commons Attribution Share Alike 3.0 Unported","CC":true,"url":"https://creativecommons.org/licenses/by-sa/3.0/"},"code":{"id":"MIT","name":"MIT License","osi":true,"free":true,"url":"https://opensource.org/licenses/MIT"}},"github":"https://github.com/simpeg/tle-finitevolume","subject":"tutorial","venue":{"title":"The Leading Edge"},"thumbnail":"/tle-finitevolume/build/dc-setup-60699ff1c02250e8d02b3717177f62b0.png","exports":[{"format":"ipynb","filename":"index.ipynb","url":"/tle-finitevolume/build/index-0c4ae49f917722c25c670ce96fcbaf17.ipynb"}]},"mdast":{"type":"root","children":[{"type":"block","position":{"start":{"line":4,"column":0},"end":{"line":5,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":6,"column":0},"end":{"line":7,"column":0}},"children":[{"type":"text","value":"This notebook uses ","key":"NdR3My2ue3"},{"type":"link","url":"https://docs.python.org/3/","children":[{"type":"text","value":"Python 3.8","key":"IqSmSnn8SI"}],"urlSource":"https://docs.python.org/3/","key":"E4MgVTgs6F"},{"type":"text","value":" and the open source package ","key":"D5QyP13pm3"},{"type":"link","url":"https://simpeg.xyz","children":[{"type":"text","value":"SimPEG","key":"KUefEi1y4r"}],"urlSource":"https://simpeg.xyz","key":"MJULPswSj3"},{"type":"text","value":". ","key":"loNV3hQTWF"},{"type":"link","url":"https://simpeg.xyz","children":[{"type":"text","value":"SimPEG","key":"H0LO9UL47N"}],"urlSource":"https://simpeg.xyz","key":"hxPoLKd9As"},{"type":"text","value":" can be installed using the python package manager PyPi and running:","key":"lDKcMh8WQS"}],"key":"Lv7lCe1WXm"},{"type":"code","lang":"sh","value":"conda install SimPEG --channel conda-forge","position":{"start":{"line":8,"column":0},"end":{"line":11,"column":0}},"identifier":"nb-cell-1-code","enumerator":"1","html_id":"nb-cell-1-code","key":"m5tdFCUp25"},{"type":"paragraph","position":{"start":{"line":12,"column":0},"end":{"line":13,"column":0}},"children":[{"type":"text","value":"This tutorial consists of 3 parts, here, we introduce the problem, in ","key":"mbSA92Uaxn"},{"type":"link","url":"/divergence","children":[{"type":"text","value":"Divergence Operator","key":"YDsbASbpN7"}],"urlSource":"divergence.ipynb","internal":true,"dataUrl":"/divergence.json","protocol":"file","key":"geG1eG62jF"},{"type":"text","value":" we build the discrete divergence operator and in ","key":"ubJqxk41Sq"},{"type":"link","url":"/weak-formulation","children":[{"type":"text","value":"weak​​-formulation​​.ipynb","key":"cfW76MKJ4x"}],"urlSource":"weak-formulation.ipynb","internal":true,"dataUrl":"/weak-formulation.json","protocol":"file","key":"Wu6lvQwZYH"},{"type":"text","value":", we discretize and solve the DC equations using weak formulation.","key":"e4ddQVPcFs"}],"key":"Gnz9bcEYiW"},{"type":"paragraph","position":{"start":{"line":14,"column":0},"end":{"line":15,"column":0}},"children":[{"type":"strong","children":[{"type":"text","value":"Notebooks","key":"E4GqRVtiZT"}],"key":"WX4wPViuK6"}],"key":"pey1dkhpoO"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":15,"column":0},"end":{"line":20,"column":0}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":0},"end":{"line":16,"column":0}},"children":[{"type":"link","url":"/mesh","children":[{"type":"text","value":"Mesh","key":"p3sRlOk2Lo"}],"urlSource":"mesh.ipynb","internal":true,"dataUrl":"/mesh.json","protocol":"file","key":"eWAUqWMZ1v"}],"key":"Xhu62LYqd9"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":0},"end":{"line":17,"column":0}},"children":[{"type":"link","url":"/divergence","children":[{"type":"text","value":"Divergence","key":"yuAZxFOZVe"}],"urlSource":"divergence.ipynb","internal":true,"dataUrl":"/divergence.json","protocol":"file","key":"NzqB5pFthP"}],"key":"r5lCebputY"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":0},"end":{"line":18,"column":0}},"children":[{"type":"link","url":"/weak-formulation","children":[{"type":"text","value":"Weak forulation","key":"otXZ1sDqj8"}],"urlSource":"weak-formulation.ipynb","internal":true,"dataUrl":"/weak-formulation.json","protocol":"file","key":"a2NCQTZ7RH"}],"key":"XleI0reAzA"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":0},"end":{"line":20,"column":0}},"children":[{"type":"link","url":"/all-together-now","children":[{"type":"text","value":"All together now","key":"kdkZU034lu"}],"urlSource":"all-together-now.ipynb","internal":true,"dataUrl":"/all-together-now.json","protocol":"file","key":"kb7e90G4IL"}],"key":"EZKdT9ooAI"}],"key":"LiA6JmQBS4"}],"data":{"id":"nb-cell-1","type":"notebook-content","iooxa":null},"identifier":"nb-cell-1","label":"nb-cell-1","html_id":"nb-cell-1","key":"UVQqEFzL2x"},{"type":"block","position":{"start":{"line":20,"column":0},"end":{"line":21,"column":0}},"children":[{"type":"heading","depth":1,"position":{"start":{"line":22,"column":0},"end":{"line":23,"column":0}},"children":[{"type":"text","value":"DC Resistivity","key":"tTNhFElt7Q"}],"identifier":"dc-resistivity","label":"DC Resistivity","html_id":"dc-resistivity","implicit":true,"key":"EFTrjLINNx"}],"data":{"id":"nb-cell-2","type":"notebook-content","iooxa":null},"identifier":"nb-cell-2","label":"nb-cell-2","html_id":"nb-cell-2","key":"ImLQ0Rstol"},{"type":"block","position":{"start":{"line":24,"column":0},"end":{"line":25,"column":0}},"children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/tle-finitevolume/build/dc-setup-60699ff1c02250e8d02b3717177f62b0.png","alt":"Setup of a direct current (DC) resistivity survey.","urlSource":"../images/dc-setup.png","key":"DSyiigojem"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":27,"column":0},"end":{"line":28,"column":0}},"children":[{"type":"text","value":"Setup of a direct current (DC) resistivity survey.","key":"YN2wBnLuQc"}],"key":"JxVG1m79Wg"}],"key":"rwZ4gWHIYd"}],"enumerator":"1","key":"suR0EBEbKK"}],"data":{"id":"nb-cell-3","type":"notebook-content","iooxa":null},"identifier":"nb-cell-3","label":"nb-cell-3","html_id":"nb-cell-3","key":"Q47lKKE70g"},{"type":"block","position":{"start":{"line":30,"column":0},"end":{"line":31,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":32,"column":0},"end":{"line":33,"column":0}},"children":[{"type":"text","value":"DC resistivity surveys obtain information about subsurface electrical conductivity, ","key":"K0ZPZBkp7C"},{"type":"inlineMath","value":"\\sigma","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi></mrow><annotation encoding=\"application/x-tex\">\\sigma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span></span></span></span>","key":"YmvqD739ia"},{"type":"text","value":". This physical property is often diagnostic in mineral exploration, geotechnical, environmental and hydrogeologic problems, where the target of interest has a significant electrical conductivity contrast from the background. In a DC resistivity survey, steady state currents are set up in the subsurface by injecting current through a positive electrode and completing the circuit with a return electrode.","key":"PcN1NHPE4Q"}],"key":"dgM0yOJ9mB"}],"data":{"id":"nb-cell-4","type":"notebook-content","iooxa":null},"identifier":"nb-cell-4","label":"nb-cell-4","html_id":"nb-cell-4","key":"j7V25XMiMK"},{"type":"block","position":{"start":{"line":34,"column":0},"end":{"line":35,"column":0}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":36,"column":0},"end":{"line":37,"column":0}},"children":[{"type":"text","value":"Deriving the DC equations","key":"NlTNr4ZjxZ"}],"identifier":"deriving-the-dc-equations","label":"Deriving the DC equations","html_id":"deriving-the-dc-equations","implicit":true,"key":"gVPXYfPT5Z"}],"data":{"id":"nb-cell-5","type":"notebook-content","iooxa":null},"identifier":"nb-cell-5","label":"nb-cell-5","html_id":"nb-cell-5","key":"iVyxnJ3Ycs"},{"type":"block","position":{"start":{"line":38,"column":0},"end":{"line":39,"column":0}},"children":[{"type":"container","kind":"figure","children":[{"type":"image","url":"/tle-finitevolume/build/dc-eqns-bea4f4b516178db04c015d53e09c3bdb.png","alt":"Derivation of the DC resistivity equations.","urlSource":"../images/dc-eqns.png","key":"VquKGfUc50"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":42,"column":0},"end":{"line":43,"column":0}},"children":[{"type":"text","value":"Derivation of the DC resistivity equations.","key":"P7K0o93seL"}],"key":"yhCFkylHRp"}],"key":"nGrSMErvkY"}],"enumerator":"2","key":"gabOLZf8Wz"}],"data":{"id":"nb-cell-6","type":"notebook-content","iooxa":null},"identifier":"nb-cell-6","label":"nb-cell-6","html_id":"nb-cell-6","key":"sgywvnd3aq"},{"type":"block","position":{"start":{"line":45,"column":0},"end":{"line":46,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":47,"column":0},"end":{"line":48,"column":0}},"children":[{"type":"text","value":"Conservation of charge (which can be derived by taking the divergence of Ampere’s law at steady state) connects the divergence of the current density everywhere in space to the source term which consists of two point sources, one positive and one negative. The flow of current sets up electric fields according to Ohm’s law, which relates current density to electric fields through the electrical conductivity. From Faraday’s law for steady state fields, we can describe the electric field in terms of a scalar potential, ","key":"PGXRNpapo3"},{"type":"inlineMath","value":"\\phi","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding=\"application/x-tex\">\\phi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">ϕ</span></span></span></span>","key":"QcSHox8mMC"},{"type":"text","value":", which we sample at potential electrodes to obtain data in the form of potential differences.","key":"LP1nrdG0yA"}],"key":"sfFECsYVw8"}],"data":{"id":"nb-cell-7","type":"notebook-content","iooxa":null},"identifier":"nb-cell-7","label":"nb-cell-7","html_id":"nb-cell-7","key":"UdVZ1y1Axo"},{"type":"block","position":{"start":{"line":49,"column":0},"end":{"line":50,"column":0}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":51,"column":0},"end":{"line":52,"column":0}},"children":[{"type":"text","value":"The finish line","key":"ere9qrUY0o"}],"identifier":"the-finish-line","label":"The finish line","html_id":"the-finish-line","implicit":true,"key":"cwDfPD0eZX"},{"type":"paragraph","position":{"start":{"line":52,"column":0},"end":{"line":53,"column":0}},"children":[{"type":"emphasis","children":[{"type":"text","value":"Where are we going??","key":"di3O058PQh"}],"key":"hVfrf02xFM"}],"key":"A2FmYGspK9"},{"type":"paragraph","position":{"start":{"line":54,"column":0},"end":{"line":55,"column":0}},"children":[{"type":"text","value":"Here, we are going to do a run through of how to setup and solve the DC resistivity equations for a 2D problem using ","key":"CfhS5dFhuW"},{"type":"link","url":"http://simpeg.xyz","children":[{"type":"text","value":"SimPEG","key":"u2oyOJbbh1"}],"urlSource":"http://simpeg.xyz","key":"DhjSIC3ysQ"},{"type":"text","value":". This is meant to give you a once-over of the whole picture. We will break down the steps to get here in the series of notebooks that follow...","key":"nJSc63MFu3"}],"key":"owVIu0nDmh"}],"data":{"id":"nb-cell-8","type":"notebook-content","iooxa":null},"identifier":"nb-cell-8","label":"nb-cell-8","html_id":"nb-cell-8","key":"lvblr9YotV"},{"type":"block","position":{"start":{"line":56,"column":0},"end":{"line":57,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Import numpy, python's n-dimensional array package,\n# the mesh class with differential operators from SimPEG\n# matplotlib, the basic python plotting package\nimport numpy as np\nimport discretize\nfrom SimPEG import utils\nimport matplotlib.pyplot as plt\n%matplotlib inline","identifier":"nb-cell-9-code","enumerator":"2","html_id":"nb-cell-9-code","key":"WgQ6NUwSIL"},{"type":"output","id":"f0QyHBaxyVCkxhxl7RNy0","data":[],"identifier":"nb-cell-9-output","html_id":"nb-cell-9-output","key":"c9lXyqlo5m"}],"data":{"id":"nb-cell-9","type":"notebook-code","collapsed":false,"iooxa":null,"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-9","label":"nb-cell-9","html_id":"nb-cell-9","key":"oif2p4Ga6Y"},{"type":"block","position":{"start":{"line":73,"column":0},"end":{"line":74,"column":0}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":75,"column":0},"end":{"line":76,"column":0}},"children":[{"type":"text","value":"Mesh","key":"FFZs3W2utr"}],"identifier":"mesh","label":"Mesh","html_id":"mesh","implicit":true,"key":"UT0gZ9xneP"},{"type":"paragraph","position":{"start":{"line":77,"column":0},"end":{"line":78,"column":0}},"children":[{"type":"text","value":"Where we solve things! See ","key":"fv8SfG3MVq"},{"type":"link","url":"/mesh","children":[{"type":"text","value":"Finite Volume Mesh","key":"pAlhIid15a"}],"urlSource":"mesh.ipynb","internal":true,"dataUrl":"/mesh.json","protocol":"file","key":"pgzCZq2JZC"},{"type":"text","value":" a discussion of how we construct a mesh and the associated properties we need.","key":"VJeAz2BO4W"}],"key":"T3gUvzNOOr"}],"data":{"id":"nb-cell-10","type":"notebook-content","iooxa":null,"tags":[]},"identifier":"nb-cell-10","label":"nb-cell-10","html_id":"nb-cell-10","key":"ytVCMkJj5p"},{"type":"block","position":{"start":{"line":79,"column":0},"end":{"line":80,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define a unit-cell mesh\nmesh = discretize.TensorMesh([100, 80])  # setup a mesh on which to solve\nprint(\"The mesh has {nC} cells.\".format(nC=mesh.nC))\n\nmesh.plot_grid()\nplt.axis('tight');","identifier":"nb-cell-11-code","enumerator":"3","html_id":"nb-cell-11-code","key":"ylOJYYRtlZ"},{"type":"output","id":"_ETYQJNECbeyj0fhRhLT_","data":[{"name":"stdout","output_type":"stream","text":"The mesh has 8000 cells.\n"},{"output_type":"display_data","metadata":{"needs_background":"light"},"data":{"image/png":{"content_type":"image/png","hash":"c163dfe4cc4be0504849a4c3cca57f4c","path":"/tle-finitevolume/build/c163dfe4cc4be0504849a4c3cca57f4c.png"},"text/plain":{"content":"<Figure size 432x288 with 1 Axes>","content_type":"text/plain"}}}],"identifier":"nb-cell-11-output","html_id":"nb-cell-11-output","key":"NYnGQO2vk2"}],"data":{"id":"nb-cell-11","type":"notebook-code","collapsed":false,"iooxa":null,"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-11","label":"nb-cell-11","html_id":"nb-cell-11","key":"wZ2ZeCn0cP"},{"type":"block","position":{"start":{"line":94,"column":0},"end":{"line":95,"column":0}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":96,"column":0},"end":{"line":97,"column":0}},"children":[{"type":"text","value":"Physical Property Model","key":"WEpfeOjyWB"}],"identifier":"physical-property-model","label":"Physical Property Model","html_id":"physical-property-model","implicit":true,"key":"QhC1NncMQF"},{"type":"paragraph","position":{"start":{"line":98,"column":0},"end":{"line":99,"column":0}},"children":[{"type":"text","value":"Define an electrical conductivity (","key":"iWZS1X3tSv"},{"type":"inlineMath","value":"\\sigma","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi></mrow><annotation encoding=\"application/x-tex\">\\sigma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span></span></span></span>","key":"RL1NehiNzT"},{"type":"text","value":") model, on the cell-centers of the mesh.","key":"LyBGpuP3HT"}],"key":"Y9ay61cQGr"}],"data":{"id":"nb-cell-12","type":"notebook-content","iooxa":null},"identifier":"nb-cell-12","label":"nb-cell-12","html_id":"nb-cell-12","key":"xkfDnUt5Rs"},{"type":"block","position":{"start":{"line":100,"column":0},"end":{"line":101,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"# model parameters\nsigma_background = 1.  # Conductivity of the background, S/m\nsigma_block = 10.  # Conductivity of the block, S/m\n\n# add a block to our model\nx_block = np.r_[0.4, 0.6]\ny_block = np.r_[0.4, 0.6]\n\n# assign them on the mesh\nsigma = sigma_background * np.ones(mesh.nC)  # create a physical property model \n\nblock_indices = ((mesh.gridCC[:,0] >= x_block[0]) & # left boundary\n                 (mesh.gridCC[:,0] <= x_block[1]) & # right boundary\n                 (mesh.gridCC[:,1] >= y_block[0]) & # bottom boundary\n                 (mesh.gridCC[:,1] <= y_block[1]))  # top boundary\n\n# add the block to the physical property model\nsigma[block_indices] = sigma_block\n\n# plot it!\nplt.colorbar(mesh.plot_image(sigma)[0])\nplt.title('electrical conductivity, $\\sigma$');","identifier":"nb-cell-13-code","enumerator":"4","html_id":"nb-cell-13-code","key":"upOlsDZ387"},{"type":"output","id":"dcIw5Y_oJr4MFEDLfwpZY","data":[{"output_type":"display_data","metadata":{"needs_background":"light"},"data":{"image/png":{"content_type":"image/png","hash":"49982808b04baadc7e8c4794a8c4b672","path":"/tle-finitevolume/build/49982808b04baadc7e8c4794a8c4b672.png"},"text/plain":{"content":"<Figure size 432x288 with 2 Axes>","content_type":"text/plain"}}}],"identifier":"nb-cell-13-output","html_id":"nb-cell-13-output","key":"v0v2mFHxbx"}],"data":{"id":"nb-cell-13","type":"notebook-code","collapsed":false,"iooxa":null,"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-13","label":"nb-cell-13","html_id":"nb-cell-13","key":"c9FwRfeuKi"},{"type":"block","position":{"start":{"line":131,"column":0},"end":{"line":132,"column":0}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":133,"column":0},"end":{"line":134,"column":0}},"children":[{"type":"text","value":"Define a source","key":"RCL8UjNhix"}],"identifier":"define-a-source","label":"Define a source","html_id":"define-a-source","implicit":true,"key":"UlNFersVCo"},{"type":"paragraph","position":{"start":{"line":135,"column":0},"end":{"line":136,"column":0}},"children":[{"type":"text","value":"Define location of the positive and negative electrodes","key":"MeYtipLY5C"}],"key":"aMn1QzbvPj"}],"data":{"id":"nb-cell-14","type":"notebook-content","iooxa":null},"identifier":"nb-cell-14","label":"nb-cell-14","html_id":"nb-cell-14","key":"HiEe4I2UGJ"},{"type":"block","position":{"start":{"line":137,"column":0},"end":{"line":138,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Define a source\na_loc, b_loc = np.r_[0.2, 0.5], np.r_[0.8, 0.5]\nsource_locs = [a_loc, b_loc]\n\n# locate it on the mesh\nsource_loc_inds = mesh.closest_points_index(source_locs)\na_loc_mesh = mesh.gridCC[source_loc_inds[0],:]\nb_loc_mesh = mesh.gridCC[source_loc_inds[1],:]\n\n# plot it\nplt.colorbar(mesh.plot_image(sigma)[0])\nplt.plot(a_loc_mesh[0], a_loc_mesh[1],'wv', markersize=8) # a-electrode\nplt.plot(b_loc_mesh[0], b_loc_mesh[1],'w^', markersize=8) # b-electrode\nplt.title('electrical conductivity, $\\sigma$');","identifier":"nb-cell-15-code","enumerator":"5","html_id":"nb-cell-15-code","key":"Vs8IahMein"},{"type":"output","id":"bdliidThYdUilyWmgHrE4","data":[{"output_type":"display_data","metadata":{"needs_background":"light"},"data":{"image/png":{"content_type":"image/png","hash":"a1f85eb9091e8d715d0d6584d479ec35","path":"/tle-finitevolume/build/a1f85eb9091e8d715d0d6584d479ec35.png"},"text/plain":{"content":"<Figure size 432x288 with 2 Axes>","content_type":"text/plain"}}}],"identifier":"nb-cell-15-output","html_id":"nb-cell-15-output","key":"blggFUa4Fx"}],"data":{"id":"nb-cell-15","type":"notebook-code","collapsed":false,"iooxa":null,"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-15","label":"nb-cell-15","html_id":"nb-cell-15","key":"MFZokKpURT"},{"type":"block","position":{"start":{"line":160,"column":0},"end":{"line":161,"column":0}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":162,"column":0},"end":{"line":163,"column":0}},"children":[{"type":"text","value":"Assemble and solve the DC system of equations","key":"WvigCdv6kY"}],"identifier":"assemble-and-solve-the-dc-system-of-equations","label":"Assemble and solve the DC system of equations","html_id":"assemble-and-solve-the-dc-system-of-equations","implicit":true,"key":"mxGIbQITXN"},{"type":"paragraph","position":{"start":{"line":164,"column":0},"end":{"line":165,"column":0}},"children":[{"type":"text","value":"How we construct the divergence operator is discussed in ","key":"iofZ98LSSI"},{"type":"link","url":"/divergence","children":[{"type":"text","value":"Divergence Operator","key":"uD0tS8imhI"}],"urlSource":"divergence.ipynb","internal":true,"dataUrl":"/divergence.json","protocol":"file","key":"PQzG0oLoGZ"},{"type":"text","value":", and the inner product matrix in ","key":"OrENR2WSLB"},{"type":"link","url":"weakformulation.ipynb","children":[{"type":"text","value":"weakformulation​​.ipynb","key":"oEPwfYaBuC"}],"urlSource":"weakformulation.ipynb","key":"w41cFqWm9M"},{"type":"text","value":". The final system is assembled and discussed in ","key":"AKLHkv7DSD"},{"type":"link","url":"play.ipynb","children":[{"type":"text","value":"play.ipynb","key":"VPqXiVCxtH"}],"urlSource":"play.ipynb","key":"JvZqT29fsg"},{"type":"text","value":" (with widgets!).","key":"WrsB0z8lBD"}],"key":"aozx6Y3lrp"}],"data":{"id":"nb-cell-16","type":"notebook-content","iooxa":null},"identifier":"nb-cell-16","label":"nb-cell-16","html_id":"nb-cell-16","key":"XXNETKhVfq"},{"type":"block","position":{"start":{"line":166,"column":0},"end":{"line":167,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Assemble and solve the DC resistivity problem\nDiv = mesh.face_divergence\nSigma = mesh.get_face_inner_product(sigma, invert_model=True, invert_matrix=True)\nVol = utils.sdiag(mesh.cell_volumes)\n\n# assemble the system matrix\nA = Vol * Div * Sigma * Div.T * Vol\n\n# right hand side\nq = np.zeros(mesh.nC)\nq[source_loc_inds] = np.r_[+1, -1]","identifier":"nb-cell-17-code","enumerator":"6","html_id":"nb-cell-17-code","key":"BqzdimnBVV"},{"type":"output","id":"db5de92T3d08gpI2u3YCJ","data":[],"identifier":"nb-cell-17-output","html_id":"nb-cell-17-output","key":"ZaDAfMNJPb"}],"data":{"id":"nb-cell-17","type":"notebook-code","collapsed":false,"iooxa":null,"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-17","label":"nb-cell-17","html_id":"nb-cell-17","key":"XrmucGQaS7"},{"type":"block","position":{"start":{"line":186,"column":0},"end":{"line":187,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"from SimPEG import Solver # import the default solver (LU)","identifier":"nb-cell-18-code","enumerator":"7","html_id":"nb-cell-18-code","key":"shZGnSim81"},{"type":"output","id":"LCW5XC9fsaoade_AeQG8u","data":[],"identifier":"nb-cell-18-output","html_id":"nb-cell-18-output","key":"XC4kTGkJAT"}],"data":{"id":"nb-cell-18","type":"notebook-code","iooxa":null,"tags":[]},"identifier":"nb-cell-18","label":"nb-cell-18","html_id":"nb-cell-18","key":"BMf3gSNZgx"},{"type":"block","position":{"start":{"line":196,"column":0},"end":{"line":197,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"# solve the DC resistivity problem\nAinv = Solver(A)  # create a matrix that behaves like A inverse\nphi = Ainv * q","identifier":"nb-cell-19-code","enumerator":"8","html_id":"nb-cell-19-code","key":"ZLh8QDWTjr"},{"type":"output","id":"yC40IHzYuqkuVqAwa3twv","data":[],"identifier":"nb-cell-19-output","html_id":"nb-cell-19-output","key":"HGFQGYKVc5"}],"data":{"id":"nb-cell-19","type":"notebook-code","iooxa":null,"tags":[]},"identifier":"nb-cell-19","label":"nb-cell-19","html_id":"nb-cell-19","key":"NO1zxr1d3Y"},{"type":"block","position":{"start":{"line":208,"column":0},"end":{"line":209,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"# look at the results!\nplt.colorbar(mesh.plot_image(phi)[0])\nplt.title('Electric Potential, $\\phi$');","identifier":"nb-cell-20-code","enumerator":"9","html_id":"nb-cell-20-code","key":"hGDZoZiuBm"},{"type":"output","id":"wsc9yBo3QACfmUrAgwJ7f","data":[{"output_type":"display_data","metadata":{"needs_background":"light"},"data":{"image/png":{"content_type":"image/png","hash":"d18a98d2e6b497193167c53b9ff2098c","path":"/tle-finitevolume/build/d18a98d2e6b497193167c53b9ff2098c.png"},"text/plain":{"content":"<Figure size 432x288 with 2 Axes>","content_type":"text/plain"}}}],"identifier":"nb-cell-20-output","html_id":"nb-cell-20-output","key":"IlBi3HHZWu"}],"data":{"id":"nb-cell-20","type":"notebook-code","collapsed":false,"iooxa":null,"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-20","label":"nb-cell-20","html_id":"nb-cell-20","key":"S4sX1SITMs"},{"type":"block","position":{"start":{"line":220,"column":0},"end":{"line":221,"column":0}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":222,"column":0},"end":{"line":223,"column":0}},"children":[{"type":"text","value":"What just happened!?","key":"hPvc8TaG8z"}],"identifier":"what-just-happened","label":"What just happened!?","html_id":"what-just-happened","implicit":true,"key":"t6NyacixjS"},{"type":"paragraph","position":{"start":{"line":224,"column":0},"end":{"line":225,"column":0}},"children":[{"type":"text","value":"In the notebooks that follow, we will:","key":"QXT3RtSupp"}],"key":"M5gzvQKtXS"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":226,"column":0},"end":{"line":230,"column":0}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":226,"column":0},"end":{"line":227,"column":0}},"children":[{"type":"text","value":"define where variables live on the mesh (","key":"xHLkVYnr4T"},{"type":"link","url":"/mesh","children":[{"type":"text","value":"Finite Volume Mesh","key":"yVXTn4bKJf"}],"urlSource":"mesh.ipynb","internal":true,"dataUrl":"/mesh.json","protocol":"file","key":"X03R7r4xUr"},{"type":"text","value":")","key":"wrd6zzQcSH"}],"key":"UyN7GLk2sz"},{"type":"listItem","spread":true,"position":{"start":{"line":227,"column":0},"end":{"line":228,"column":0}},"children":[{"type":"text","value":"define the discrete divergence (","key":"RXb0Z7vO4W"},{"type":"link","url":"/divergence","children":[{"type":"text","value":"Divergence Operator","key":"aI1X76qkt3"}],"urlSource":"divergence.ipynb","internal":true,"dataUrl":"/divergence.json","protocol":"file","key":"JsBNuyX8tm"},{"type":"text","value":")","key":"Kfy0lZFXlf"}],"key":"RAutO4nPqx"},{"type":"listItem","spread":true,"position":{"start":{"line":228,"column":0},"end":{"line":229,"column":0}},"children":[{"type":"text","value":"use the weak formulation to define a solveable system of equations (","key":"ZTv5vmqH4y"},{"type":"link","url":"/weak-formulation","children":[{"type":"text","value":"weak​​-formulation​​.ipynb","key":"qXt2y4BYte"}],"urlSource":"weak-formulation.ipynb","internal":true,"dataUrl":"/weak-formulation.json","protocol":"file","key":"LkYjGmUmRr"},{"type":"text","value":")","key":"ne0TSPRTY7"}],"key":"O7fKGG31gT"},{"type":"listItem","spread":true,"position":{"start":{"line":229,"column":0},"end":{"line":230,"column":0}},"children":[{"type":"text","value":"solve and play with the DC resistivity equations (","key":"SRMOYtdUrW"},{"type":"link","url":"/all-together-now","children":[{"type":"text","value":"all​​-together​​-now​​.ipynb","key":"tLbcvzGJR2"}],"urlSource":"all-together-now.ipynb","internal":true,"dataUrl":"/all-together-now.json","protocol":"file","key":"i6oz06vghE"},{"type":"text","value":")","key":"KSN6g5qP9T"}],"key":"lCMigKodEn"}],"key":"EDQK9sqoyB"}],"data":{"id":"nb-cell-21","type":"notebook-content","iooxa":null},"identifier":"nb-cell-21","label":"nb-cell-21","html_id":"nb-cell-21","key":"diHl6c7Xhx"}],"key":"vSrmRH3Mai"},"references":{"cite":{"order":[],"data":{}}},"footer":{},"domain":"http://localhost:3000"}