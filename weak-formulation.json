{"kind":"Notebook","sha256":"549070bf994991f173ab81712a28103cfbb83574ff4476927fbf549197f4f782","slug":"weak-formulation","dependencies":[],"frontmatter":{"title":"Weak Formulation","authors":[{"name":"Rowan Cockett","orcid":"0000-0002-7859-8394","corresponding":true,"email":"rowan@curvenote.com","affiliations":["University of British Columbia"]},{"name":"Lindsey Heagy","orcid":"0000-0002-1551-5926","affiliations":["University of British Columbia"]},{"name":"Douglas Oldenburg","orcid":"0000-0002-4327-2124","affiliations":["University of British Columbia"]}],"date":"2016/08/01","doi":"10.1190/tle35080703.1","open_access":true,"license":{"content":{"id":"CC-BY-SA-3.0","name":"Creative Commons Attribution Share Alike 3.0 Unported","CC":true,"url":"https://creativecommons.org/licenses/by-sa/3.0/"},"code":{"id":"MIT","name":"MIT License","osi":true,"free":true,"url":"https://opensource.org/licenses/MIT"}},"github":"https://github.com/simpeg/tle-finitevolume","subject":"tutorial","venue":{"title":"The Leading Edge"},"thumbnail":"/tle-finitevolume/build/weak-formulation-bfe8fd6a5e823da1c1ca502550c2d873.png","exports":[{"format":"ipynb","filename":"weak-formulation.ipynb","url":"/tle-finitevolume/build/weak-formulation-98e10f3e3240fe8515e79f4b89a4393e.ipynb"}]},"mdast":{"type":"root","children":[{"type":"block","position":{"start":{"line":0,"column":0},"end":{"line":1,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":0},"end":{"line":5,"column":0}},"children":[{"type":"text","value":"Equation (b) is a vector equation, so really it is two or three equations involving multiple components of ","key":"vJ5pU2rwlc"},{"type":"inlineMath","value":"\\vec{j}","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>j</mi><mo>⃗</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\vec{j}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.137em;vertical-align:-0.1944em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9425em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span><span style=\"top:-3.2285em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2355em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span></span></span></span>","key":"j4ptnbbHvE"},{"type":"text","value":". We want to work with a single scalar equation, allow for anisotropic physical properties, and potentially work with non-axis-aligned meshes — how do we do this?! We can use the ","key":"FppU0ToHd7"},{"type":"strong","children":[{"type":"text","value":"weak formulation","key":"imiJlHOMRV"}],"key":"eR0hT20fiV"},{"type":"text","value":" where we take the inner product (","key":"iqRPiAW7Zm"},{"type":"inlineMath","value":"\\int \\vec{a} \\cdot \\vec{b} dv","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>∫</mo><mover accent=\"true\"><mi>a</mi><mo>⃗</mo></mover><mo>⋅</mo><mover accent=\"true\"><mi>b</mi><mo>⃗</mo></mover><mi>d</mi><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">\\int \\vec{a} \\cdot \\vec{b} dv</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1111em;vertical-align:-0.3061em;\"></span><span class=\"mop op-symbol small-op\" style=\"margin-right:0.19445em;position:relative;top:-0.0006em;\">∫</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.714em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">a</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2355em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9774em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9774em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">b</span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2355em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>","key":"aLuzEU6YOX"},{"type":"text","value":") of the equation with a generic face function, ","key":"OWmfVbx1Yh"},{"type":"inlineMath","value":"\\vec{f}","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>f</mi><mo>⃗</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\vec{f}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1719em;vertical-align:-0.1944em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9774em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.0688em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span></span></span></span>","key":"v8UNO0gnms"},{"type":"text","value":". This reduces requirements of differentiability on the original equation and also allows us to consider tensor anisotropy or curvilinear meshes (Haber 2014).","key":"LFWycD8Xow"}],"key":"ks2uslOJFD"},{"type":"heading","depth":2,"position":{"start":{"line":6,"column":0},"end":{"line":7,"column":0}},"children":[{"type":"text","value":"Scalar equations only, please","key":"sqcODSTjMW"}],"identifier":"scalar-equations-only-please","label":"Scalar equations only, please","html_id":"scalar-equations-only-please","implicit":true,"key":"UFJEXTfSRz"},{"type":"paragraph","position":{"start":{"line":8,"column":0},"end":{"line":9,"column":0}},"children":[{"type":"text","value":"In Figure 5, we visually walk through the discretization of equation (b). On the left hand side, a dot product requires a ","key":"sX3lYLAevx"},{"type":"emphasis","children":[{"type":"text","value":"single","key":"FCLaqFKnu1"}],"key":"TLcuw2myKP"},{"type":"text","value":" cartesian vector, ","key":"bgmY2kw8ng"},{"type":"inlineMath","value":"[\\mathbf{j_x, j_y}]","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mrow><msub><mi mathvariant=\"bold\">j</mi><mi mathvariant=\"bold\">x</mi></msub><mo separator=\"true\">,</mo><msub><mi mathvariant=\"bold\">j</mi><mi mathvariant=\"bold\">y</mi></msub></mrow><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[\\mathbf{j_x, j_y}]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1611em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathbf mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1611em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathbf mtight\" style=\"margin-right:0.01597em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>","key":"o8djfdOoVY"},{"type":"text","value":". However, we have a ","key":"OKJC02IeqJ"},{"type":"inlineMath","value":"j","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>j</mi></mrow><annotation encoding=\"application/x-tex\">j</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span></span></span>","key":"Orw5caGydU"},{"type":"text","value":" defined on each face (2 ","key":"oDxOqzNzDx"},{"type":"inlineMath","value":"j_x","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>j</mi><mi>x</mi></msub></mrow><annotation encoding=\"application/x-tex\">j_x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"YuEyLKXsR4"},{"type":"text","value":" and 2 ","key":"twfnIEcbUN"},{"type":"inlineMath","value":"j_y","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>j</mi><mi>y</mi></msub></mrow><annotation encoding=\"application/x-tex\">j_y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9456em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span>","key":"hGl4kqafy0"},{"type":"text","value":" in 2D!). There are many different ways to evaluate this inner product: we could approximate the integral using trapezoidal, midpoint or higher order approximations. A simple method is to break the integral into four sections (or 8 in 3D) and apply the midpoint rule for each section using the closest ","key":"hAPTrf212V"},{"type":"inlineMath","value":"\\mathbf{j}","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">j</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{j}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">j</span></span></span></span>","key":"EUE2XltSr2"},{"type":"text","value":" components to compose a cartesian vector. A ","key":"YCheFLHhVK"},{"type":"inlineMath","value":"\\mathbf{P}_i","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"bold\">P</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{P}_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"iO8DBZfryF"},{"type":"text","value":" matrix (size 2 × 4) is used to pick out the appropriate faces and compose the corresponding vector (these matrices are shown with colors corresponding to the appropriate face in the figure). On the right hand side, we use a vector identity to integrate by parts. The second term will cancel over the entire mesh (as the normals of adjacent cell faces point in opposite directions) and ","key":"ZoEBqicW9I"},{"type":"inlineMath","value":"\\phi","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding=\"application/x-tex\">\\phi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">ϕ</span></span></span></span>","key":"iD5tJ2COkQ"},{"type":"text","value":" on mesh boundary faces are zero by the Dirichlet boundary condition. This leaves us with the divergence, ","key":"sx0gQidl72"},{"type":"link","url":"/divergence","children":[{"type":"text","value":"which we already know how to do","key":"JANRm0bXiB"}],"urlSource":"divergence.ipynb","internal":true,"dataUrl":"/divergence.json","protocol":"file","key":"opR7etm78V"},{"type":"text","value":"!","key":"yhryWJ1WEF"}],"key":"fT6iIapEGT"}],"data":{"id":"nb-cell-0","type":"notebook-content","iooxa":{"id":{"block":"XRXnNzNyUsLV40Qxc5IJ","project":"5dxSs15hZtvQDKSzFgjP","version":2}}},"identifier":"nb-cell-0","label":"nb-cell-0","html_id":"nb-cell-0","key":"uAsp8vHP5s"},{"type":"block","position":{"start":{"line":10,"column":0},"end":{"line":11,"column":0}},"children":[{"type":"container","kind":"figure","identifier":"b8cf04cf","label":"b8cf04cf","children":[{"type":"image","url":"/tle-finitevolume/build/weak-formulation-bfe8fd6a5e823da1c1ca502550c2d873.png","alt":"Discretization using the weak formulation and inner products.","urlSource":"../images/weak-formulation.png","key":"RAYlnde11O"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":16,"column":0},"end":{"line":17,"column":0}},"children":[{"type":"captionNumber","kind":"figure","label":"b8cf04cf","identifier":"b8cf04cf","html_id":"b8cf04cf","enumerator":"1","children":[{"type":"text","value":"Figure ","key":"cdRpRp7L1X"},{"type":"text","value":"1","key":"wiHzcfHtlH"},{"type":"text","value":":","key":"E2vFlMf9u2"}],"template":"Figure %s:","key":"x7T4AwfjwZ"},{"type":"text","value":"Discretization using the weak formulation and inner products.","key":"vzkMqaNXEg"}],"key":"p6u5Ob7HIH"}],"key":"qv8qEPdMv2"}],"enumerator":"1","html_id":"b8cf04cf","key":"K7PuniJ2Dw"}],"data":{"id":"nb-cell-1","type":"notebook-content","iooxa":{"id":{"block":"mdDk7ewGdTdUKlz8g7yg","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-1","label":"nb-cell-1","html_id":"nb-cell-1","key":"vUcVYBqih3"},{"type":"block","position":{"start":{"line":19,"column":0},"end":{"line":20,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":21,"column":0},"end":{"line":22,"column":0}},"children":[{"type":"text","value":"The final step is to recognize that, now discretized, we can cancel the general face function ","key":"XHicmH9TE4"},{"type":"inlineMath","value":"\\mathbf{f}","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">f</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{f}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.10903em;\">f</span></span></span></span>","key":"tS3xiT6M6X"},{"type":"text","value":" and transpose the result (for convention's sake):","key":"FzBvpFRTc8"}],"key":"xVDMQSfVBm"}],"data":{"id":"nb-cell-2","type":"notebook-content","iooxa":{"id":{"block":"E0m5Jh7cTFESjbe0zrGb","project":"5dxSs15hZtvQDKSzFgjP","version":2}}},"identifier":"nb-cell-2","label":"nb-cell-2","html_id":"nb-cell-2","key":"fbtwXmlqAz"},{"type":"block","position":{"start":{"line":23,"column":0},"end":{"line":24,"column":0}},"children":[{"type":"math","value":"\\frac{1}{4} \\sum_{i=1}^4 \\mathbf{P}_i^\\top \\sqrt{v} \\mathbf{\\Sigma}^{-1} \\sqrt{v} \\mathbf{P}_i \\mathbf{j} = \\mathbf{D}^\\top v \\phi","position":{"start":{"line":25,"column":0},"end":{"line":26,"column":0}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mn>1</mn><mn>4</mn></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>4</mn></munderover><msubsup><mi mathvariant=\"bold\">P</mi><mi>i</mi><mi mathvariant=\"normal\">⊤</mi></msubsup><msqrt><mi>v</mi></msqrt><msup><mi mathvariant=\"bold\">Σ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><msqrt><mi>v</mi></msqrt><msub><mi mathvariant=\"bold\">P</mi><mi>i</mi></msub><mi mathvariant=\"bold\">j</mi><mo>=</mo><msup><mi mathvariant=\"bold\">D</mi><mi mathvariant=\"normal\">⊤</mi></msup><mi>v</mi><mi>ϕ</mi></mrow><annotation encoding=\"application/x-tex\">\\frac{1}{4} \\sum_{i=1}^4 \\mathbf{P}_i^\\top \\sqrt{v} \\mathbf{\\Sigma}^{-1} \\sqrt{v} \\mathbf{P}_i \\mathbf{j} = \\mathbf{D}^\\top v \\phi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3.0788em;vertical-align:-1.2777em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8011em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">⊤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8492em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span><span style=\"top:-2.8092em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1908em;\"><span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">Σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8492em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span><span style=\"top:-2.8092em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1908em;\"><span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathbf\">j</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0935em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">D</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">⊤</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">ϕ</span></span></span></span></span>","enumerator":"1","key":"H9upkuXuNK"}],"data":{"id":"nb-cell-3","type":"notebook-content","iooxa":{"id":{"block":"k3ce9vtzui0ybKCPtcIK","project":"5dxSs15hZtvQDKSzFgjP","version":3}}},"identifier":"nb-cell-3","label":"nb-cell-3","html_id":"nb-cell-3","key":"KttzKERRC7"},{"type":"block","position":{"start":{"line":27,"column":0},"end":{"line":28,"column":0}},"children":[{"type":"heading","depth":1,"position":{"start":{"line":29,"column":0},"end":{"line":30,"column":0}},"children":[{"type":"text","value":"Implementation","key":"SDjPne2eTI"}],"identifier":"implementation","label":"Implementation","html_id":"implementation","implicit":true,"key":"KNorO2Nqsf"},{"type":"paragraph","position":{"start":{"line":31,"column":0},"end":{"line":32,"column":0}},"children":[{"type":"text","value":"We will start by using a SimPEG Mesh that only has a single cell.","key":"AIr1dr1vdH"}],"key":"xXmLjxuxvY"}],"data":{"id":"nb-cell-4","type":"notebook-content","iooxa":{"id":{"block":"GAbpJlNVTjUM0Z5vtT50","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-4","label":"nb-cell-4","html_id":"nb-cell-4","key":"ilQAO75vIZ"},{"type":"block","position":{"start":{"line":33,"column":0},"end":{"line":34,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"%matplotlib inline\nimport discretize\nimport numpy as np\nimport matplotlib.pyplot as plt","identifier":"nb-cell-5-code","enumerator":"1","html_id":"nb-cell-5-code","key":"hkxtLssihc"},{"type":"output","id":"SSHlPvAefy91nK4FHOZXi","data":[],"identifier":"nb-cell-5-output","html_id":"nb-cell-5-output","key":"qt2KvRtBPq"}],"data":{"id":"nb-cell-5","type":"notebook-code","collapsed":true,"iooxa":{"id":{"block":"YzzyeWqgAuqxx0PAoA4q","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"P9oBPKfsnXyc0cZTOYEe","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":true}},"identifier":"nb-cell-5","label":"nb-cell-5","html_id":"nb-cell-5","key":"VjP62ULxl9"},{"type":"block","position":{"start":{"line":46,"column":0},"end":{"line":47,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(1)\nmesh = discretize.TensorMesh([1,1])\nmesh.plot_grid(ax=ax,centers=True,faces=True)\nax.set_xlim(-0.5,1.5)\nax.set_ylim(-0.5,1.5);","identifier":"nb-cell-6-code","enumerator":"2","html_id":"nb-cell-6-code","key":"nBT8YyQhad"},{"type":"output","id":"97ezkSTjtrn8TJbkefwIE","data":[{"output_type":"display_data","metadata":{"needs_background":"light"},"data":{"image/png":{"content_type":"image/png","hash":"12773d86204ce32b69335b9e65a42fcc","path":"/tle-finitevolume/build/12773d86204ce32b69335b9e65a42fcc.png"},"text/plain":{"content":"<Figure size 432x288 with 1 Axes>","content_type":"text/plain"}}}],"identifier":"nb-cell-6-output","html_id":"nb-cell-6-output","key":"N5mvIDHgPA"}],"data":{"id":"nb-cell-6","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"hb8q7AI0MaxLo3uw6PuF","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"jXh403rknR7GhoyOIml3","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-6","label":"nb-cell-6","html_id":"nb-cell-6","key":"YzxvYPk6Lo"},{"type":"block","position":{"start":{"line":60,"column":0},"end":{"line":61,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":62,"column":0},"end":{"line":63,"column":0}},"children":[{"type":"text","value":"The figure above is of a single cell, which in 2D has four faces (the green triangles). Two of these are pointed in the x direction and two in the y direction.","key":"dj23nJkNaX"}],"key":"EUxCTFLzvg"},{"type":"paragraph","position":{"start":{"line":64,"column":0},"end":{"line":65,"column":0}},"children":[{"type":"text","value":"For this single cell, we need our projection matrices to pick out four cartesian vectors that we will then use in evaluating the full integral.","key":"cmvvNGaytq"}],"key":"oMSYlGZbFf"},{"type":"paragraph","position":{"start":{"line":66,"column":0},"end":{"line":67,"column":0}},"children":[{"type":"text","value":"Instead of creating the code from scratch in this notebook, we will leverage some of the internal functions that are in SimPEG. The code is straight forward, but can get a little bit intricate when working with multiple dimensions and indexing in a generalized way (i.e. works for all of the meshes).","key":"ESXBi9mPkn"}],"key":"uSFs9yIUgj"},{"type":"paragraph","position":{"start":{"line":68,"column":0},"end":{"line":69,"column":0}},"children":[{"type":"text","value":"If you ever want to see the exact code that is executed in a function, you can use two question marks (one for the docs only). For example, execute ","key":"nnv53PD9If"},{"type":"strong","children":[{"type":"inlineCode","value":"mesh._getFacePxx??","key":"hMOah3e86x"}],"key":"Tkzt5VxzG7"},{"type":"text","value":" and Jupyter will show you more than you ever wanted. :)","key":"y6UCHEc9KI"}],"key":"Smx5YWjgOk"}],"data":{"id":"nb-cell-7","type":"notebook-content","iooxa":{"id":{"block":"bEL0LOMgs2fnWo7TPzdf","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-7","label":"nb-cell-7","html_id":"nb-cell-7","key":"CsgHBdRkx3"},{"type":"block","position":{"start":{"line":70,"column":0},"end":{"line":71,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"# mesh._getFacePxx??","identifier":"nb-cell-8-code","enumerator":"3","html_id":"nb-cell-8-code","key":"wsoSQRjGHi"},{"type":"output","id":"k9TVDACDxaw5WdEpGvHh7","data":[],"identifier":"nb-cell-8-output","html_id":"nb-cell-8-output","key":"HciRBKM3j2"}],"data":{"id":"nb-cell-8","type":"notebook-code","iooxa":{"id":{"block":"WnkAvpsgmPr1AwUiZyzi","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"mTYUldRSnhSmbCTyfMXG","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"tags":[]},"identifier":"nb-cell-8","label":"nb-cell-8","html_id":"nb-cell-8","key":"fpuoDI6Fub"},{"type":"block","position":{"start":{"line":80,"column":0},"end":{"line":81,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":82,"column":0},"end":{"line":83,"column":0}},"children":[{"type":"text","value":"This function creates the P matrices that we need. The matrix just pick out the appropriate faces and are used later on to evaluate our full integral.","key":"qYVkLCYxqd"}],"key":"tBhc4hoAAB"}],"data":{"id":"nb-cell-9","type":"notebook-content","iooxa":{"id":{"block":"NusqKvJ3MlKANE8pOB3b","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-9","label":"nb-cell-9","html_id":"nb-cell-9","key":"GDREge4v1a"},{"type":"block","position":{"start":{"line":84,"column":0},"end":{"line":85,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"# face-x minus side and the face-y minus side\nP1 = mesh._getFacePxx()('fXm','fYm')\nprint( P1.todense() )","identifier":"nb-cell-10-code","enumerator":"4","html_id":"nb-cell-10-code","key":"CfWi4dHfeC"},{"type":"output","id":"bHGFhRkQQEaDkgU0sd9i9","data":[{"name":"stdout","output_type":"stream","text":"[[1. 0. 0. 0.]\n [0. 0. 1. 0.]]\n"}],"identifier":"nb-cell-10-output","html_id":"nb-cell-10-output","key":"Cx5vNdLkvp"}],"data":{"id":"nb-cell-10","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"QIfby0zQOGSFgWrebbFK","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"MMDATgoGoAnhFK9c4ZAA","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-10","label":"nb-cell-10","html_id":"nb-cell-10","key":"DaFASgYdkF"},{"type":"block","position":{"start":{"line":96,"column":0},"end":{"line":97,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":98,"column":0},"end":{"line":99,"column":0}},"children":[{"type":"text","value":"We can create and plot all of the matrices that were in Figure 5:","key":"CjfwK9CgMc"}],"key":"Jw9umuBJPQ"}],"data":{"id":"nb-cell-11","type":"notebook-content","iooxa":{"id":{"block":"fJFT2oA1PXeXict2NpfQ","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-11","label":"nb-cell-11","html_id":"nb-cell-11","key":"ClzwPmCXhd"},{"type":"block","position":{"start":{"line":100,"column":0},"end":{"line":101,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"P1 = mesh._getFacePxx()('fXm','fYm')\nP2 = mesh._getFacePxx()('fXp','fYm')\nP3 = mesh._getFacePxx()('fXm','fYp')\nP4 = mesh._getFacePxx()('fXp','fYp')\nfig, ax = plt.subplots(1, 4, figsize=(15,3))\n\ndef plot_projection(ii, ax, P):\n    ax.spy(P, ms=30)\n    if P.shape[1]==4:\n        ax.set_xticks(range(4))\n        ax.set_xticklabels(('x-','x+','y-','y+'))\n    ax.set_xlabel('P{}'.format(ii+1))\n\nlist(map(plot_projection, range(4), ax, (P1, P2, P3, P4)));","identifier":"nb-cell-12-code","enumerator":"5","html_id":"nb-cell-12-code","key":"OOTFFTSxKc"},{"type":"output","id":"kMspKEdYZS-UsyB7lHwdg","data":[{"output_type":"display_data","metadata":{"needs_background":"light"},"data":{"image/png":{"content_type":"image/png","hash":"cda99d74a4fb1a26c7c527043848c7a6","path":"/tle-finitevolume/build/cda99d74a4fb1a26c7c527043848c7a6.png"},"text/plain":{"content":"<Figure size 1080x216 with 4 Axes>","content_type":"text/plain"}}}],"identifier":"nb-cell-12-output","html_id":"nb-cell-12-output","key":"lrl6QFhuvZ"}],"data":{"id":"nb-cell-12","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"40uVtzW0G0t3yHRCcaaM","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"lrPqqVEm6QxfabDcYLxT","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-12","label":"nb-cell-12","html_id":"nb-cell-12","key":"EBDGSxvxv4"},{"type":"block","position":{"start":{"line":123,"column":0},"end":{"line":124,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":125,"column":0},"end":{"line":126,"column":0}},"children":[{"type":"text","value":"This assumes that we unwrapped our face vectors in certain way and they are ordered [xfaces, yfaces].","key":"Vwhu5E8GVP"}],"key":"HKyW7j6RVO"}],"data":{"id":"nb-cell-13","type":"notebook-content","iooxa":{"id":{"block":"zDZID1FHKMMBwSn6yAau","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-13","label":"nb-cell-13","html_id":"nb-cell-13","key":"bsNeNXuA3Y"},{"type":"block","position":{"start":{"line":127,"column":0},"end":{"line":128,"column":0}},"children":[{"type":"heading","depth":1,"position":{"start":{"line":129,"column":0},"end":{"line":130,"column":0}},"children":[{"type":"text","value":"All the cells!","key":"giWIBJEoVu"}],"identifier":"all-the-cells","label":"All the cells!","html_id":"all-the-cells","implicit":true,"key":"iSmkjy5erk"},{"type":"paragraph","position":{"start":{"line":131,"column":0},"end":{"line":132,"column":0}},"children":[{"type":"text","value":"When we move to more cells the visualization of the matrix is not as clear, so instead we will show a connection from each cell center to the x and y faces that are selected by the P matrix.","key":"wjdEaQ2Dxa"}],"key":"tmSdYaMyAP"}],"data":{"id":"nb-cell-14","type":"notebook-content","iooxa":{"id":{"block":"7ctcHVZ9rbkU8JOISFLu","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-14","label":"nb-cell-14","html_id":"nb-cell-14","key":"hAZa8hNsPi"},{"type":"block","position":{"start":{"line":133,"column":0},"end":{"line":134,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"mesh = discretize.TensorMesh([3,4])","identifier":"nb-cell-15-code","enumerator":"6","html_id":"nb-cell-15-code","key":"UzAWjPtfQB"},{"type":"output","id":"8sjnlJ7DYNT34GIzDarDB","data":[],"identifier":"nb-cell-15-output","html_id":"nb-cell-15-output","key":"hcreCYKPOn"}],"data":{"id":"nb-cell-15","type":"notebook-code","collapsed":true,"iooxa":{"id":{"block":"WKYZQIAg0wA0So5pZDNO","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"jv4nylw4aMB6cLuAkltO","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":true}},"identifier":"nb-cell-15","label":"nb-cell-15","html_id":"nb-cell-15","key":"MKODS1JHQR"},{"type":"block","position":{"start":{"line":143,"column":0},"end":{"line":144,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"P1 = mesh._getFacePxx()('fXm','fYm')\nP2 = mesh._getFacePxx()('fXp','fYm')\nP3 = mesh._getFacePxx()('fXm','fYp')\nP4 = mesh._getFacePxx()('fXp','fYp')\nfig, ax = plt.subplots(1,4, figsize=(15,6))\ndef plot_projection(ii, ax, P):\n    x = P * np.r_[mesh.gridFx[:,0], mesh.gridFy[:,0]]\n    y = P * np.r_[mesh.gridFx[:,1], mesh.gridFy[:,1]]\n    xx, xy = x[:mesh.nC], x[mesh.nC:]\n    yx, yy = y[:mesh.nC], y[mesh.nC:]\n    ax.plot(np.c_[xx, mesh.gridCC[:,0], xx*np.nan].flatten(), np.c_[yx, mesh.gridCC[:,1], yx*np.nan].flatten(), 'k-')\n    ax.plot(np.c_[xy, mesh.gridCC[:,0], xy*np.nan].flatten(), np.c_[yy, mesh.gridCC[:,1], yy*np.nan].flatten(), 'k-')\n    ax.plot(xx, yx, 'g>')\n    ax.plot(xy, yy, 'g^')\n    mesh.plot_grid(ax=ax, centers=True)\n    ax.set_title('P{}'.format(ii+1))\nlist(map(plot_projection, range(4), ax.flatten(), (P1, P2, P3, P4)));\nplt.tight_layout()","identifier":"nb-cell-16-code","enumerator":"7","html_id":"nb-cell-16-code","key":"RCsrXeNoNU"},{"type":"output","id":"KI4H81_hHHJmYVtlj53h2","data":[{"output_type":"display_data","metadata":{"needs_background":"light"},"data":{"image/png":{"content_type":"image/png","hash":"f9d667553af77d56ef12d88e1c9f2789","path":"/tle-finitevolume/build/f9d667553af77d56ef12d88e1c9f2789.png"},"text/plain":{"content":"<Figure size 1080x432 with 4 Axes>","content_type":"text/plain"}}}],"identifier":"nb-cell-16-output","html_id":"nb-cell-16-output","key":"vGWXS8L30n"}],"data":{"id":"nb-cell-16","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"EzFA7goTjbyc3oqloq7T","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"vGpoFc2QY9a8Gtz668VL","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-16","label":"nb-cell-16","html_id":"nb-cell-16","key":"yMKbuBOGEQ"},{"type":"block","position":{"start":{"line":170,"column":0},"end":{"line":171,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":172,"column":0},"end":{"line":173,"column":0}},"children":[{"type":"text","value":"Each cell (the center is the red dot) has two faces that it uses, one x component and one y component.","key":"dCGagvBCdE"}],"key":"LyR4PlpBGf"}],"data":{"id":"nb-cell-17","type":"notebook-content","iooxa":{"id":{"block":"KPtsBYb1war7X3xTvF4V","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-17","label":"nb-cell-17","html_id":"nb-cell-17","key":"GLstQHKPD1"},{"type":"block","position":{"start":{"line":174,"column":0},"end":{"line":175,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":176,"column":0},"end":{"line":177,"column":0}},"children":[{"type":"text","value":"The four ","key":"GHzjU29nUd"},{"type":"inlineMath","value":"P","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span>","key":"cNL2VE0E7M"},{"type":"text","value":" matrices are assembled and summed in the ","key":"M2e1Toooxz"},{"type":"strong","children":[{"type":"text","value":"getFaceInnerProduct","key":"aubgY93GWM"}],"key":"LOXitlzmLS"},{"type":"text","value":" code using this formula:","key":"vT7OzEOexE"}],"key":"Two4IYyogr"},{"type":"math","value":"\\mathbf{M}_f(\\sigma) = \\frac{1}{4}\\sum_{i=1}^{4} \\mathbf{P}_i^\\top \\sqrt{v} \\boldsymbol{\\Sigma}^{-1} \\sqrt{v} \\mathbf{P}_i","position":{"start":{"line":179,"column":0},"end":{"line":182,"column":0}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi mathvariant=\"bold\">M</mi><mi>f</mi></msub><mo stretchy=\"false\">(</mo><mi>σ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mn>1</mn><mn>4</mn></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>4</mn></munderover><msubsup><mi mathvariant=\"bold\">P</mi><mi>i</mi><mi mathvariant=\"normal\">⊤</mi></msubsup><msqrt><mi>v</mi></msqrt><msup><mi mathvariant=\"bold\">Σ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><msqrt><mi>v</mi></msqrt><msub><mi mathvariant=\"bold\">P</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\mathbf{M}_f(\\sigma) = \\frac{1}{4}\\sum_{i=1}^{4} \\mathbf{P}_i^\\top \\sqrt{v} \\boldsymbol{\\Sigma}^{-1} \\sqrt{v} \\mathbf{P}_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">M</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.0788em;vertical-align:-1.2777em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">4</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8011em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">4</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">⊤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8492em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span><span style=\"top:-2.8092em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1908em;\"><span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathbf\">Σ</span></span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8901em;\"><span style=\"top:-3.139em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8492em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span><span style=\"top:-2.8092em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1908em;\"><span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathbf\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"2","key":"VoqV7hXmSO"},{"type":"paragraph","position":{"start":{"line":183,"column":0},"end":{"line":184,"column":0}},"children":[{"type":"text","value":"This function takes a sigma variable which can have any sort of anisotropy:","key":"HIH0Wsjw2e"}],"key":"r76saBX2F2"},{"type":"math","value":"\\begin{align}\\begin{aligned}\\begin{split}\\vec{\\mu} = \\left[\\begin{matrix} \\mu_{1} & 0 \\\\ 0 & \\mu_{1} \\end{matrix}\\right]\\end{split}\\\\\\begin{split}\\vec{\\mu} = \\left[\\begin{matrix} \\mu_{1} & 0 \\\\ 0 & \\mu_{2} \\end{matrix}\\right]\\end{split}\\\\\\begin{split}\\vec{\\mu} = \\left[\\begin{matrix} \\mu_{1} & \\mu_{3} \\\\ \\mu_{3} & \\mu_{2} \\end{matrix}\\right]\\end{split}\\end{aligned}\\end{align}","position":{"start":{"line":185,"column":0},"end":{"line":188,"column":0}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right\" columnspacing=\"\"><mtr><mtd class =\"mtr-glue\"></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mtable rowspacing=\"0.25em\" columnalign=\"right\" columnspacing=\"\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mtable rowspacing=\"0.25em\" columnalign=\"right\" columnspacing=\"\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mover accent=\"true\"><mi>μ</mi><mo>⃗</mo></mover><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>μ</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>μ</mi><mn>1</mn></msub></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow></mrow></mstyle></mtd></mtr></mtable></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mtable rowspacing=\"0.25em\" columnalign=\"right\" columnspacing=\"\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mover accent=\"true\"><mi>μ</mi><mo>⃗</mo></mover><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>μ</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>μ</mi><mn>2</mn></msub></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow></mrow></mstyle></mtd></mtr></mtable></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mtable rowspacing=\"0.25em\" columnalign=\"right\" columnspacing=\"\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mover accent=\"true\"><mi>μ</mi><mo>⃗</mo></mover><mo>=</mo><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>μ</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>μ</mi><mn>3</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>μ</mi><mn>3</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>μ</mi><mn>2</mn></msub></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow></mrow></mstyle></mtd></mtr></mtable></mstyle></mtd></mtr></mtable></mstyle></mtd><mtd class =\"mtr-glue\"></mtd><mtd class =\"mml-eqn-num\"></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{align}\\begin{aligned}\\begin{split}\\vec{\\mu} = \\left[\\begin{matrix} \\mu_{1} &amp; 0 \\\\ 0 &amp; \\mu_{1} \\end{matrix}\\right]\\end{split}\\\\\\begin{split}\\vec{\\mu} = \\left[\\begin{matrix} \\mu_{1} &amp; 0 \\\\ 0 &amp; \\mu_{2} \\end{matrix}\\right]\\end{split}\\\\\\begin{split}\\vec{\\mu} = \\left[\\begin{matrix} \\mu_{1} &amp; \\mu_{3} \\\\ \\mu_{3} &amp; \\mu_{2} \\end{matrix}\\right]\\end{split}\\end{aligned}\\end{align}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:9.3001em;vertical-align:-4.4em;\"></span><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.9em;\"><span style=\"top:-6.9em;\"><span class=\"pstrut\" style=\"height:6.75em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.75em;\"><span style=\"top:-6.75em;\"><span class=\"pstrut\" style=\"height:3.6em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6em;\"><span style=\"top:-3.6em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.714em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">μ</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2077em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">μ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">μ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.75em;\"><span class=\"pstrut\" style=\"height:3.6em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6em;\"><span style=\"top:-3.6em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.714em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">μ</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2077em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">μ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">μ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-0.75em;\"><span class=\"pstrut\" style=\"height:3.6em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6em;\"><span style=\"top:-3.6em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.714em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">μ</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2077em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">μ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">μ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">μ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">μ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.25em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.4em;\"><span></span></span></span></span></span></span></span><span class=\"tag\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.9em;\"><span style=\"top:-6.9em;\"><span class=\"pstrut\" style=\"height:6.75em;\"></span><span class=\"eqn-num\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.4em;\"><span></span></span></span></span></span></span></span></span>","enumerator":"3","key":"URiDrdxd2i"},{"type":"paragraph","position":{"start":{"line":189,"column":0},"end":{"line":190,"column":0}},"children":[{"type":"text","value":"The matrices that are produced by this function can be seen below!","key":"y21LnqAOsJ"}],"key":"WZ2W1ep05L"}],"data":{"id":"nb-cell-18","type":"notebook-content","iooxa":{"id":{"block":"82G9e2DAu4MWgeggqw79","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-18","label":"nb-cell-18","html_id":"nb-cell-18","key":"qss24wL14i"},{"type":"block","position":{"start":{"line":191,"column":0},"end":{"line":192,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"isotropic       = np.ones(mesh.nC)*4\nanisotropic_vec = np.r_[np.ones(mesh.nC)*4, np.ones(mesh.nC)]\nanisotropic     = np.r_[np.ones(mesh.nC)*4, np.ones(mesh.nC), np.ones(mesh.nC)*3]\nMf_sig_i = mesh.get_face_inner_product(isotropic)\nMf_sig_v = mesh.get_face_inner_product(anisotropic_vec)\nMf_sig_a = mesh.get_face_inner_product(anisotropic)\nclim = (\n    np.min(map(np.min, (Mf_sig_i.data, Mf_sig_v.data, Mf_sig_a.data))),\n    np.max(map(np.max, (Mf_sig_i.data, Mf_sig_v.data, Mf_sig_a.data)))\n)\nfig, ax = plt.subplots(1,3, figsize=(15,4))\ndef plot_spy(ax, Mf, title):\n    dense = Mf.toarray()\n    dense[dense == 0] = np.nan\n    ms = ax.matshow(dense)#, clim=clim)\n    plt.colorbar(ms, ax=ax)\n    ax.set_xlabel(title)\nlist(map(plot_spy, ax, (Mf_sig_i, Mf_sig_v, Mf_sig_a), ('Isotropic', 'Coordinate Anisotropy', 'Full Anisotropy')));","identifier":"nb-cell-19-code","enumerator":"8","html_id":"nb-cell-19-code","key":"G4oTBZz7N7"},{"type":"output","id":"xGxoxF0-UBBcPqorSodXa","data":[{"output_type":"display_data","metadata":{"needs_background":"light"},"data":{"image/png":{"content_type":"image/png","hash":"cc5726bda26e4959b42294f2cbf7efff","path":"/tle-finitevolume/build/cc5726bda26e4959b42294f2cbf7efff.png"},"text/plain":{"content":"<Figure size 1080x288 with 6 Axes>","content_type":"text/plain"}}}],"identifier":"nb-cell-19-output","html_id":"nb-cell-19-output","key":"MBVQmskxd9"}],"data":{"id":"nb-cell-19","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"oG3qra6QUeqwyfIQunfa","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"GzIgLkR3zaDoWst5C0gy","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-19","label":"nb-cell-19","html_id":"nb-cell-19","key":"PxncwBg0pH"},{"type":"block","position":{"start":{"line":218,"column":0},"end":{"line":219,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":220,"column":0},"end":{"line":221,"column":0}},"children":[{"type":"text","value":"In the last figure you can see that there is coupling between the cells in x and y due to the non-coordinate aligned anisotropy. This will make the matrix system harder to solve when we try to invert it!","key":"s9nxMoHVCl"}],"key":"tJSIvsBpNS"}],"data":{"id":"nb-cell-20","type":"notebook-content","iooxa":{"id":{"block":"gg0HpwxiBxFmCKJlLfvp","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-20","label":"nb-cell-20","html_id":"nb-cell-20","key":"ZC35M7IHQ6"},{"type":"block","position":{"start":{"line":222,"column":0},"end":{"line":223,"column":0}},"children":[{"type":"heading","depth":1,"position":{"start":{"line":224,"column":0},"end":{"line":225,"column":0}},"children":[{"type":"text","value":"Ok, but does it work?","key":"A39vobaMw6"}],"identifier":"ok-but-does-it-work","label":"Ok, but does it work?","html_id":"ok-but-does-it-work","implicit":true,"key":"DBJQMSAebY"},{"type":"paragraph","position":{"start":{"line":226,"column":0},"end":{"line":227,"column":0}},"children":[{"type":"text","value":"Unfortunately the testing of the innerproducts is not that visual. We need to make sure that the integral of some made up function evaluates to the correct value.","key":"A7Fe7syLcj"}],"key":"k54iiKZyIY"},{"type":"paragraph","position":{"start":{"line":228,"column":0},"end":{"line":229,"column":0}},"children":[{"type":"text","value":"So to make something up, and integrate it, we will use ","key":"khWH4EYGpR"},{"type":"strong","children":[{"type":"text","value":"sympy","key":"OaZmywrNkG"}],"key":"vcivoRyAjr"},{"type":"text","value":"!","key":"viiI06qhfs"}],"key":"z4rn1DyzcJ"},{"type":"paragraph","position":{"start":{"line":230,"column":0},"end":{"line":235,"column":0}},"children":[{"type":"text","value":"We will evaluate the integral:\n","key":"KrPAPyoV7X"}],"key":"APkgoot22E"},{"type":"math","value":"\n\\int_0^1 \\int_0^1 \\sigma(x,y) \\vec{j}(x,y) \\cdot \\vec{j}(x,y) \\quad dx dy","html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msubsup><mo>∫</mo><mn>0</mn><mn>1</mn></msubsup><msubsup><mo>∫</mo><mn>0</mn><mn>1</mn></msubsup><mi>σ</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mover accent=\"true\"><mi>j</mi><mo>⃗</mo></mover><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>⋅</mo><mover accent=\"true\"><mi>j</mi><mo>⃗</mo></mover><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mspace width=\"1em\"/><mi>d</mi><mi>x</mi><mi>d</mi><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">\n\\int_0^1 \\int_0^1 \\sigma(x,y) \\vec{j}(x,y) \\cdot \\vec{j}(x,y) \\quad dx dy</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.476em;vertical-align:-0.9119em;\"></span><span class=\"mop\"><span class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\">∫</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.564em;\"><span style=\"top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span><span style=\"top:-3.8129em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9119em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\">∫</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.564em;\"><span style=\"top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span><span style=\"top:-3.8129em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9119em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9425em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span><span style=\"top:-3.2285em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2355em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1925em;vertical-align:-0.25em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9425em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span></span><span style=\"top:-3.2285em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2355em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span>","enumerator":"4","key":"sy0usgALb6"},{"type":"paragraph","position":{"start":{"line":230,"column":0},"end":{"line":235,"column":0}},"children":[{"type":"text","value":"\nby making up some ridiculous functions.","key":"nG2Xcc4aXv"}],"key":"Qyif3RnUS0"}],"data":{"id":"nb-cell-21","type":"notebook-content","iooxa":{"id":{"block":"mGY80A0iX7A0gH1lrGiQ","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-21","label":"nb-cell-21","html_id":"nb-cell-21","key":"Sj5TlbiiMc"},{"type":"block","position":{"start":{"line":236,"column":0},"end":{"line":237,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"import sympy\nfrom sympy.abc import x, y\n\n# Here we will make up some j vectors that vary in space\nj = sympy.Matrix([\n    x**2+y*5,\n    (5**2)*x+y*5\n])\n\n# Create an isotropic sigma vector\nSig = sympy.Matrix([\n    [x*y*432/1163,      0      ],\n    [     0      , x*y*432/1163]\n])\n\n# Do the inner product!\njTSj = j.T*Sig*j\nans  = sympy.integrate(sympy.integrate(jTSj, (x,0,1)), (y,0,1))[0] # The `[0]` is to make it an int.\n\nprint( \"It is trivial to see that the answer is {}.\".format(ans) )","identifier":"nb-cell-22-code","enumerator":"9","html_id":"nb-cell-22-code","key":"v8tMebu3Rd"},{"type":"output","id":"AU3yHhYlxxz2lUe1ceoCY","data":[{"name":"stdout","output_type":"stream","text":"It is trivial to see that the answer is 42.\n"}],"identifier":"nb-cell-22-output","html_id":"nb-cell-22-output","key":"LOOj7tFdra"}],"data":{"id":"nb-cell-22","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"YHg7nx2e6BHty5xLHFmK","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"p5vGrxND1WnUpjXOfnL4","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-22","label":"nb-cell-22","html_id":"nb-cell-22","key":"NLByRGEzuO"},{"type":"block","position":{"start":{"line":265,"column":0},"end":{"line":266,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":267,"column":0},"end":{"line":268,"column":0}},"children":[{"type":"text","value":"Wonderful. Everything seems right in the world with that answer. Next step is to sub in the locations of the grid on both the faces in x and y as well as the cell centers.","key":"IHXICehwH8"}],"key":"gvGyq8d9LJ"}],"data":{"id":"nb-cell-23","type":"notebook-content","iooxa":{"id":{"block":"Q4LY68w68gHywJXJgboO","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-23","label":"nb-cell-23","html_id":"nb-cell-23","key":"vR78vVr4SV"},{"type":"block","position":{"start":{"line":269,"column":0},"end":{"line":270,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"def get_vectors(mesh):\n    \"\"\"Gets the vectors sig and [jx, jy] from sympy.\"\"\"\n    f_jx  = sympy.lambdify((x,y), j[0], 'numpy')\n    f_jy  = sympy.lambdify((x,y), j[1], 'numpy')\n    f_sig = sympy.lambdify((x,y), Sig[0], 'numpy')\n    jx  = f_jx(mesh.gridFx[:,0], mesh.gridFx[:,1])\n    jy  = f_jy(mesh.gridFy[:,0], mesh.gridFy[:,1])\n    sig = f_sig(mesh.gridCC[:,0], mesh.gridCC[:,1])\n    return sig, np.r_[jx, jy]","identifier":"nb-cell-24-code","enumerator":"10","html_id":"nb-cell-24-code","key":"k9TbBvMcog"},{"type":"output","id":"rSmYPVIZ75lusS_e48amE","data":[],"identifier":"nb-cell-24-output","html_id":"nb-cell-24-output","key":"zKuPHpCqMA"}],"data":{"id":"nb-cell-24","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"Wtyf5RJU5fa9fGZZ5yol","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"7Gzd8hQdpwr6jqp2FQFU","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-24","label":"nb-cell-24","html_id":"nb-cell-24","key":"K9TEY4tVAc"},{"type":"block","position":{"start":{"line":287,"column":0},"end":{"line":288,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":289,"column":0},"end":{"line":290,"column":0}},"children":[{"type":"text","value":"Using these vectors (","key":"JGQV6ly2zy"},{"type":"inlineMath","value":"\\sigma","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi></mrow><annotation encoding=\"application/x-tex\">\\sigma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span></span></span></span>","key":"oY2qxerLXE"},{"type":"text","value":" and ","key":"oysp9bQiG4"},{"type":"inlineMath","value":"\\mathbf{j}","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">j</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{j}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\">j</span></span></span></span>","key":"aG4xINYxGt"},{"type":"text","value":") we can evaluate the result on our mesh","key":"rXyHKWspcW"}],"key":"XF2j78rcoU"}],"data":{"id":"nb-cell-25","type":"notebook-content","iooxa":{"id":{"block":"PcA8DQgBBhOOq3iMGuCl","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-25","label":"nb-cell-25","html_id":"nb-cell-25","key":"fOUSlgGmGy"},{"type":"block","position":{"start":{"line":291,"column":0},"end":{"line":292,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"n = 5 # get's better if you add cells!\nmesh = discretize.TensorMesh([n,n])\nsig, jv = get_vectors(mesh)\nMsig = mesh.get_face_inner_product(sig)\nnumeric_ans = jv.T.dot(Msig.dot(jv))\nprint( \"Numerically we get {}.\".format(numeric_ans) )","identifier":"nb-cell-26-code","enumerator":"11","html_id":"nb-cell-26-code","key":"iBCcBT4Na8"},{"type":"output","id":"P9-HaMk7zhGU1Dl0ven_4","data":[{"name":"stdout","output_type":"stream","text":"Numerically we get 41.18917558039555.\n"}],"identifier":"nb-cell-26-output","html_id":"nb-cell-26-output","key":"HF0qEP4fFI"}],"data":{"id":"nb-cell-26","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"qddmFAn8izDKO9ynQWyi","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"N5fL7R5F7ohI7NYHfTpZ","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-26","label":"nb-cell-26","html_id":"nb-cell-26","key":"vi2ttkGKKy"},{"type":"block","position":{"start":{"line":306,"column":0},"end":{"line":307,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":308,"column":0},"end":{"line":309,"column":0}},"children":[{"type":"text","value":"That is pretty close, but to be rigorous we should look at the order of the convergence which should be ","key":"cC9TVSmoeY"},{"type":"inlineMath","value":"\\mathcal{O}(h^2)","html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">O</mi><mo stretchy=\"false\">(</mo><msup><mi>h</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\mathcal{O}(h^2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathcal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"M3MZA6soz9"},{"type":"text","value":".","key":"O5xE7IqOoZ"}],"key":"IM98M2dw3A"},{"type":"paragraph","position":{"start":{"line":310,"column":0},"end":{"line":315,"column":0}},"children":[{"type":"text","value":"SimPEG has a number of testing functions for\n","key":"b4ETUjybYr"},{"type":"link","url":"http://docs.simpeg.xyz/content/api_core/api_Tests.html#SimPEG.Tests.checkDerivative","children":[{"type":"text","value":"derivatives","key":"UI7p4cwTK7"}],"urlSource":"http://docs.simpeg.xyz/content/api_core/api_Tests.html#SimPEG.Tests.checkDerivative","key":"erHNNcftws"},{"type":"text","value":"\nand\n","key":"TF5WzbZKO1"},{"type":"link","url":"http://docs.simpeg.xyz/content/api_core/api_Tests.html#SimPEG.Tests.OrderTest","children":[{"type":"text","value":"order of convergence","key":"Z6yLm2Nb7t"}],"urlSource":"http://docs.simpeg.xyz/content/api_core/api_Tests.html#SimPEG.Tests.OrderTest","key":"GcCMYUtIxK"},{"type":"text","value":"\nthat make this pretty simple!","key":"phXOOXP6sN"}],"key":"Ri7aOdGkgy"}],"data":{"id":"nb-cell-27","type":"notebook-content","iooxa":{"id":{"block":"Wmu04ObkA2uUXBGHYg32","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-27","label":"nb-cell-27","html_id":"nb-cell-27","key":"lEiTw734KQ"},{"type":"block","position":{"start":{"line":316,"column":0},"end":{"line":317,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"import sys\nimport unittest\nfrom discretize.tests import OrderTest\n\nclass Testify(OrderTest):\n    meshDimension = 2\n    def getError(self):\n        sig, jv = get_vectors(self.M)\n        Msig = self.M.get_face_inner_product(sig)\n        return float(ans) - jv.T.dot(Msig.dot(jv))\n    def test_order(self):\n        self.orderTest()\n\n# This just runs the unittest:\nsuite = unittest.TestLoader().loadTestsFromTestCase( Testify )\nunittest.TextTestRunner().run( suite );","identifier":"nb-cell-28-code","enumerator":"12","html_id":"nb-cell-28-code","key":"lEnw60NpMR"},{"type":"output","id":"kO1JMqEcP92SLzP6IC4_m","data":[{"name":"stderr","output_type":"stream","text":"/opt/anaconda3/envs/simpeg/lib/python3.8/site-packages/discretize/utils/code_utils.py:247: FutureWarning: setupMesh has been deprecated, please use setup_mesh. It will be removed in version 1.0.0 of discretize.\n  warnings.warn(\n."},{"name":"stdout","output_type":"stream","text":"\nuniformTensorMesh:  Order Test\n_____________________________________________\n   h  |    error    | e(i-1)/e(i) |  order\n~~~~~~|~~~~~~~~~~~~~|~~~~~~~~~~~~~|~~~~~~~~~~\n   4  |  1.27e+00   |\n   8  |  3.17e-01   |   3.9942    |  1.9979\n  16  |  7.93e-02   |   3.9985    |  1.9995\n  32  |  1.98e-02   |   3.9996    |  1.9999\n---------------------------------------------\nHappy little convergence test!\n\n"},{"name":"stderr","output_type":"stream","text":"\n----------------------------------------------------------------------\nRan 1 test in 0.090s\n\nOK\n"}],"identifier":"nb-cell-28-output","html_id":"nb-cell-28-output","key":"OgYZgynLAI"}],"data":{"id":"nb-cell-28","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"oCa9boN1s3XlZa9SvmdU","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"tGj342IRsaYHRvrqwYBJ","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-28","label":"nb-cell-28","html_id":"nb-cell-28","key":"cil9fcV1bC"},{"type":"block","position":{"start":{"line":341,"column":0},"end":{"line":342,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":343,"column":0},"end":{"line":344,"column":0}},"children":[{"type":"text","value":"These basic operations on the mesh for inner products and differential operators are core pieces of SimPEG, and they need to be tested continuously to ensure that no one has broken them!","key":"I0lPfxftFB"}],"key":"Y2bjSAWWaz"},{"type":"paragraph","position":{"start":{"line":345,"column":0},"end":{"line":346,"column":0}},"children":[{"type":"text","value":"On every single change to the SimPEG codebase many hours of testing are completed!","key":"urzNGdZUmy"}],"key":"t8zQwuXK7i"}],"data":{"id":"nb-cell-29","type":"notebook-content","iooxa":{"id":{"block":"aTIbN9BFtHIPWlwGCeG6","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-29","label":"nb-cell-29","html_id":"nb-cell-29","key":"U8YGicH2fK"},{"type":"block","position":{"start":{"line":347,"column":0},"end":{"line":348,"column":0}},"children":[{"type":"heading","depth":1,"position":{"start":{"line":349,"column":0},"end":{"line":350,"column":0}},"children":[{"type":"text","value":"Next up ...","key":"CZ5ooZOeyD"}],"identifier":"next-up","label":"Next up ...","html_id":"next-up","implicit":true,"key":"xghp0lf78k"},{"type":"paragraph","position":{"start":{"line":351,"column":0},"end":{"line":352,"column":0}},"children":[{"type":"text","value":"In the ","key":"sQG48FIwdu"},{"type":"link","url":"/all-together-now","children":[{"type":"text","value":"next notebook","key":"BOkF88lMRp"}],"urlSource":"all-together-now.ipynb","internal":true,"dataUrl":"/all-together-now.json","protocol":"file","key":"H2eZvjgeri"},{"type":"text","value":" we will use our knowledge of the ","key":"gk6hcJq84z"},{"type":"link","url":"/mesh","children":[{"type":"text","value":"mesh","key":"OFY8Z2RBVa"}],"urlSource":"mesh.ipynb","internal":true,"dataUrl":"/mesh.json","protocol":"file","key":"L9MrkkRVge"},{"type":"text","value":" and the ","key":"CucvMjGPXg"},{"type":"link","url":"/divergence","children":[{"type":"text","value":"divergence","key":"hpxpC7MW49"}],"urlSource":"divergence.ipynb","internal":true,"dataUrl":"/divergence.json","protocol":"file","key":"xucz02T0MB"},{"type":"text","value":" implementations to bring the DC resistivity equations together and show some pretty figures!","key":"Ee8zzeaOjc"}],"key":"a6rKFApHMU"}],"data":{"id":"nb-cell-30","type":"notebook-content","iooxa":{"id":{"block":"XnthZqZ9T4KoIpVw1HqS","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-30","label":"nb-cell-30","html_id":"nb-cell-30","key":"udqrolgU8E"}],"key":"uq2RzBAOsN"},"references":{"cite":{"order":[],"data":{}}},"footer":{},"domain":"http://localhost:3000"}