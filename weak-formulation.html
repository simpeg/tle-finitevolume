<!DOCTYPE html><html lang="en" class="light scroll-p-20"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Weak Formulation - Pixels and Their Neighbours: Finite Volume</title><meta name="image" content="/tle-finitevolume/build/weak-formulation-4b2a17d0b5767005d07fdb3714e0aa80.png"/><meta property="og:title" content="Weak Formulation - Pixels and Their Neighbours: Finite Volume"/><meta property="og:image" content="/tle-finitevolume/build/weak-formulation-4b2a17d0b5767005d07fdb3714e0aa80.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Weak Formulation - Pixels and Their Neighbours: Finite Volume"/><meta name="twitter:image" content="/tle-finitevolume/build/weak-formulation-4b2a17d0b5767005d07fdb3714e0aa80.png"/><meta name="twitter:alt" content="Weak Formulation - Pixels and Their Neighbours: Finite Volume"/><link rel="stylesheet" href="/tle-finitevolume/build/_assets/app-ADU2AYLI.css"/><link rel="stylesheet" href="/tle-finitevolume/build/_assets/thebe-core-BKMFZL7Z.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 fixed w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-wrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="h-8 w-8 p-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 013.75 6h16.5a.75.75 0 010 1.5H3.75A.75.75 0 013 6.75zM3 12a.75.75 0 01.75-.75h16.5a.75.75 0 010 1.5H3.75A.75.75 0 013 12zm0 5.25a.75.75 0 01.75-.75h16.5a.75.75 0 010 1.5H3.75a.75.75 0 01-.75-.75z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center dark:text-white w-fit ml-3 md:ml-5 xl:ml-7" href="/tle-finitevolume/"><span class="text-md sm:text-xl tracking-tight sm:mr-5">Pixels and their neighbours</span></a></div><div class="flex-grow flex items-center w-auto"><div class="text-md flex-grow hidden lg:block"></div><div class="block flex-grow"></div><button class="theme rounded-full border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 mx-3 h-8 w-8" title="Change theme to dark mode." aria-label="Change theme to dark mode."><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="h-full w-full p-0.5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z"></path></svg></button><div class="block sm:hidden"><div class="relative" data-headlessui-state=""><div><button class="bg-transparent flex text-sm rounded-full focus:outline-none" id="headlessui-menu-button-:Rcj4p:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Open Menu</span><div class="flex items-center text-stone-200 hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="h-8 w-8 p-1"><path fill-rule="evenodd" d="M10.5 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zm0 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zm0 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0z" clip-rule="evenodd"></path></svg></div></button></div></div></div><div class="hidden sm:block"><a class="inline-block text-md px-4 py-2 mx-1 leading-none border rounded border-stone-700 dark:border-white text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 hover:bg-neutral-100 mt-0" href="/tle-finitevolume/build/cockett-heagy-oldenb-c6bbd4ad57b7a4be56ea2682a7fd4a03.pdf">Download PDF</a></div></div></nav></div><div class="fixed xl:article-grid article-grid-gap xl:w-screen z-30 xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><nav aria-label="Table of Contents" class="flex-grow overflow-y-auto transition-opacity mt-6 pb-3 ml-3 xl:ml-0 mr-3"><ul class="space-y-6 lg:space-y-2"><li class="text-slate-900 leading-5 dark:text-slate-100 font-semibold"><a title="Pixels and Their Neighbours" class="block break-words mb-8 lg:mb-3 font-semibold text-slate-900 dark:text-slate-200 border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/tle-finitevolume/">Pixels and Their Neighbours</a></li><li class=""><a title="Getting Started" class="block break-words border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/tle-finitevolume/index">Getting Started</a></li><li class=""><a title="Finite Volume Mesh" class="block break-words border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/tle-finitevolume/mesh">Finite Volume Mesh</a></li><li class=""><a title="Divergence Operator" class="block break-words border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/tle-finitevolume/divergence">Divergence Operator</a></li><li class=""><a title="Weak Formulation" class="block break-words border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/tle-finitevolume/weak-formulation">Weak Formulation</a></li><li class=""><a title="All Together Now" class="block break-words border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/tle-finitevolume/all-together-now">All Together Now</a></li></ul></nav><div class="flex-none py-4 opacity-0 transition-all duration-700 translate-y-6"><a class="flex w-fit mx-auto text-gray-700 hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://myst-tools.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center text-sm ml-2">Made with MyST</span></a></div></div></div><article class="article content article-grid article-grid-gap" style="margin-top:76px"><main class="article-grid article-subgrid-gap col-screen"><div class="mb-8"><div class="flex mt-3 mb-5 text-sm font-light items-center h-6"><div class="flex-none pr-2 smallcaps border-r mr-2">tutorial</div><div class="flex-none mr-2"><span class="smallcaps font-semibold">The Leading Edge</span></div><div class="flex-grow"></div><a href="https://creativecommons.org/licenses/by-sa/3.0/" target="_blank" rel="noopener noreferrer" class="opacity-50 hover:opacity-100 text-inherit hover:text-inherit" aria-label="Content License: Creative Commons Attribution Share Alike 3.0 Unported (CC-BY-SA-3.0)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="h-5 w-5 mx-1 inline-block"><title>Content License: Creative Commons Attribution Share Alike 3.0 Unported (CC-BY-SA-3.0)</title><path d="M12 2.2c2.7 0 5 1 7 2.9.9.9 1.6 2 2.1 3.1.5 1.2.7 2.4.7 3.8 0 1.3-.2 2.6-.7 3.8-.5 1.2-1.2 2.2-2.1 3.1-1 .9-2 1.7-3.2 2.2-1.2.5-2.5.7-3.7.7s-2.6-.3-3.8-.8c-1.2-.5-2.2-1.2-3.2-2.1s-1.6-2-2.1-3.2-.8-2.4-.8-3.7c0-1.3.2-2.5.7-3.7S4.2 6 5.1 5.1C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C5.6 7.1 5 8 4.6 9c-.4 1-.6 2-.6 3s.2 2.1.6 3c.4 1 1 1.8 1.8 2.6S8 19 9 19.4c1 .4 2 .6 3 .6s2.1-.2 3-.6c1-.4 1.9-1 2.7-1.8 1.5-1.5 2.3-3.3 2.3-5.6 0-1.1-.2-2.1-.6-3.1-.4-1-1-1.8-1.7-2.6C16.1 4.8 14.2 4 12 4zm-.1 6.4l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.5.3-1 .4-1.5.4-.9 0-1.6-.3-2.1-.8-.5-.6-.8-1.3-.8-2.3 0-.9.3-1.7.8-2.2.6-.6 1.3-.8 2.1-.8 1.2 0 2.1.4 2.6 1.4zm5.6 0l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.4.2-.9.3-1.4.3-.9 0-1.6-.3-2.1-.8s-.8-1.3-.8-2.2c0-.9.3-1.7.8-2.2.5-.5 1.2-.8 2-.8 1.2 0 2.1.4 2.6 1.4z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="h-5 w-5 mr-1 inline-block"><title>Credit must be given to the creator</title><path d="M12 2.2c2.7 0 5 .9 6.9 2.8 1.9 1.9 2.8 4.2 2.8 6.9s-.9 5-2.8 6.8c-2 1.9-4.3 2.9-7 2.9-2.6 0-4.9-1-6.9-2.9-1.8-1.7-2.8-4-2.8-6.7s1-5 2.9-6.9C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C4.8 8 4 9.9 4 12c0 2.2.8 4 2.4 5.6C8 19.2 9.8 20 12 20c2.2 0 4.1-.8 5.7-2.4 1.5-1.5 2.3-3.3 2.3-5.6 0-2.2-.8-4.1-2.3-5.7C16.1 4.8 14.2 4 12 4zm2.6 5.6v4h-1.1v4.7h-3v-4.7H9.4v-4c0-.2.1-.3.2-.4.1-.2.2-.2.4-.2h4c.2 0 .3.1.4.2.2.1.2.2.2.4zm-4-2.5c0-.9.5-1.4 1.4-1.4s1.4.5 1.4 1.4c0 .9-.5 1.4-1.4 1.4s-1.4-.5-1.4-1.4z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="h-5 w-5 mr-1 inline-block"><title>Adaptations must be shared under the same terms</title><path d="M12 2.2c2.7 0 5 .9 6.9 2.8 1.9 1.9 2.8 4.2 2.8 6.9s-.9 5-2.8 6.9c-2 1.9-4.3 2.9-7 2.9-2.6 0-4.9-1-6.9-2.9C3.2 17 2.2 14.7 2.2 12s1-5 2.9-6.9C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.4C4.8 8 4 9.9 4 12c0 2.2.8 4 2.4 5.6C8 19.2 9.8 20 12 20c2.2 0 4.1-.8 5.7-2.4 1.5-1.5 2.3-3.3 2.3-5.6 0-2.2-.8-4.1-2.3-5.6C16.1 4.8 14.2 4 12 4zm-4.3 6.6c.2-1.2.7-2.1 1.4-2.8.8-.7 1.7-1 2.8-1 1.5 0 2.8.5 3.7 1.5.9 1 1.4 2.3 1.4 3.8s-.5 2.7-1.4 3.7c-.9 1-2.2 1.5-3.7 1.5-1.1 0-2.1-.3-2.9-1-.8-.7-1.3-1.6-1.4-2.8h2.5c.1 1.2.8 1.8 2.1 1.8.7 0 1.2-.3 1.7-.9.4-.6.6-1.4.6-2.4s-.2-1.8-.6-2.4c-.4-.5-.9-.8-1.7-.8-1.3 0-2 .6-2.2 1.7h.7l-1.9 1.9-1.9-1.9.8.1z"></path></svg></a><a href="https://opensource.org/licenses/MIT" target="_blank" rel="noopener noreferrer" title="Code License: MIT License (MIT)" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="h-5 w-5 mx-1 inline-block opacity-60 hover:opacity-100 hover:text-[#599F46]"><path d="M13.2 15.6c1.4-.5 2.1-1.6 2.1-3.3S13.8 8.9 12 8.9c-1.9 0-3.3 1.6-3.3 3.3 0 1.8.8 3 2.2 3.4l-2.3 5.9c-3.1-.8-6.3-4.6-6.3-9.3 0-5.5 4.3-10 9.7-10s9.8 4.5 9.8 10c0 4.7-3.1 8.5-6.3 9.3l-2.3-5.9z"></path></svg></a><a href="https://en.wikipedia.org/wiki/Open_access" target="_blank" rel="noopener noreferrer" title="Open Access" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="w-5 h-5 mr-1 inline-block opacity-60 hover:opacity-100 hover:text-[#E18435]"><path d="M17.1 12.6h-2V7.5c0-1.7-1.4-3.1-3-3.1-.8 0-1.6.3-2.2.9-.6.5-.9 1.3-.9 2.2v.7H7v-.7c0-1.4.5-2.7 1.5-3.7s2.2-1.5 3.6-1.5 2.6.5 3.6 1.5 1.5 2.3 1.5 3.7v5.1z"></path><path d="M12 21.8c-.8 0-1.6-.2-2.3-.5-.7-.3-1.4-.8-1.9-1.3-.6-.6-1-1.2-1.3-2-.3-.8-.5-1.6-.5-2.4s.2-1.6.5-2.4c.3-.7.7-1.4 1.3-2s1.2-1 1.9-1.3c.7-.3 1.5-.5 2.3-.5.8 0 1.6.2 2.3.5.7.3 1.4.8 1.9 1.3.6.6 1 1.2 1.3 2 .3.8.5 1.6.5 2.4s-.2 1.6-.5 2.4c-.3.7-.7 1.4-1.3 2-.6.6-1.2 1-1.9 1.3-.7.3-1.5.5-2.3.5zm0-10.3c-2.2 0-4 1.8-4 4.1s1.8 4.1 4 4.1 4-1.8 4-4.1-1.8-4.1-4-4.1z"></path><circle cx="12" cy="15.6" r="1.7"></circle></svg></a><a href="https://github.com/simpeg/tle-finitevolume" title="GitHub Repository: simpeg/tle-finitevolume" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="w-5 h-5 mr-1 inline-block opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="h-5 w-5 inline-block"><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><div class="flex relative grow-0 inline-block mx-1" data-headlessui-state=""><button class="relative" id="headlessui-menu-button-:R1gaop:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-5 h-5 ml-2 -mr-1"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">Weak Formulation</h1><header class="not-prose mt-4"><div class="grid grid-cols-1 sm:grid-cols-2 gap-y-1"><div class="font-thin text-xs uppercase pb-2">Authors</div><div class="font-thin text-xs uppercase pb-2">Affiliations</div><div><span class="font-semibold text-sm">Rowan Cockett<a class="ml-1" href="mailto:rowan@curvenote.com" title="Rowan Cockett &lt;rowan@curvenote.com&gt;" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="w-4 h-4 inline-block text-gray-400 hover:text-blue-400 -translate-y-[0.1em]"><path d="M21.8 18c0 1.1-.9 2-1.9 2H4.2c-1.1 0-1.9-.9-1.9-2V9.9c0-.5.3-.7.8-.4l7.8 4.7c.7.4 1.7.4 2.4 0L21 9.5c.4-.2.8-.1.8.4V18z"></path><path d="M21.8 6c0-1.1-.9-2-1.9-2H4.2c-1.1 0-2 .9-2 2v.4c0 .5.3 1.1.8 1.3l8.5 5.1c.2.1.7.1.9 0l8.6-5c.4-.3.8-.9.8-1.3-.1-.1-.1-.5 0-.5z"></path></svg></a><a class="ml-1" href="https://orcid.org/0000-0002-7859-8394" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="w-4 h-4 inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span></div><div class="text-sm"><div>University of British Columbia</div></div><div><span class="font-semibold text-sm">Lindsey Heagy<a class="ml-1" href="https://orcid.org/0000-0002-1551-5926" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="w-4 h-4 inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span></div><div class="text-sm"><div>University of British Columbia</div></div><div><span class="font-semibold text-sm">Douglas Oldenburg<a class="ml-1" href="https://orcid.org/0000-0002-4327-2124" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="w-4 h-4 inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span></div><div class="text-sm"><div>University of British Columbia</div></div></div></header><div class="flex mt-2 text-sm font-light"><time dateTime="2016/08/01" class="text-spacer">August 1, 2016</time><div class="flex-none" title="DOI (Digital Object Identifier)"><a class="font-light hover:font-light no-underline hover:underline text-inherit hover:text-inherit" target="_blank" rel="noopener noreferrer" href="https://doi.org/10.1190/tle35080703.1">https://doi.org/10.1190/tle35080703.1</a></div></div></div><div class="flex items-center"><div class="flex-grow"></div></div><div id="TQVbFr5TZr" class="relative group/block article-grid article-subgrid-gap col-screen"><p>Equation (b) is a vector equation, so really it is two or three equations involving multiple components of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>j</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.137em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span><span style="top:-3.2285em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span></span>. We want to work with a single scalar equation, allow for anisotropic physical properties, and potentially work with non-axis-aligned meshes — how do we do this?! We can use the <strong>weak formulation</strong> where we take the inner product (<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∫</mo><mover accent="true"><mi>a</mi><mo>⃗</mo></mover><mo>⋅</mo><mover accent="true"><mi>b</mi><mo>⃗</mo></mover><mi>d</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">\int \vec{a} \cdot \vec{b} dv</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1111em;vertical-align:-0.3061em;"></span><span class="mop op-symbol small-op" style="margin-right:0.19445em;position:relative;top:-0.0006em;">∫</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">a</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9774em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9774em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">b</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span></span>) of the equation with a generic face function, <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>f</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{f}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1719em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9774em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.0688em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span></span>. This reduces requirements of differentiability on the original equation and also allows us to consider tensor anisotropy or curvilinear meshes (Haber 2014).</p><h2 id="scalar-equations-only-please" class="relative group"><span class="heading-text">Scalar equations only, please</span><a class="select-none no-underline px-2 font-normal transition-opacity opacity-0 group-hover:opacity-70" href="#scalar-equations-only-please" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>In Figure 5, we visually walk through the discretization of equation (b). On the left hand side, a dot product requires a <em>single</em> cartesian vector, <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mrow><msub><mi mathvariant="bold">j</mi><mi mathvariant="bold">x</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">j</mi><mi mathvariant="bold">y</mi></msub></mrow><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\mathbf{j_x, j_y}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mopen">[</span><span class="mord"><span class="mord"><span class="mord mathbf">j</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1611em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">j</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1611em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight" style="margin-right:0.01597em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span>. However, we have a <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span></span> defined on each face (2 <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>j</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">j_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> and 2 <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>j</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">j_y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9456em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span> in 2D!). There are many different ways to evaluate this inner product: we could approximate the integral using trapezoidal, midpoint or higher order approximations. A simple method is to break the integral into four sections (or 8 in 3D) and apply the midpoint rule for each section using the closest <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">j</mi></mrow><annotation encoding="application/x-tex">\mathbf{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathbf">j</span></span></span></span></span> components to compose a cartesian vector. A <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{P}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8361em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> matrix (size 2 × 4) is used to pick out the appropriate faces and compose the corresponding vector (these matrices are shown with colors corresponding to the appropriate face in the figure). On the right hand side, we use a vector identity to integrate by parts. The second term will cancel over the entire mesh (as the normals of adjacent cell faces point in opposite directions) and <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ϕ</span></span></span></span></span> on mesh boundary faces are zero by the Dirichlet boundary condition. This leaves us with the divergence, <span><span><a href="/tle-finitevolume/divergence">which we already know how to do</a></span><span class="exclude-from-outline absolute z-30 sm:max-w-[500px]" style="position:absolute;left:0;top:0"></span></span>!</p></div><div id="THhftew5gD" class="relative group/block article-grid article-subgrid-gap col-screen"><figure id="b8cf04cf" class="figure"><img style="margin:0 auto" src="/tle-finitevolume/build/weak-formulation-4b2a17d0b5767005d07fdb3714e0aa80.png" alt="Discretization using the weak formulation and inner products." data-canonical-url="../images/weak-formulation.png"/><figcaption class="group"><p><a class="select-none no-underline mr-1 text-inherit hover:text-inherit font-semibold hover:font-semibold hover:underline" href="#b8cf04cf" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->1<!-- -->:</a>Discretization using the weak formulation and inner products.</p></figcaption></figure></div><div id="OdgfD8CwPw" class="relative group/block article-grid article-subgrid-gap col-screen"><p>The final step is to recognize that, now discretized, we can cancel the general face function <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">f</mi></mrow><annotation encoding="application/x-tex">\mathbf{f}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span></span></span> and transpose the result (for convention&#x27;s sake):</p></div><div id="Wyh59Sv0aL" class="relative group/block article-grid article-subgrid-gap col-screen"><div id="CfnK1jLFYG" class="flex group my-5"><div class="overflow-x-auto flex-grow"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mn>1</mn><mn>4</mn></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>4</mn></munderover><msubsup><mi mathvariant="bold">P</mi><mi>i</mi><mi mathvariant="normal">⊤</mi></msubsup><msqrt><mi>v</mi></msqrt><msup><mi mathvariant="bold">Σ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><msqrt><mi>v</mi></msqrt><msub><mi mathvariant="bold">P</mi><mi>i</mi></msub><mi mathvariant="bold">j</mi><mo>=</mo><msup><mi mathvariant="bold">D</mi><mi mathvariant="normal">⊤</mi></msup><mi>v</mi><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\frac{1}{4} \sum_{i=1}^4 \mathbf{P}_i^\top \sqrt{v} \mathbf{\Sigma}^{-1} \sqrt{v} \mathbf{P}_i \mathbf{j} = \mathbf{D}^\top v \phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0788em;vertical-align:-1.2777em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8492em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span><span style="top:-2.8092em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1908em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathbf">Σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8492em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span><span style="top:-2.8092em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1908em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathbf">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathbf">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0935em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathbf">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">ϕ</span></span></span></span></span></div><div class="flex-none text-right m-0 pl-2 self-center relative select-none"><a class="select-none no-underline text-inherit hover:text-inherit hover:underline" href="#CfnK1jLFYG" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->1<!-- -->)</a></div></div></div><div id="ecl4g2XFQ1" class="relative group/block article-grid article-subgrid-gap col-screen"><h1 id="implementation" class="relative group"><span class="heading-text">Implementation</span><a class="select-none no-underline px-2 font-normal transition-opacity opacity-0 group-hover:opacity-70" href="#implementation" title="Link to this Section" aria-label="Link to this Section">¶</a></h1><p>We will start by using a SimPEG Mesh that only has a single cell.</p></div><div id="T1vJBYk7Cw" class="relative group/block article-grid article-subgrid-gap col-screen"><div class="relative group not-prose overflow-auto rounded shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:#fff;color:black"><code class="language-python" style="white-space:pre">%matplotlib inline
import discretize
import numpy as np
import matplotlib.pyplot as plt</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-5-output" data-mdast-node-type="output" data-mdast-node-id="iz2HSTP5eM" class="max-w-full overflow-auto m-0 group not-prose relative text-left"></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="POcXiez9sl" class="relative group/block article-grid article-subgrid-gap col-screen"><div class="relative group not-prose overflow-auto rounded shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:#fff;color:black"><code class="language-python" style="white-space:pre">fig, ax = plt.subplots(1)
mesh = discretize.TensorMesh([1,1])
mesh.plot_grid(ax=ax,centers=True,faces=True)
ax.set_xlim(-0.5,1.5)
ax.set_ylim(-0.5,1.5);</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-6-output" data-mdast-node-type="output" data-mdast-node-id="dDDtmCKtiY" class="max-w-full overflow-auto m-0 group not-prose relative text-left"><img src="/tle-finitevolume/build/12773d86204ce32b69335b9e65a42fcc.png" alt="&lt;Figure size 432x288 with 1 Axes&gt;"/></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="U36Rpjh7Uw" class="relative group/block article-grid article-subgrid-gap col-screen"><p>The figure above is of a single cell, which in 2D has four faces (the green triangles). Two of these are pointed in the x direction and two in the y direction.</p><p>For this single cell, we need our projection matrices to pick out four cartesian vectors that we will then use in evaluating the full integral.</p><p>Instead of creating the code from scratch in this notebook, we will leverage some of the internal functions that are in SimPEG. The code is straight forward, but can get a little bit intricate when working with multiple dimensions and indexing in a generalized way (i.e. works for all of the meshes).</p><p>If you ever want to see the exact code that is executed in a function, you can use two question marks (one for the docs only). For example, execute <strong><code>mesh._getFacePxx??</code></strong> and Jupyter will show you more than you ever wanted. :)</p></div><div id="t75IgWX5q1" class="relative group/block article-grid article-subgrid-gap col-screen"><div class="relative group not-prose overflow-auto rounded shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:#fff;color:black"><code class="language-python" style="white-space:pre"># mesh._getFacePxx??</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-8-output" data-mdast-node-type="output" data-mdast-node-id="EwJSkqv4gH" class="max-w-full overflow-auto m-0 group not-prose relative text-left"></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="Vw3h7w2QZt" class="relative group/block article-grid article-subgrid-gap col-screen"><p>This function creates the P matrices that we need. The matrix just pick out the appropriate faces and are used later on to evaluate our full integral.</p></div><div id="H7UBkcPgN0" class="relative group/block article-grid article-subgrid-gap col-screen"><div class="relative group not-prose overflow-auto rounded shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:#fff;color:black"><code class="language-python" style="white-space:pre"># face-x minus side and the face-y minus side
P1 = mesh._getFacePxx()(&#x27;fXm&#x27;,&#x27;fYm&#x27;)
print( P1.todense() )</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-10-output" data-mdast-node-type="output" data-mdast-node-id="DTHftiCKFS" class="max-w-full overflow-auto m-0 group not-prose relative text-left"><div><pre class="text-sm font-thin font-system"><code><span>[[1. 0. 0. 0.]
 [0. 0. 1. 0.]]
</span></code></pre></div></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="NPYn0G4Aeq" class="relative group/block article-grid article-subgrid-gap col-screen"><p>We can create and plot all of the matrices that were in Figure 5:</p></div><div id="ul3zcLewn1" class="relative group/block article-grid article-subgrid-gap col-screen"><div class="relative group not-prose overflow-auto rounded shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:#fff;color:black"><code class="language-python" style="white-space:pre">P1 = mesh._getFacePxx()(&#x27;fXm&#x27;,&#x27;fYm&#x27;)
P2 = mesh._getFacePxx()(&#x27;fXp&#x27;,&#x27;fYm&#x27;)
P3 = mesh._getFacePxx()(&#x27;fXm&#x27;,&#x27;fYp&#x27;)
P4 = mesh._getFacePxx()(&#x27;fXp&#x27;,&#x27;fYp&#x27;)
fig, ax = plt.subplots(1, 4, figsize=(15,3))

def plot_projection(ii, ax, P):
    ax.spy(P, ms=30)
    if P.shape[1]==4:
        ax.set_xticks(range(4))
        ax.set_xticklabels((&#x27;x-&#x27;,&#x27;x+&#x27;,&#x27;y-&#x27;,&#x27;y+&#x27;))
    ax.set_xlabel(&#x27;P{}&#x27;.format(ii+1))

list(map(plot_projection, range(4), ax, (P1, P2, P3, P4)));</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-12-output" data-mdast-node-type="output" data-mdast-node-id="ANUfj6mQhi" class="max-w-full overflow-auto m-0 group not-prose relative text-left"><img src="/tle-finitevolume/build/cda99d74a4fb1a26c7c527043848c7a6.png" alt="&lt;Figure size 1080x216 with 4 Axes&gt;"/></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="ehDqwQ479x" class="relative group/block article-grid article-subgrid-gap col-screen"><p>This assumes that we unwrapped our face vectors in certain way and they are ordered [xfaces, yfaces].</p></div><div id="osVpNNZQgh" class="relative group/block article-grid article-subgrid-gap col-screen"><h1 id="all-the-cells" class="relative group"><span class="heading-text">All the cells!</span><a class="select-none no-underline px-2 font-normal transition-opacity opacity-0 group-hover:opacity-70" href="#all-the-cells" title="Link to this Section" aria-label="Link to this Section">¶</a></h1><p>When we move to more cells the visualization of the matrix is not as clear, so instead we will show a connection from each cell center to the x and y faces that are selected by the P matrix.</p></div><div id="iYdGEJv4nX" class="relative group/block article-grid article-subgrid-gap col-screen"><div class="relative group not-prose overflow-auto rounded shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:#fff;color:black"><code class="language-python" style="white-space:pre">mesh = discretize.TensorMesh([3,4])</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-15-output" data-mdast-node-type="output" data-mdast-node-id="YMCF3MJ73f" class="max-w-full overflow-auto m-0 group not-prose relative text-left"></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="PX5eCJytyP" class="relative group/block article-grid article-subgrid-gap col-screen"><div class="relative group not-prose overflow-auto rounded shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:#fff;color:black"><code class="language-python" style="white-space:pre">P1 = mesh._getFacePxx()(&#x27;fXm&#x27;,&#x27;fYm&#x27;)
P2 = mesh._getFacePxx()(&#x27;fXp&#x27;,&#x27;fYm&#x27;)
P3 = mesh._getFacePxx()(&#x27;fXm&#x27;,&#x27;fYp&#x27;)
P4 = mesh._getFacePxx()(&#x27;fXp&#x27;,&#x27;fYp&#x27;)
fig, ax = plt.subplots(1,4, figsize=(15,6))
def plot_projection(ii, ax, P):
    x = P * np.r_[mesh.gridFx[:,0], mesh.gridFy[:,0]]
    y = P * np.r_[mesh.gridFx[:,1], mesh.gridFy[:,1]]
    xx, xy = x[:mesh.nC], x[mesh.nC:]
    yx, yy = y[:mesh.nC], y[mesh.nC:]
    ax.plot(np.c_[xx, mesh.gridCC[:,0], xx*np.nan].flatten(), np.c_[yx, mesh.gridCC[:,1], yx*np.nan].flatten(), &#x27;k-&#x27;)
    ax.plot(np.c_[xy, mesh.gridCC[:,0], xy*np.nan].flatten(), np.c_[yy, mesh.gridCC[:,1], yy*np.nan].flatten(), &#x27;k-&#x27;)
    ax.plot(xx, yx, &#x27;g&gt;&#x27;)
    ax.plot(xy, yy, &#x27;g^&#x27;)
    mesh.plot_grid(ax=ax, centers=True)
    ax.set_title(&#x27;P{}&#x27;.format(ii+1))
list(map(plot_projection, range(4), ax.flatten(), (P1, P2, P3, P4)));
plt.tight_layout()</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-16-output" data-mdast-node-type="output" data-mdast-node-id="KLqL2HI7WZ" class="max-w-full overflow-auto m-0 group not-prose relative text-left"><img src="/tle-finitevolume/build/f9d667553af77d56ef12d88e1c9f2789.png" alt="&lt;Figure size 1080x432 with 4 Axes&gt;"/></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="XkSLx12557" class="relative group/block article-grid article-subgrid-gap col-screen"><p>Each cell (the center is the red dot) has two faces that it uses, one x component and one y component.</p></div><div id="emaShin0Kz" class="relative group/block article-grid article-subgrid-gap col-screen"><p>The four <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></span> matrices are assembled and summed in the <strong>getFaceInnerProduct</strong> code using this formula:</p><div id="DDcd9DG10u" class="flex group my-5"><div class="overflow-x-auto flex-grow"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="bold">M</mi><mi>f</mi></msub><mo stretchy="false">(</mo><mi>σ</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mn>4</mn></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>4</mn></munderover><msubsup><mi mathvariant="bold">P</mi><mi>i</mi><mi mathvariant="normal">⊤</mi></msubsup><msqrt><mi>v</mi></msqrt><msup><mi mathvariant="bold">Σ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><msqrt><mi>v</mi></msqrt><msub><mi mathvariant="bold">P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{M}_f(\sigma) = \frac{1}{4}\sum_{i=1}^{4} \mathbf{P}_i^\top \sqrt{v} \boldsymbol{\Sigma}^{-1} \sqrt{v} \mathbf{P}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathbf">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.0788em;vertical-align:-1.2777em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8492em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span><span style="top:-2.8092em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1908em;"><span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">Σ</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8901em;"><span style="top:-3.139em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8492em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span><span style="top:-2.8092em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1908em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathbf">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></div><div class="flex-none text-right m-0 pl-2 self-center relative select-none"><a class="select-none no-underline text-inherit hover:text-inherit hover:underline" href="#DDcd9DG10u" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->2<!-- -->)</a></div></div><p>This function takes a sigma variable which can have any sort of anisotropy:</p><div id="lYOdJjkAzG" class="flex group my-5"><div class="overflow-x-auto flex-grow"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right" columnspacing=""><mtr><mtd class ="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mtable rowspacing="0.25em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtable rowspacing="0.25em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mover accent="true"><mi>μ</mi><mo>⃗</mo></mover><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>μ</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>μ</mi><mn>1</mn></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mstyle></mtd></mtr></mtable></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtable rowspacing="0.25em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mover accent="true"><mi>μ</mi><mo>⃗</mo></mover><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>μ</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>μ</mi><mn>2</mn></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mstyle></mtd></mtr></mtable></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtable rowspacing="0.25em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mover accent="true"><mi>μ</mi><mo>⃗</mo></mover><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>μ</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>μ</mi><mn>3</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>μ</mi><mn>3</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>μ</mi><mn>2</mn></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow></mstyle></mtd></mtr></mtable></mstyle></mtd></mtr></mtable></mstyle></mtd><mtd class ="mtr-glue"></mtd><mtd class ="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}\begin{aligned}\begin{split}\vec{\mu} = \left[\begin{matrix} \mu_{1} &amp; 0 \\ 0 &amp; \mu_{1} \end{matrix}\right]\end{split}\\\begin{split}\vec{\mu} = \left[\begin{matrix} \mu_{1} &amp; 0 \\ 0 &amp; \mu_{2} \end{matrix}\right]\end{split}\\\begin{split}\vec{\mu} = \left[\begin{matrix} \mu_{1} &amp; \mu_{3} \\ \mu_{3} &amp; \mu_{2} \end{matrix}\right]\end{split}\end{aligned}\end{align}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:9.3001em;vertical-align:-4.4em;"></span><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.9em;"><span style="top:-6.9em;"><span class="pstrut" style="height:6.75em;"></span><span class="mord"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.75em;"><span style="top:-6.75em;"><span class="pstrut" style="height:3.6em;"></span><span class="mord"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6em;"><span style="top:-3.6em;"><span class="pstrut" style="height:3.45em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">μ</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.75em;"><span class="pstrut" style="height:3.6em;"></span><span class="mord"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6em;"><span style="top:-3.6em;"><span class="pstrut" style="height:3.45em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">μ</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-0.75em;"><span class="pstrut" style="height:3.6em;"></span><span class="mord"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6em;"><span style="top:-3.6em;"><span class="pstrut" style="height:3.45em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">μ</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">μ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.25em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.4em;"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.9em;"><span style="top:-6.9em;"><span class="pstrut" style="height:6.75em;"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.4em;"><span></span></span></span></span></span></span></span></span></div><div class="flex-none text-right m-0 pl-2 self-center relative select-none"><a class="select-none no-underline text-inherit hover:text-inherit hover:underline" href="#lYOdJjkAzG" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->3<!-- -->)</a></div></div><p>The matrices that are produced by this function can be seen below!</p></div><div id="Z4N379t6ez" class="relative group/block article-grid article-subgrid-gap col-screen"><div class="relative group not-prose overflow-auto rounded shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:#fff;color:black"><code class="language-python" style="white-space:pre">isotropic       = np.ones(mesh.nC)*4
anisotropic_vec = np.r_[np.ones(mesh.nC)*4, np.ones(mesh.nC)]
anisotropic     = np.r_[np.ones(mesh.nC)*4, np.ones(mesh.nC), np.ones(mesh.nC)*3]
Mf_sig_i = mesh.get_face_inner_product(isotropic)
Mf_sig_v = mesh.get_face_inner_product(anisotropic_vec)
Mf_sig_a = mesh.get_face_inner_product(anisotropic)
clim = (
    np.min(map(np.min, (Mf_sig_i.data, Mf_sig_v.data, Mf_sig_a.data))),
    np.max(map(np.max, (Mf_sig_i.data, Mf_sig_v.data, Mf_sig_a.data)))
)
fig, ax = plt.subplots(1,3, figsize=(15,4))
def plot_spy(ax, Mf, title):
    dense = Mf.toarray()
    dense[dense == 0] = np.nan
    ms = ax.matshow(dense)#, clim=clim)
    plt.colorbar(ms, ax=ax)
    ax.set_xlabel(title)
list(map(plot_spy, ax, (Mf_sig_i, Mf_sig_v, Mf_sig_a), (&#x27;Isotropic&#x27;, &#x27;Coordinate Anisotropy&#x27;, &#x27;Full Anisotropy&#x27;)));</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-19-output" data-mdast-node-type="output" data-mdast-node-id="nEkVYedjSD" class="max-w-full overflow-auto m-0 group not-prose relative text-left"><img src="/tle-finitevolume/build/cc5726bda26e4959b42294f2cbf7efff.png" alt="&lt;Figure size 1080x288 with 6 Axes&gt;"/></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="EI47gztA7A" class="relative group/block article-grid article-subgrid-gap col-screen"><p>In the last figure you can see that there is coupling between the cells in x and y due to the non-coordinate aligned anisotropy. This will make the matrix system harder to solve when we try to invert it!</p></div><div id="oHSRsG2as2" class="relative group/block article-grid article-subgrid-gap col-screen"><h1 id="ok-but-does-it-work" class="relative group"><span class="heading-text">Ok, but does it work?</span><a class="select-none no-underline px-2 font-normal transition-opacity opacity-0 group-hover:opacity-70" href="#ok-but-does-it-work" title="Link to this Section" aria-label="Link to this Section">¶</a></h1><p>Unfortunately the testing of the innerproducts is not that visual. We need to make sure that the integral of some made up function evaluates to the correct value.</p><p>So to make something up, and integrate it, we will use <strong>sympy</strong>!</p><p>We will evaluate the integral:
</p><div id="F0VugzJNzh" class="flex group my-5"><div class="overflow-x-auto flex-grow"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mo>∫</mo><mn>0</mn><mn>1</mn></msubsup><msubsup><mo>∫</mo><mn>0</mn><mn>1</mn></msubsup><mi>σ</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mover accent="true"><mi>j</mi><mo>⃗</mo></mover><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>⋅</mo><mover accent="true"><mi>j</mi><mo>⃗</mo></mover><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mspace width="1em"/><mi>d</mi><mi>x</mi><mi>d</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">
\int_0^1 \int_0^1 \sigma(x,y) \vec{j}(x,y) \cdot \vec{j}(x,y) \quad dx dy</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.476em;vertical-align:-0.9119em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.564em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.564em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span><span style="top:-3.2285em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1925em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span><span style="top:-3.2285em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span></div><div class="flex-none text-right m-0 pl-2 self-center relative select-none"><a class="select-none no-underline text-inherit hover:text-inherit hover:underline" href="#F0VugzJNzh" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->4<!-- -->)</a></div></div><p>
by making up some ridiculous functions.</p></div><div id="QT4XmV61wg" class="relative group/block article-grid article-subgrid-gap col-screen"><div class="relative group not-prose overflow-auto rounded shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:#fff;color:black"><code class="language-python" style="white-space:pre">import sympy
from sympy.abc import x, y

# Here we will make up some j vectors that vary in space
j = sympy.Matrix([
    x**2+y*5,
    (5**2)*x+y*5
])

# Create an isotropic sigma vector
Sig = sympy.Matrix([
    [x*y*432/1163,      0      ],
    [     0      , x*y*432/1163]
])

# Do the inner product!
jTSj = j.T*Sig*j
ans  = sympy.integrate(sympy.integrate(jTSj, (x,0,1)), (y,0,1))[0] # The `[0]` is to make it an int.

print( &quot;It is trivial to see that the answer is {}.&quot;.format(ans) )</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-22-output" data-mdast-node-type="output" data-mdast-node-id="o493DRrZe9" class="max-w-full overflow-auto m-0 group not-prose relative text-left"><div><pre class="text-sm font-thin font-system"><code><span>It is trivial to see that the answer is 42.
</span></code></pre></div></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="qrGbkvngcs" class="relative group/block article-grid article-subgrid-gap col-screen"><p>Wonderful. Everything seems right in the world with that answer. Next step is to sub in the locations of the grid on both the faces in x and y as well as the cell centers.</p></div><div id="exK1fs9M2d" class="relative group/block article-grid article-subgrid-gap col-screen"><div class="relative group not-prose overflow-auto rounded shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:#fff;color:black"><code class="language-python" style="white-space:pre">def get_vectors(mesh):
    &quot;&quot;&quot;Gets the vectors sig and [jx, jy] from sympy.&quot;&quot;&quot;
    f_jx  = sympy.lambdify((x,y), j[0], &#x27;numpy&#x27;)
    f_jy  = sympy.lambdify((x,y), j[1], &#x27;numpy&#x27;)
    f_sig = sympy.lambdify((x,y), Sig[0], &#x27;numpy&#x27;)
    jx  = f_jx(mesh.gridFx[:,0], mesh.gridFx[:,1])
    jy  = f_jy(mesh.gridFy[:,0], mesh.gridFy[:,1])
    sig = f_sig(mesh.gridCC[:,0], mesh.gridCC[:,1])
    return sig, np.r_[jx, jy]</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-24-output" data-mdast-node-type="output" data-mdast-node-id="el18snc0Mn" class="max-w-full overflow-auto m-0 group not-prose relative text-left"></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="bHIMh81b0Z" class="relative group/block article-grid article-subgrid-gap col-screen"><p>Using these vectors (<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span></span></span> and <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">j</mi></mrow><annotation encoding="application/x-tex">\mathbf{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathbf">j</span></span></span></span></span>) we can evaluate the result on our mesh</p></div><div id="c9MeUITNRd" class="relative group/block article-grid article-subgrid-gap col-screen"><div class="relative group not-prose overflow-auto rounded shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:#fff;color:black"><code class="language-python" style="white-space:pre">n = 5 # get&#x27;s better if you add cells!
mesh = discretize.TensorMesh([n,n])
sig, jv = get_vectors(mesh)
Msig = mesh.get_face_inner_product(sig)
numeric_ans = jv.T.dot(Msig.dot(jv))
print( &quot;Numerically we get {}.&quot;.format(numeric_ans) )</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-26-output" data-mdast-node-type="output" data-mdast-node-id="XBocCgQoUX" class="max-w-full overflow-auto m-0 group not-prose relative text-left"><div><pre class="text-sm font-thin font-system"><code><span>Numerically we get 41.18917558039555.
</span></code></pre></div></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="z8O3HFj0xi" class="relative group/block article-grid article-subgrid-gap col-screen"><p>That is pretty close, but to be rigorous we should look at the order of the convergence which should be <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><msup><mi>h</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(h^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>.</p><p>SimPEG has a number of testing functions for
<a target="_blank" href="http://docs.simpeg.xyz/content/api_core/api_Tests.html#SimPEG.Tests.checkDerivative" rel="noreferrer">derivatives</a>
and
<a target="_blank" href="http://docs.simpeg.xyz/content/api_core/api_Tests.html#SimPEG.Tests.OrderTest" rel="noreferrer">order of convergence</a>
that make this pretty simple!</p></div><div id="mslXhiWQ6J" class="relative group/block article-grid article-subgrid-gap col-screen"><div class="relative group not-prose overflow-auto rounded shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:#fff;color:black"><code class="language-python" style="white-space:pre">import sys
import unittest
from discretize.tests import OrderTest

class Testify(OrderTest):
    meshDimension = 2
    def getError(self):
        sig, jv = get_vectors(self.M)
        Msig = self.M.get_face_inner_product(sig)
        return float(ans) - jv.T.dot(Msig.dot(jv))
    def test_order(self):
        self.orderTest()

# This just runs the unittest:
suite = unittest.TestLoader().loadTestsFromTestCase( Testify )
unittest.TextTestRunner().run( suite );</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-28-output" data-mdast-node-type="output" data-mdast-node-id="oD9uC3bmpQ" class="max-w-full overflow-auto m-0 group not-prose relative text-left"><div><pre class="text-sm font-thin font-system"><code><span>/opt/anaconda3/envs/simpeg/lib/python3.8/site-packages/discretize/utils/code_utils.py:247: FutureWarning: setupMesh has been deprecated, please use setup_mesh. It will be removed in version 1.0.0 of discretize.
  warnings.warn(
.</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>
uniformTensorMesh:  Order Test
_____________________________________________
   h  |    error    | e(i-1)/e(i) |  order
~~~~~~|~~~~~~~~~~~~~|~~~~~~~~~~~~~|~~~~~~~~~~
   4  |  1.27e+00   |
   8  |  3.17e-01   |   3.9942    |  1.9979
  16  |  7.93e-02   |   3.9985    |  1.9995
  32  |  1.98e-02   |   3.9996    |  1.9999
---------------------------------------------
Happy little convergence test!

</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>
----------------------------------------------------------------------
Ran 1 test in 0.090s

OK
</span></code></pre></div></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="ESMDEfDT00" class="relative group/block article-grid article-subgrid-gap col-screen"><p>These basic operations on the mesh for inner products and differential operators are core pieces of SimPEG, and they need to be tested continuously to ensure that no one has broken them!</p><p>On every single change to the SimPEG codebase many hours of testing are completed!</p></div><div id="yYPmghGnpR" class="relative group/block article-grid article-subgrid-gap col-screen"><h1 id="next-up" class="relative group"><span class="heading-text">Next up ...</span><a class="select-none no-underline px-2 font-normal transition-opacity opacity-0 group-hover:opacity-70" href="#next-up" title="Link to this Section" aria-label="Link to this Section">¶</a></h1><p>In the <span><span><a href="/tle-finitevolume/all-together-now">next notebook</a></span><span class="exclude-from-outline absolute z-30 sm:max-w-[500px]" style="position:absolute;left:0;top:0"></span></span> we will use our knowledge of the <span><span><a href="/tle-finitevolume/mesh">mesh</a></span><span class="exclude-from-outline absolute z-30 sm:max-w-[500px]" style="position:absolute;left:0;top:0"></span></span> and the <span><span><a href="/tle-finitevolume/divergence">divergence</a></span><span class="exclude-from-outline absolute z-30 sm:max-w-[500px]" style="position:absolute;left:0;top:0"></span></span> implementations to bring the DC resistivity equations together and show some pretty figures!</p></div><div class="flex space-x-4 my-10"></div><nav></nav></main></article><script>((d,f)=>{if(!window.history.state||!window.history.state.key){let m=Math.random().toString(32).slice(2);window.history.replaceState({key:m},"")}try{let _=JSON.parse(sessionStorage.getItem(d)||"{}")[f||window.history.state.key];typeof _=="number"&&window.scrollTo(0,_)}catch(m){console.error(m),sessionStorage.removeItem(d)}})("positions", null)</script><link rel="modulepreload" href="/tle-finitevolume/build/manifest-2E91AB14.js"/><link rel="modulepreload" href="/tle-finitevolume/build/entry.client-34LOLN62.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-STCNRLUL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RAQ24GF6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-GATM77RM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3TZSZRI6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KDXZNC3T.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-A22JXTHK.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ZSIJYUGB.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CBNYJD3L.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DVCLQKI7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WNJSKYG3.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PJMGMBEF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-K4RCRPLV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MRIGPM2R.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-22THSYFL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MMC7DYY7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QCCLA5MS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-GKEX5P47.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PEZFBKC5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-GTDPPE5F.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WJAI73GQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-K3TZNCZM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LDZM4ZQD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EOJFZMT2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RHXQDGRU.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SGOFNTDL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JRSC6QBF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5ZPDX7PC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-I6CDKV3U.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-2SVF2XVU.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-YEQXTS7N.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-6Q25IZ5I.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LAXY2Z7G.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-STDT2SES.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-YPFJUWOK.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RNKF7ZYK.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Y3YNFCGX.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-2LSBMUX5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3WL2G4JH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-INCGFJJF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LAPR5CPM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WSGNN42Q.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LU3YBBX7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IO4TB7PQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TSDPYKGF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-OMZ63QZB.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ZBISOK7U.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-BFBSQVLM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-6NCTOO7H.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-35WHJMWC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-YSHWLRE5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-AFEAABZJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-H7ARGAD6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-NBX3MV4B.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LMIZNBNM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DIMQGE5G.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IAVLWJTK.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-HDQQIMKH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PPT3ZRQO.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DNTJS3HB.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-S4ASJ6WF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RWHSI6SS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TNC2IPU2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-HFKBYAKP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PE33EVMV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FHO2R5HQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7C63K5ZS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WLUE5D5N.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VGRADKJH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-OWFODDTP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IW66K23Q.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KYNTYNCC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PI75YC4W.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EL6N5MSU.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QBHOJFHW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4BX5SM52.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QWH7N7D5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-NHIRP2UW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-6KSP4KLH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VBEDDNKJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-B2HWZEB2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-I7JFPAYF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FW7ZENTV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IJHX74IM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-X4KFDT3J.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-I34TMOY6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-242IW4WY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EK6E5JAG.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-65GQPTAP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-OVRHUZZH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5I37TIZC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3N5EHFNM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-BIWPEXNE.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IBCYTMNP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-POO5RHVM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-OF6DTJRZ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QR7ET4LW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7ZRRD45L.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TL55OYNZ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SCCI2NO7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EPJQPYA2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-L6C7BXKA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QDETX3JT.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RH4EV35E.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5KHJHUOA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EQFQMUSV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-NPAKE72N.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PHOSHZFJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Y3PIPDQ7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-XKEJZ5C2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JQBCSWND.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ZUMT74W6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LFWDUXHM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-OXKZZVGI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CTZWZHUQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-D6SYBG5Y.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3GF2HD7O.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7JHMMAVX.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-UQ6TCMQE.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ZWPTSOKS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RGMPOWKL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FO7QNBMJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5OAXYVES.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ULBOFEUJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-BGY2PCTD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RLEXZ676.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5XGARS2D.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EOG3HBB2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-UDALPQXN.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CMQNPUMD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ZTHCIUYW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-HD4XYXOQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-6REJDOM5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-P6CCROY3.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JPIL6CZA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WUGZA3GJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-R6VMYYLS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FIUXFW2P.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-XYG5SNFW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5D2C2ZDA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SW6XFMQD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5CYLIJGM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3Q2KBA6X.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TPIWPMHX.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Z4TDC2YQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LA2YA4XX.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JIVCDPO2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-35IRQLNA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5K545OGO.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3L3Z3F6X.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-AD4PBXM6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-XKDLTTDF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-2PWAQOA6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VJ3VAB3H.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CYAOAKX5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-AAY5LSVK.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-B23JCRYQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MPIN2NQF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LD53Z7OK.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FBK434DZ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-GGT4H2PL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Z7P6TLAI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TH6IRUKI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MKLGTMZG.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-X4YOA4FP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-GQ5F3JOI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-X7APFMBA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QGQCU7Z5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-XWH5YON6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-L5HMB5WH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FLGTY6ML.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MYHK3VFC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3OOET6B3.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7NDTMEBY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JTFUE3TU.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-NPNO47VJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CEJPUMDN.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3UCYOZRC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QW3YGU7K.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4IDUKFNS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-BHAGSTTY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-NVGCL4ST.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CAPUTC5J.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FCUGECQA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-T5LEH3GP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QYFXPV5P.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ICZ2IBMN.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-2LGL2A76.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JW5HIPWL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WPIFJFBP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EI7MM2ZM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CPP55WXY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CMHA6RZZ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-737BPBEV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3A5424CL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JBWUJHML.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5EU2WZ4K.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-U4JP6WYN.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-6VMC3C6H.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DPD34KFT.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-P3HINRLA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-OEMWIF5I.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3ICMK33L.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-UVDURX6W.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EW2JJMFI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3IRPCF34.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MTWD2M7E.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-H7DOBPSH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FBVPMWWA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QMWX2HBM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JECYL6B6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7VXWSOTE.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-OFRX2LO7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IZ74E2PR.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LYZU5FLL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4QSJGUBC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-6NQHZQ5K.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3QPZ4I6A.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ID6MLM44.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ONF5ZEGX.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DCFHNYE2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WJC2TMC3.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Z4DXDTUR.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QJ653JTH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JB3B6A6E.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-GSHJN3MF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FEKTRG3M.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MPEWCBTI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-M6K2JCPM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FOUTP5HW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-OTRPIZML.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IKIZ2PYB.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VBLH3B7N.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-E724CIFR.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-F7RAUHZW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-577UU5TB.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-H5PDIPNZ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4R3JC4QW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-GNWNFVG7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JDKLS2ST.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RG2LYK5A.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7LUKHWIG.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KMNLZGTB.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-2KDE3HUQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-T7CNODMI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-UDP4Q2IW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SJW5G5ZV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-HGNYMY75.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5N53WRE2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IMXUHBPL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3ZCVCFNE.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-BN7JUA2J.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ILC5MFOH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WE62QWZJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TJKSLYFR.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KHHVIB5E.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MIEZSYDG.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DGWOMBJL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Q6WM2H72.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ZIMHSXAS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SUG474HR.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PCOW4WWS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CIYXD62H.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MDFBER5W.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-GX3CRW3F.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DGXGRRYX.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SSPVJ6IS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-HSSYMLB3.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-K4SMJ7WJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5GXFTTWI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PTBOR72Y.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LFO3DTKE.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-73RIUVPQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-G3WMP5TT.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Q7I77NW3.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RBSMNSRG.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TUTQC6ID.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5UGH6N65.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PZ433YLG.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SE6PSEOU.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EGAOT2MX.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-J4DVQC56.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-2HJQA6UR.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-AGF2AH6W.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-NQTTBETD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-HBD5TQ2W.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-BACRIHFA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-243ERP6K.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KVJXK4XS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4N3NM4UF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KEHCZZC6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IUFDJPNC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RHRSIKTF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LFJ5TAP5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5PKXRQNT.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IOD7UDJW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-UWNWXDHD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KKTDCDBD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EVHKG4ID.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-HZZT2QMW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SW2DO3HC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-UND5NCGU.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-N7BF3QMQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7DGHQJFM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-27JJJT5J.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7QILXESG.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QCI56KOS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IXXNFT7F.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FWUCSQCC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IRAY7AJW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DFU4VUYA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-AHRRAAFU.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FESZSXW4.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3VZJTP67.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-BE4WR3U4.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DFWGE7D2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7LKNMJOX.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VBOASNGM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-NVJX6L3I.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MUFDH4AZ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PCR5CMRA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KWT6S4ZV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5EGBKIHD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4BM4EP7Z.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-2K3JD7CH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RYSRWBFG.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-R76BX44Y.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EK6V5TFM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WIU3N2FZ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EUE65WU3.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4UPEPJRI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3HC64KIS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-E7XN57I6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VD4LJQH2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-67TXQYDP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-BEK3ZAYS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ZUMZ7YJB.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KQ7IVWBF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-C7ZQ7QWM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EFKCDIR4.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Y2A4AEYV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-UDIA6SFH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DXS5MIF7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CU3ZAA3J.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DLV26HDB.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-YWKBZMKK.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IXBCY7Z5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-XPKNF2GY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EXKS2N3U.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4CEEQ2WE.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-NNZYS7WL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3PWB3N72.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KDJ5AN5I.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IUKUVFD7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VI4FDREV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DRI5LEAT.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PXNDIUUW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WCSHVD66.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-44BZ4THS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KB6HQ3EV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-2IYZCRU7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ZC7GDBHQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MCW2X7P7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DBUVFRIJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-6GVV3CEI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-2ABAEOW6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3FPQWUCY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QOWH7JTY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4UQMVVJD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-57KO4L4Z.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PFDMZH4N.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JEBEDPBU.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3UFOYY7A.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DIUUOJG4.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-6KM7QLBA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QPEXGL65.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QOOYPE7X.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TYPZLHDR.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-NA5I5QSJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SVTVILDP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-NQOKPCQW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LBLFO2HD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-YBORSE7I.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-BNGMH6DJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TZEP4DU4.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WCZT4D6O.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EPZEB247.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-V36SVQOY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4NAMW6WM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Q7C3UT7I.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4NBANXMK.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-B6HZCSXG.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KYUAMBOV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QXS4MDGE.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-XO4MHCV5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-K23AXNVS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MNH6Q45X.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KHSXAZVY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-I5HZ6ZYD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DD3EWMVQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-K3DINP7C.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SZCYG5DL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-G6K2WDLD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TT6A6KRU.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FFELNGZL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-XCR3PWHN.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KESEDRO7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3DPXFF7X.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-P2KWQRNH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-HE2JMOB7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7DAB7OQH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7BNPYNPF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-F6PJ5VKY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VEB4DE47.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3Z7Y2QVW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MJ2VZ5KW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-M5AYHQJ4.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EFVWKFVT.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ICIFS5EX.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ZOSHAV3A.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5RZV4TWL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4KTLW4ZP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-T5E3KDVE.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-G4EWYFK2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ERF5MWXM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CFFS7EVD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QUDMGLFB.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7P32TNPW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JNYJ45RP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QINAB234.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-XXXALNY2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-74EWDK7I.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Q4IILUOS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-23WVLS7Q.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TL662EAH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MTQ2LD43.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-H6F4WG4L.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3WQU5EXB.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LDELMZ4A.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WDVSZKGW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-YBLFDHYD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-AGHHASP5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VAFNTHPE.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-GSQMQQYC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MWV6DYON.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DAFCVUAF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WXZLAVXJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4VFJTBR6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FKLMBUGG.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Q7PP7CGY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-56EHYZPP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-AJUK5WL4.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-XCY37IJJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4JJCRQLI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-6KRBY7ML.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QGRYECQP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-A5LRZ46O.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TFVFGSAC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CUXHMWVY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VLWCT2QF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-6AZYACTL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3K4C4EPY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-BMYASLMN.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WYLJH6RZ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ZJYHOD4M.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-STYFKBEC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-K6CGA3JU.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-26ODLRKY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-GQVYEF7L.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-O2ZMCC5B.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EGDTKE4G.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TZM7LRM3.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CUPAVG4I.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PBNVY5X4.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SHFEZ3LD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-U4F6TERZ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LIGNPJJR.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KIIZZSG2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-UV53JTY3.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VB6MEWRX.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-32OQE7MH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3VPM6F4D.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-P34ZT5AA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MTBRW4O3.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TTGWMB65.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IWHXKN3M.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-2LPZT57S.js"/><link rel="modulepreload" href="/tle-finitevolume/build/root-3VTM3HH5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IPZA66IR.js"/><link rel="modulepreload" href="/tle-finitevolume/build/routes/$-OY73AADE.js"/><script>window.__remixContext = {"state":{"loaderData":{"root":{"theme":"light","config":{"title":"Pixels and Their Neighbours: Finite Volume","logo_text":"Pixels and their neighbours","myst":"v1","nav":[],"actions":[{"title":"Download PDF","filename":"cockett-heagy-oldenburg-2016.pdf","url":"/tle-finitevolume/build/cockett-heagy-oldenb-c6bbd4ad57b7a4be56ea2682a7fd4a03.pdf","static":true}],"projects":[{"date":"2016/08/01","doi":"10.1190/tle35080703.1","open_access":true,"license":{"content":{"id":"CC-BY-SA-3.0","name":"Creative Commons Attribution Share Alike 3.0 Unported","CC":true,"url":"https://creativecommons.org/licenses/by-sa/3.0/"},"code":{"id":"MIT","name":"MIT License","osi":true,"free":true,"url":"https://opensource.org/licenses/MIT"}},"subject":"tutorial","exports":[{"format":"pdf","article":"paper.md"},{"format":"docx","article":"paper.md"},{"format":"xml","article":"paper.md","sub_articles":["notebooks/overview.ipynb","notebooks/mesh.ipynb","notebooks/divergence.ipynb","notebooks/weak-formulation.ipynb","notebooks/all-together-now.ipynb"]}],"title":"Pixels and Their Neighbours","subtitle":"Methods for Finite Volume Simulations","authors":[{"name":"Rowan Cockett","orcid":"0000-0002-7859-8394","corresponding":true,"email":"rowan@curvenote.com","affiliations":["University of British Columbia"]},{"name":"Lindsey Heagy","orcid":"0000-0002-1551-5926","affiliations":["University of British Columbia"]},{"name":"Douglas Oldenburg","orcid":"0000-0002-4327-2124","affiliations":["University of British Columbia"]}],"venue":{"title":"The Leading Edge"},"github":"https://github.com/simpeg/tle-finitevolume","bibliography":[],"index":"paper","pages":[{"slug":"index","title":"Getting Started","description":"","date":"2016/08/01","thumbnail":"/tle-finitevolume/build/dc-setup-613da4e1507fa3e37aae2ebfe06df13a.png","thumbnailOptimized":"","tags":[],"level":1},{"slug":"mesh","title":"Finite Volume Mesh","description":"","date":"2016/08/01","thumbnail":"/tle-finitevolume/build/mesh-e776e801e0f099683f149fbe1d1c92f5.png","thumbnailOptimized":"","tags":[],"level":1},{"slug":"divergence","title":"Divergence Operator","description":"","date":"2016/08/01","thumbnail":"/tle-finitevolume/build/divergence-c0bef8172fc19fa7f262e78596c71990.png","thumbnailOptimized":"","tags":[],"level":1},{"slug":"weak-formulation","title":"Weak Formulation","description":"","date":"2016/08/01","thumbnail":"/tle-finitevolume/build/weak-formulation-4b2a17d0b5767005d07fdb3714e0aa80.png","thumbnailOptimized":"","tags":[],"level":1},{"slug":"all-together-now","title":"All Together Now","description":"We will use our knowledge of the mesh and the divergence implementations to bring the DC resistivity equations together and show some pretty figures.","date":"2016/08/01","thumbnail":"/tle-finitevolume/build/all-together-now-b0ea50a11da3eab8c7ff01e4d07eae45.png","thumbnailOptimized":"","tags":[],"level":1}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/tle-finitevolume"},"routes/$":{"kind":"Notebook","sha256":"549070bf994991f173ab81712a28103cfbb83574ff4476927fbf549197f4f782","slug":"weak-formulation","dependencies":[],"frontmatter":{"title":"Weak Formulation","authors":[{"name":"Rowan Cockett","orcid":"0000-0002-7859-8394","corresponding":true,"email":"rowan@curvenote.com","affiliations":["University of British Columbia"]},{"name":"Lindsey Heagy","orcid":"0000-0002-1551-5926","affiliations":["University of British Columbia"]},{"name":"Douglas Oldenburg","orcid":"0000-0002-4327-2124","affiliations":["University of British Columbia"]}],"date":"2016/08/01","doi":"10.1190/tle35080703.1","open_access":true,"license":{"content":{"id":"CC-BY-SA-3.0","name":"Creative Commons Attribution Share Alike 3.0 Unported","CC":true,"url":"https://creativecommons.org/licenses/by-sa/3.0/"},"code":{"id":"MIT","name":"MIT License","osi":true,"free":true,"url":"https://opensource.org/licenses/MIT"}},"github":"https://github.com/simpeg/tle-finitevolume","subject":"tutorial","venue":{"title":"The Leading Edge"},"thumbnail":"/tle-finitevolume/build/weak-formulation-4b2a17d0b5767005d07fdb3714e0aa80.png","exports":[{"format":"ipynb","filename":"weak-formulation.ipynb","url":"/tle-finitevolume/build/weak-formulation-31a7109fa35fb97882716748a9f9c3f8.ipynb"}]},"mdast":{"type":"root","children":[{"type":"block","position":{"start":{"line":0,"column":0},"end":{"line":1,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":0},"end":{"line":5,"column":0}},"children":[{"type":"text","value":"Equation (b) is a vector equation, so really it is two or three equations involving multiple components of ","key":"d6N5upZJkK"},{"type":"inlineMath","value":"\\vec{j}","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmo\u003e⃗\u003c/mo\u003e\u003c/mover\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\vec{j}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.137em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9425em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.2285em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.2355em;\"\u003e\u003cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'\u003e\u003cpath d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1944em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"dcRiacgTaF"},{"type":"text","value":". We want to work with a single scalar equation, allow for anisotropic physical properties, and potentially work with non-axis-aligned meshes — how do we do this?! We can use the ","key":"lsGQZmB3YN"},{"type":"strong","children":[{"type":"text","value":"weak formulation","key":"VMU4LKqqyP"}],"key":"rpr9ZLQP7p"},{"type":"text","value":" where we take the inner product (","key":"b48Z0bndOa"},{"type":"inlineMath","value":"\\int \\vec{a} \\cdot \\vec{b} dv","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmo\u003e∫\u003c/mo\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003ea\u003c/mi\u003e\u003cmo\u003e⃗\u003c/mo\u003e\u003c/mover\u003e\u003cmo\u003e⋅\u003c/mo\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003eb\u003c/mi\u003e\u003cmo\u003e⃗\u003c/mo\u003e\u003c/mover\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmi\u003ev\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\int \\vec{a} \\cdot \\vec{b} dv\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.1111em;vertical-align:-0.3061em;\"\u003e\u003c/span\u003e\u003cspan class=\"mop op-symbol small-op\" style=\"margin-right:0.19445em;position:relative;top:-0.0006em;\"\u003e∫\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.714em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ea\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.2355em;\"\u003e\u003cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'\u003e\u003cpath d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⋅\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.9774em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9774em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eb\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.2634em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.2355em;\"\u003e\u003cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'\u003e\u003cpath d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ev\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"jEz9DjApJZ"},{"type":"text","value":") of the equation with a generic face function, ","key":"wdiQVkjLZY"},{"type":"inlineMath","value":"\\vec{f}","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003ef\u003c/mi\u003e\u003cmo\u003e⃗\u003c/mo\u003e\u003c/mover\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\vec{f}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.1719em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9774em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.2634em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.0688em;\"\u003e\u003cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'\u003e\u003cpath d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1944em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"xPTCXr8jxx"},{"type":"text","value":". This reduces requirements of differentiability on the original equation and also allows us to consider tensor anisotropy or curvilinear meshes (Haber 2014).","key":"uweVxnUQFg"}],"key":"P8TY8vBx3f"},{"type":"heading","depth":2,"position":{"start":{"line":6,"column":0},"end":{"line":7,"column":0}},"children":[{"type":"text","value":"Scalar equations only, please","key":"FHJjaiIbBn"}],"identifier":"scalar-equations-only-please","label":"Scalar equations only, please","html_id":"scalar-equations-only-please","implicit":true,"key":"qWoIIkPP6E"},{"type":"paragraph","position":{"start":{"line":8,"column":0},"end":{"line":9,"column":0}},"children":[{"type":"text","value":"In Figure 5, we visually walk through the discretization of equation (b). On the left hand side, a dot product requires a ","key":"Is1rfrvNJv"},{"type":"emphasis","children":[{"type":"text","value":"single","key":"xESWI6YtQR"}],"key":"Q3OVRdDshq"},{"type":"text","value":" cartesian vector, ","key":"ytzCYHWVNu"},{"type":"inlineMath","value":"[\\mathbf{j_x, j_y}]","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmo stretchy=\"false\"\u003e[\u003c/mo\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003cmi mathvariant=\"bold\"\u003ex\u003c/mi\u003e\u003c/msub\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmsub\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003cmi mathvariant=\"bold\"\u003ey\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cmo stretchy=\"false\"\u003e]\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e[\\mathbf{j_x, j_y}]\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e[\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003ej\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1611em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathbf mtight\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003ej\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1611em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathbf mtight\" style=\"margin-right:0.01597em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e]\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Ah7hyomdO1"},{"type":"text","value":". However, we have a ","key":"NFjha40YQR"},{"type":"inlineMath","value":"j","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ej\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ej\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"bdXyRecq5f"},{"type":"text","value":" defined on each face (2 ","key":"IdVTimdqTL"},{"type":"inlineMath","value":"j_x","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ej_x\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"cwWVPJBJ6v"},{"type":"text","value":" and 2 ","key":"Z6saEBOvBR"},{"type":"inlineMath","value":"j_y","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ej_y\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.9456em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Ph90xfzqZG"},{"type":"text","value":" in 2D!). There are many different ways to evaluate this inner product: we could approximate the integral using trapezoidal, midpoint or higher order approximations. A simple method is to break the integral into four sections (or 8 in 3D) and apply the midpoint rule for each section using the closest ","key":"S5Jai3a9Z9"},{"type":"inlineMath","value":"\\mathbf{j}","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{j}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"RWxHCiz0Pf"},{"type":"text","value":" components to compose a cartesian vector. A ","key":"zxAgmRKPeo"},{"type":"inlineMath","value":"\\mathbf{P}_i","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi mathvariant=\"bold\"\u003eP\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{P}_i\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eP\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"mh9ra9LR82"},{"type":"text","value":" matrix (size 2 × 4) is used to pick out the appropriate faces and compose the corresponding vector (these matrices are shown with colors corresponding to the appropriate face in the figure). On the right hand side, we use a vector identity to integrate by parts. The second term will cancel over the entire mesh (as the normals of adjacent cell faces point in opposite directions) and ","key":"nvjRTl40Qx"},{"type":"inlineMath","value":"\\phi","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eϕ\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\phi\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eϕ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"b07FskH7CI"},{"type":"text","value":" on mesh boundary faces are zero by the Dirichlet boundary condition. This leaves us with the divergence, ","key":"ifi5pz3vXl"},{"type":"link","url":"/divergence","children":[{"type":"text","value":"which we already know how to do","key":"vUwnozq1hK"}],"urlSource":"divergence.ipynb","internal":true,"dataUrl":"/divergence.json","protocol":"file","key":"cz4SYwBSQt"},{"type":"text","value":"!","key":"LtOyGgHbz2"}],"key":"b0iGlzRaGK"}],"data":{"id":"nb-cell-0","type":"notebook-content","iooxa":{"id":{"block":"XRXnNzNyUsLV40Qxc5IJ","project":"5dxSs15hZtvQDKSzFgjP","version":2}}},"identifier":"nb-cell-0","label":"nb-cell-0","html_id":"nb-cell-0","key":"TQVbFr5TZr"},{"type":"block","position":{"start":{"line":10,"column":0},"end":{"line":11,"column":0}},"children":[{"type":"container","kind":"figure","identifier":"b8cf04cf","label":"b8cf04cf","children":[{"type":"image","url":"/tle-finitevolume/build/weak-formulation-4b2a17d0b5767005d07fdb3714e0aa80.png","alt":"Discretization using the weak formulation and inner products.","urlSource":"../images/weak-formulation.png","key":"yEh1UHBgXL"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":16,"column":0},"end":{"line":17,"column":0}},"children":[{"type":"captionNumber","kind":"figure","label":"b8cf04cf","identifier":"b8cf04cf","html_id":"b8cf04cf","enumerator":"1","children":[{"type":"text","value":"Figure ","key":"NqkKi9fxwN"},{"type":"text","value":"1","key":"NfSfAGRgxP"},{"type":"text","value":":","key":"PCBuWdGm8O"}],"template":"Figure %s:","key":"KeNBe6GQN2"},{"type":"text","value":"Discretization using the weak formulation and inner products.","key":"BB8PpIHPET"}],"key":"BVL96F9Z1j"}],"key":"Qo0kGd9zg8"}],"enumerator":"1","html_id":"b8cf04cf","key":"IEAwxKIbBy"}],"data":{"id":"nb-cell-1","type":"notebook-content","iooxa":{"id":{"block":"mdDk7ewGdTdUKlz8g7yg","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-1","label":"nb-cell-1","html_id":"nb-cell-1","key":"THhftew5gD"},{"type":"block","position":{"start":{"line":19,"column":0},"end":{"line":20,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":21,"column":0},"end":{"line":22,"column":0}},"children":[{"type":"text","value":"The final step is to recognize that, now discretized, we can cancel the general face function ","key":"snUt68FXgI"},{"type":"inlineMath","value":"\\mathbf{f}","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003ef\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{f}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\" style=\"margin-right:0.10903em;\"\u003ef\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"CIZQ3kiAV0"},{"type":"text","value":" and transpose the result (for convention's sake):","key":"Vj8gtHutkD"}],"key":"YHL8SWl9ii"}],"data":{"id":"nb-cell-2","type":"notebook-content","iooxa":{"id":{"block":"E0m5Jh7cTFESjbe0zrGb","project":"5dxSs15hZtvQDKSzFgjP","version":2}}},"identifier":"nb-cell-2","label":"nb-cell-2","html_id":"nb-cell-2","key":"OdgfD8CwPw"},{"type":"block","position":{"start":{"line":23,"column":0},"end":{"line":24,"column":0}},"children":[{"type":"math","value":"\\frac{1}{4} \\sum_{i=1}^4 \\mathbf{P}_i^\\top \\sqrt{v} \\mathbf{\\Sigma}^{-1} \\sqrt{v} \\mathbf{P}_i \\mathbf{j} = \\mathbf{D}^\\top v \\phi","position":{"start":{"line":25,"column":0},"end":{"line":26,"column":0}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmfrac\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmn\u003e4\u003c/mn\u003e\u003c/mfrac\u003e\u003cmunderover\u003e\u003cmo\u003e∑\u003c/mo\u003e\u003cmrow\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003cmn\u003e4\u003c/mn\u003e\u003c/munderover\u003e\u003cmsubsup\u003e\u003cmi mathvariant=\"bold\"\u003eP\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmi mathvariant=\"normal\"\u003e⊤\u003c/mi\u003e\u003c/msubsup\u003e\u003cmsqrt\u003e\u003cmi\u003ev\u003c/mi\u003e\u003c/msqrt\u003e\u003cmsup\u003e\u003cmi mathvariant=\"bold\"\u003eΣ\u003c/mi\u003e\u003cmrow\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003c/msup\u003e\u003cmsqrt\u003e\u003cmi\u003ev\u003c/mi\u003e\u003c/msqrt\u003e\u003cmsub\u003e\u003cmi mathvariant=\"bold\"\u003eP\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003c/msub\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmsup\u003e\u003cmi mathvariant=\"bold\"\u003eD\u003c/mi\u003e\u003cmi mathvariant=\"normal\"\u003e⊤\u003c/mi\u003e\u003c/msup\u003e\u003cmi\u003ev\u003c/mi\u003e\u003cmi\u003eϕ\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\frac{1}{4} \\sum_{i=1}^4 \\mathbf{P}_i^\\top \\sqrt{v} \\mathbf{\\Sigma}^{-1} \\sqrt{v} \\mathbf{P}_i \\mathbf{j} = \\mathbf{D}^\\top v \\phi\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:3.0788em;vertical-align:-1.2777em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3214em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e4\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mop op-limits\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.8011em;\"\u003e\u003cspan style=\"top:-1.8723em;margin-left:0em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.05em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003cspan class=\"mrel mtight\"\u003e=\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.05em;\"\u003e\u003c/span\u003e\u003cspan\u003e\u003cspan class=\"mop op-symbol large-op\"\u003e∑\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-4.3em;margin-left:0em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.05em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e4\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.2777em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eP\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8991em;\"\u003e\u003cspan style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.113em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e⊤\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.247em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord sqrt\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8492em;\"\u003e\u003cspan class=\"svg-align\" style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\" style=\"padding-left:0.833em;\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ev\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-2.8092em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'\u003e\u003cpath d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1908em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eΣ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8641em;\"\u003e\u003cspan style=\"top:-3.113em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e−\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord sqrt\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8492em;\"\u003e\u003cspan class=\"svg-align\" style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\" style=\"padding-left:0.833em;\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ev\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-2.8092em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'\u003e\u003cpath d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1908em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eP\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ej\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0935em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eD\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8991em;\"\u003e\u003cspan style=\"top:-3.113em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e⊤\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ev\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eϕ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"1","key":"CfnK1jLFYG"}],"data":{"id":"nb-cell-3","type":"notebook-content","iooxa":{"id":{"block":"k3ce9vtzui0ybKCPtcIK","project":"5dxSs15hZtvQDKSzFgjP","version":3}}},"identifier":"nb-cell-3","label":"nb-cell-3","html_id":"nb-cell-3","key":"Wyh59Sv0aL"},{"type":"block","position":{"start":{"line":27,"column":0},"end":{"line":28,"column":0}},"children":[{"type":"heading","depth":1,"position":{"start":{"line":29,"column":0},"end":{"line":30,"column":0}},"children":[{"type":"text","value":"Implementation","key":"K5HaF3kPgV"}],"identifier":"implementation","label":"Implementation","html_id":"implementation","implicit":true,"key":"s3oPmfyiLs"},{"type":"paragraph","position":{"start":{"line":31,"column":0},"end":{"line":32,"column":0}},"children":[{"type":"text","value":"We will start by using a SimPEG Mesh that only has a single cell.","key":"kLUCu7zeof"}],"key":"J0ta1kKxvi"}],"data":{"id":"nb-cell-4","type":"notebook-content","iooxa":{"id":{"block":"GAbpJlNVTjUM0Z5vtT50","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-4","label":"nb-cell-4","html_id":"nb-cell-4","key":"ecl4g2XFQ1"},{"type":"block","position":{"start":{"line":33,"column":0},"end":{"line":34,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"%matplotlib inline\nimport discretize\nimport numpy as np\nimport matplotlib.pyplot as plt","identifier":"nb-cell-5-code","enumerator":"1","html_id":"nb-cell-5-code","key":"weh05uQl79"},{"type":"output","id":"BwjI0smETWPnp_4tzT7AH","data":[],"identifier":"nb-cell-5-output","html_id":"nb-cell-5-output","key":"iz2HSTP5eM"}],"data":{"id":"nb-cell-5","type":"notebook-code","collapsed":true,"iooxa":{"id":{"block":"YzzyeWqgAuqxx0PAoA4q","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"P9oBPKfsnXyc0cZTOYEe","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":true}},"identifier":"nb-cell-5","label":"nb-cell-5","html_id":"nb-cell-5","key":"T1vJBYk7Cw"},{"type":"block","position":{"start":{"line":46,"column":0},"end":{"line":47,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(1)\nmesh = discretize.TensorMesh([1,1])\nmesh.plot_grid(ax=ax,centers=True,faces=True)\nax.set_xlim(-0.5,1.5)\nax.set_ylim(-0.5,1.5);","identifier":"nb-cell-6-code","enumerator":"2","html_id":"nb-cell-6-code","key":"gCqGIbuPCe"},{"type":"output","id":"GuULgSqbZwf1xG0cSU-pZ","data":[{"output_type":"display_data","metadata":{"needs_background":"light"},"data":{"image/png":{"content_type":"image/png","hash":"12773d86204ce32b69335b9e65a42fcc","path":"/tle-finitevolume/build/12773d86204ce32b69335b9e65a42fcc.png"},"text/plain":{"content":"\u003cFigure size 432x288 with 1 Axes\u003e","content_type":"text/plain"}}}],"identifier":"nb-cell-6-output","html_id":"nb-cell-6-output","key":"dDDtmCKtiY"}],"data":{"id":"nb-cell-6","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"hb8q7AI0MaxLo3uw6PuF","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"jXh403rknR7GhoyOIml3","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-6","label":"nb-cell-6","html_id":"nb-cell-6","key":"POcXiez9sl"},{"type":"block","position":{"start":{"line":60,"column":0},"end":{"line":61,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":62,"column":0},"end":{"line":63,"column":0}},"children":[{"type":"text","value":"The figure above is of a single cell, which in 2D has four faces (the green triangles). Two of these are pointed in the x direction and two in the y direction.","key":"CCzcB7fMuG"}],"key":"luUJCcG00V"},{"type":"paragraph","position":{"start":{"line":64,"column":0},"end":{"line":65,"column":0}},"children":[{"type":"text","value":"For this single cell, we need our projection matrices to pick out four cartesian vectors that we will then use in evaluating the full integral.","key":"LGCvG2JQDP"}],"key":"LvV4UjaguF"},{"type":"paragraph","position":{"start":{"line":66,"column":0},"end":{"line":67,"column":0}},"children":[{"type":"text","value":"Instead of creating the code from scratch in this notebook, we will leverage some of the internal functions that are in SimPEG. The code is straight forward, but can get a little bit intricate when working with multiple dimensions and indexing in a generalized way (i.e. works for all of the meshes).","key":"DW0WwUO1pY"}],"key":"bPYxUOyGU6"},{"type":"paragraph","position":{"start":{"line":68,"column":0},"end":{"line":69,"column":0}},"children":[{"type":"text","value":"If you ever want to see the exact code that is executed in a function, you can use two question marks (one for the docs only). For example, execute ","key":"i1Q6aDn0p5"},{"type":"strong","children":[{"type":"inlineCode","value":"mesh._getFacePxx??","key":"FPcCGnbFjN"}],"key":"qMk1XuFvBg"},{"type":"text","value":" and Jupyter will show you more than you ever wanted. :)","key":"CmDDJ4sJGH"}],"key":"RYLDOaGRcY"}],"data":{"id":"nb-cell-7","type":"notebook-content","iooxa":{"id":{"block":"bEL0LOMgs2fnWo7TPzdf","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-7","label":"nb-cell-7","html_id":"nb-cell-7","key":"U36Rpjh7Uw"},{"type":"block","position":{"start":{"line":70,"column":0},"end":{"line":71,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"# mesh._getFacePxx??","identifier":"nb-cell-8-code","enumerator":"3","html_id":"nb-cell-8-code","key":"RJKYXFGZGf"},{"type":"output","id":"7B-10MzoBITceDB9O9C8b","data":[],"identifier":"nb-cell-8-output","html_id":"nb-cell-8-output","key":"EwJSkqv4gH"}],"data":{"id":"nb-cell-8","type":"notebook-code","iooxa":{"id":{"block":"WnkAvpsgmPr1AwUiZyzi","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"mTYUldRSnhSmbCTyfMXG","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"tags":[]},"identifier":"nb-cell-8","label":"nb-cell-8","html_id":"nb-cell-8","key":"t75IgWX5q1"},{"type":"block","position":{"start":{"line":80,"column":0},"end":{"line":81,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":82,"column":0},"end":{"line":83,"column":0}},"children":[{"type":"text","value":"This function creates the P matrices that we need. The matrix just pick out the appropriate faces and are used later on to evaluate our full integral.","key":"Tw8WG41CRb"}],"key":"KkrA3vG2is"}],"data":{"id":"nb-cell-9","type":"notebook-content","iooxa":{"id":{"block":"NusqKvJ3MlKANE8pOB3b","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-9","label":"nb-cell-9","html_id":"nb-cell-9","key":"Vw3h7w2QZt"},{"type":"block","position":{"start":{"line":84,"column":0},"end":{"line":85,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"# face-x minus side and the face-y minus side\nP1 = mesh._getFacePxx()('fXm','fYm')\nprint( P1.todense() )","identifier":"nb-cell-10-code","enumerator":"4","html_id":"nb-cell-10-code","key":"IcwGmrjjkn"},{"type":"output","id":"kDWREEQo-Ym2bXoG5p150","data":[{"name":"stdout","output_type":"stream","text":"[[1. 0. 0. 0.]\n [0. 0. 1. 0.]]\n"}],"identifier":"nb-cell-10-output","html_id":"nb-cell-10-output","key":"DTHftiCKFS"}],"data":{"id":"nb-cell-10","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"QIfby0zQOGSFgWrebbFK","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"MMDATgoGoAnhFK9c4ZAA","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-10","label":"nb-cell-10","html_id":"nb-cell-10","key":"H7UBkcPgN0"},{"type":"block","position":{"start":{"line":96,"column":0},"end":{"line":97,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":98,"column":0},"end":{"line":99,"column":0}},"children":[{"type":"text","value":"We can create and plot all of the matrices that were in Figure 5:","key":"GS1oteqqt7"}],"key":"p0LotTON69"}],"data":{"id":"nb-cell-11","type":"notebook-content","iooxa":{"id":{"block":"fJFT2oA1PXeXict2NpfQ","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-11","label":"nb-cell-11","html_id":"nb-cell-11","key":"NPYn0G4Aeq"},{"type":"block","position":{"start":{"line":100,"column":0},"end":{"line":101,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"P1 = mesh._getFacePxx()('fXm','fYm')\nP2 = mesh._getFacePxx()('fXp','fYm')\nP3 = mesh._getFacePxx()('fXm','fYp')\nP4 = mesh._getFacePxx()('fXp','fYp')\nfig, ax = plt.subplots(1, 4, figsize=(15,3))\n\ndef plot_projection(ii, ax, P):\n    ax.spy(P, ms=30)\n    if P.shape[1]==4:\n        ax.set_xticks(range(4))\n        ax.set_xticklabels(('x-','x+','y-','y+'))\n    ax.set_xlabel('P{}'.format(ii+1))\n\nlist(map(plot_projection, range(4), ax, (P1, P2, P3, P4)));","identifier":"nb-cell-12-code","enumerator":"5","html_id":"nb-cell-12-code","key":"YdiWB0dxxH"},{"type":"output","id":"KlJScgIadY2rxmXZvkvkA","data":[{"output_type":"display_data","metadata":{"needs_background":"light"},"data":{"image/png":{"content_type":"image/png","hash":"cda99d74a4fb1a26c7c527043848c7a6","path":"/tle-finitevolume/build/cda99d74a4fb1a26c7c527043848c7a6.png"},"text/plain":{"content":"\u003cFigure size 1080x216 with 4 Axes\u003e","content_type":"text/plain"}}}],"identifier":"nb-cell-12-output","html_id":"nb-cell-12-output","key":"ANUfj6mQhi"}],"data":{"id":"nb-cell-12","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"40uVtzW0G0t3yHRCcaaM","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"lrPqqVEm6QxfabDcYLxT","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-12","label":"nb-cell-12","html_id":"nb-cell-12","key":"ul3zcLewn1"},{"type":"block","position":{"start":{"line":123,"column":0},"end":{"line":124,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":125,"column":0},"end":{"line":126,"column":0}},"children":[{"type":"text","value":"This assumes that we unwrapped our face vectors in certain way and they are ordered [xfaces, yfaces].","key":"XpiUY0vIcP"}],"key":"cDU0vPLLtZ"}],"data":{"id":"nb-cell-13","type":"notebook-content","iooxa":{"id":{"block":"zDZID1FHKMMBwSn6yAau","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-13","label":"nb-cell-13","html_id":"nb-cell-13","key":"ehDqwQ479x"},{"type":"block","position":{"start":{"line":127,"column":0},"end":{"line":128,"column":0}},"children":[{"type":"heading","depth":1,"position":{"start":{"line":129,"column":0},"end":{"line":130,"column":0}},"children":[{"type":"text","value":"All the cells!","key":"CPlsWHx85R"}],"identifier":"all-the-cells","label":"All the cells!","html_id":"all-the-cells","implicit":true,"key":"tqNLHPq2I1"},{"type":"paragraph","position":{"start":{"line":131,"column":0},"end":{"line":132,"column":0}},"children":[{"type":"text","value":"When we move to more cells the visualization of the matrix is not as clear, so instead we will show a connection from each cell center to the x and y faces that are selected by the P matrix.","key":"gLm5vFtF2t"}],"key":"vkkmiT4rrJ"}],"data":{"id":"nb-cell-14","type":"notebook-content","iooxa":{"id":{"block":"7ctcHVZ9rbkU8JOISFLu","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-14","label":"nb-cell-14","html_id":"nb-cell-14","key":"osVpNNZQgh"},{"type":"block","position":{"start":{"line":133,"column":0},"end":{"line":134,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"mesh = discretize.TensorMesh([3,4])","identifier":"nb-cell-15-code","enumerator":"6","html_id":"nb-cell-15-code","key":"JmQyc84qrX"},{"type":"output","id":"vqEhd8P2Ok_TYQvkzNvfi","data":[],"identifier":"nb-cell-15-output","html_id":"nb-cell-15-output","key":"YMCF3MJ73f"}],"data":{"id":"nb-cell-15","type":"notebook-code","collapsed":true,"iooxa":{"id":{"block":"WKYZQIAg0wA0So5pZDNO","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"jv4nylw4aMB6cLuAkltO","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":true}},"identifier":"nb-cell-15","label":"nb-cell-15","html_id":"nb-cell-15","key":"iYdGEJv4nX"},{"type":"block","position":{"start":{"line":143,"column":0},"end":{"line":144,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"P1 = mesh._getFacePxx()('fXm','fYm')\nP2 = mesh._getFacePxx()('fXp','fYm')\nP3 = mesh._getFacePxx()('fXm','fYp')\nP4 = mesh._getFacePxx()('fXp','fYp')\nfig, ax = plt.subplots(1,4, figsize=(15,6))\ndef plot_projection(ii, ax, P):\n    x = P * np.r_[mesh.gridFx[:,0], mesh.gridFy[:,0]]\n    y = P * np.r_[mesh.gridFx[:,1], mesh.gridFy[:,1]]\n    xx, xy = x[:mesh.nC], x[mesh.nC:]\n    yx, yy = y[:mesh.nC], y[mesh.nC:]\n    ax.plot(np.c_[xx, mesh.gridCC[:,0], xx*np.nan].flatten(), np.c_[yx, mesh.gridCC[:,1], yx*np.nan].flatten(), 'k-')\n    ax.plot(np.c_[xy, mesh.gridCC[:,0], xy*np.nan].flatten(), np.c_[yy, mesh.gridCC[:,1], yy*np.nan].flatten(), 'k-')\n    ax.plot(xx, yx, 'g\u003e')\n    ax.plot(xy, yy, 'g^')\n    mesh.plot_grid(ax=ax, centers=True)\n    ax.set_title('P{}'.format(ii+1))\nlist(map(plot_projection, range(4), ax.flatten(), (P1, P2, P3, P4)));\nplt.tight_layout()","identifier":"nb-cell-16-code","enumerator":"7","html_id":"nb-cell-16-code","key":"A05v5a58Fe"},{"type":"output","id":"-d3U_aPYxyWEsPBSKWBW9","data":[{"output_type":"display_data","metadata":{"needs_background":"light"},"data":{"image/png":{"content_type":"image/png","hash":"f9d667553af77d56ef12d88e1c9f2789","path":"/tle-finitevolume/build/f9d667553af77d56ef12d88e1c9f2789.png"},"text/plain":{"content":"\u003cFigure size 1080x432 with 4 Axes\u003e","content_type":"text/plain"}}}],"identifier":"nb-cell-16-output","html_id":"nb-cell-16-output","key":"KLqL2HI7WZ"}],"data":{"id":"nb-cell-16","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"EzFA7goTjbyc3oqloq7T","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"vGpoFc2QY9a8Gtz668VL","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-16","label":"nb-cell-16","html_id":"nb-cell-16","key":"PX5eCJytyP"},{"type":"block","position":{"start":{"line":170,"column":0},"end":{"line":171,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":172,"column":0},"end":{"line":173,"column":0}},"children":[{"type":"text","value":"Each cell (the center is the red dot) has two faces that it uses, one x component and one y component.","key":"du57ndarNZ"}],"key":"Xpa5QNA5vB"}],"data":{"id":"nb-cell-17","type":"notebook-content","iooxa":{"id":{"block":"KPtsBYb1war7X3xTvF4V","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-17","label":"nb-cell-17","html_id":"nb-cell-17","key":"XkSLx12557"},{"type":"block","position":{"start":{"line":174,"column":0},"end":{"line":175,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":176,"column":0},"end":{"line":177,"column":0}},"children":[{"type":"text","value":"The four ","key":"XsZ0m92bMG"},{"type":"inlineMath","value":"P","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eP\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eP\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eP\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"CNTURyhAjX"},{"type":"text","value":" matrices are assembled and summed in the ","key":"J4pd4p2vWJ"},{"type":"strong","children":[{"type":"text","value":"getFaceInnerProduct","key":"zYSvwzAkhU"}],"key":"GYOfWqAtb7"},{"type":"text","value":" code using this formula:","key":"LDlf4Bmjlh"}],"key":"qGRVJ5iIo4"},{"type":"math","value":"\\mathbf{M}_f(\\sigma) = \\frac{1}{4}\\sum_{i=1}^{4} \\mathbf{P}_i^\\top \\sqrt{v} \\boldsymbol{\\Sigma}^{-1} \\sqrt{v} \\mathbf{P}_i","position":{"start":{"line":179,"column":0},"end":{"line":182,"column":0}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi mathvariant=\"bold\"\u003eM\u003c/mi\u003e\u003cmi\u003ef\u003c/mi\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003eσ\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmfrac\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmn\u003e4\u003c/mn\u003e\u003c/mfrac\u003e\u003cmunderover\u003e\u003cmo\u003e∑\u003c/mo\u003e\u003cmrow\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003cmn\u003e4\u003c/mn\u003e\u003c/munderover\u003e\u003cmsubsup\u003e\u003cmi mathvariant=\"bold\"\u003eP\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmi mathvariant=\"normal\"\u003e⊤\u003c/mi\u003e\u003c/msubsup\u003e\u003cmsqrt\u003e\u003cmi\u003ev\u003c/mi\u003e\u003c/msqrt\u003e\u003cmsup\u003e\u003cmi mathvariant=\"bold\"\u003eΣ\u003c/mi\u003e\u003cmrow\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003c/msup\u003e\u003cmsqrt\u003e\u003cmi\u003ev\u003c/mi\u003e\u003c/msqrt\u003e\u003cmsub\u003e\u003cmi mathvariant=\"bold\"\u003eP\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{M}_f(\\sigma) = \\frac{1}{4}\\sum_{i=1}^{4} \\mathbf{P}_i^\\top \\sqrt{v} \\boldsymbol{\\Sigma}^{-1} \\sqrt{v} \\mathbf{P}_i\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eM\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eσ\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:3.0788em;vertical-align:-1.2777em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3214em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e4\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mop op-limits\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.8011em;\"\u003e\u003cspan style=\"top:-1.8723em;margin-left:0em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.05em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003cspan class=\"mrel mtight\"\u003e=\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.05em;\"\u003e\u003c/span\u003e\u003cspan\u003e\u003cspan class=\"mop op-symbol large-op\"\u003e∑\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-4.3em;margin-left:0em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.05em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e4\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.2777em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eP\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8991em;\"\u003e\u003cspan style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.113em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e⊤\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.247em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord sqrt\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8492em;\"\u003e\u003cspan class=\"svg-align\" style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\" style=\"padding-left:0.833em;\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ev\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-2.8092em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'\u003e\u003cpath d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1908em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eΣ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8901em;\"\u003e\u003cspan style=\"top:-3.139em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e−\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord sqrt\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8492em;\"\u003e\u003cspan class=\"svg-align\" style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\" style=\"padding-left:0.833em;\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ev\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-2.8092em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'\u003e\u003cpath d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1908em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eP\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"2","key":"DDcd9DG10u"},{"type":"paragraph","position":{"start":{"line":183,"column":0},"end":{"line":184,"column":0}},"children":[{"type":"text","value":"This function takes a sigma variable which can have any sort of anisotropy:","key":"PFerFIx0Lr"}],"key":"NPEQGQ1hFe"},{"type":"math","value":"\\begin{align}\\begin{aligned}\\begin{split}\\vec{\\mu} = \\left[\\begin{matrix} \\mu_{1} \u0026 0 \\\\ 0 \u0026 \\mu_{1} \\end{matrix}\\right]\\end{split}\\\\\\begin{split}\\vec{\\mu} = \\left[\\begin{matrix} \\mu_{1} \u0026 0 \\\\ 0 \u0026 \\mu_{2} \\end{matrix}\\right]\\end{split}\\\\\\begin{split}\\vec{\\mu} = \\left[\\begin{matrix} \\mu_{1} \u0026 \\mu_{3} \\\\ \\mu_{3} \u0026 \\mu_{2} \\end{matrix}\\right]\\end{split}\\end{aligned}\\end{align}","position":{"start":{"line":185,"column":0},"end":{"line":188,"column":0}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmtable rowspacing=\"0.25em\" columnalign=\"right\" columnspacing=\"\"\u003e\u003cmtr\u003e\u003cmtd class =\"mtr-glue\"\u003e\u003c/mtd\u003e\u003cmtd\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmtable rowspacing=\"0.25em\" columnalign=\"right\" columnspacing=\"\"\u003e\u003cmtr\u003e\u003cmtd\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmtable rowspacing=\"0.25em\" columnalign=\"right\" columnspacing=\"\"\u003e\u003cmtr\u003e\u003cmtd\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmrow\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003eμ\u003c/mi\u003e\u003cmo\u003e⃗\u003c/mo\u003e\u003c/mover\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmrow\u003e\u003cmo fence=\"true\"\u003e[\u003c/mo\u003e\u003cmtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"\u003e\u003cmtr\u003e\u003cmtd\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"false\"\u003e\u003cmsub\u003e\u003cmi\u003eμ\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003c/mstyle\u003e\u003c/mtd\u003e\u003cmtd\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"false\"\u003e\u003cmn\u003e0\u003c/mn\u003e\u003c/mstyle\u003e\u003c/mtd\u003e\u003c/mtr\u003e\u003cmtr\u003e\u003cmtd\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"false\"\u003e\u003cmn\u003e0\u003c/mn\u003e\u003c/mstyle\u003e\u003c/mtd\u003e\u003cmtd\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"false\"\u003e\u003cmsub\u003e\u003cmi\u003eμ\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003c/mstyle\u003e\u003c/mtd\u003e\u003c/mtr\u003e\u003c/mtable\u003e\u003cmo fence=\"true\"\u003e]\u003c/mo\u003e\u003c/mrow\u003e\u003c/mrow\u003e\u003c/mstyle\u003e\u003c/mtd\u003e\u003c/mtr\u003e\u003c/mtable\u003e\u003c/mstyle\u003e\u003c/mtd\u003e\u003c/mtr\u003e\u003cmtr\u003e\u003cmtd\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmtable rowspacing=\"0.25em\" columnalign=\"right\" columnspacing=\"\"\u003e\u003cmtr\u003e\u003cmtd\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmrow\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003eμ\u003c/mi\u003e\u003cmo\u003e⃗\u003c/mo\u003e\u003c/mover\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmrow\u003e\u003cmo fence=\"true\"\u003e[\u003c/mo\u003e\u003cmtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"\u003e\u003cmtr\u003e\u003cmtd\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"false\"\u003e\u003cmsub\u003e\u003cmi\u003eμ\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003c/mstyle\u003e\u003c/mtd\u003e\u003cmtd\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"false\"\u003e\u003cmn\u003e0\u003c/mn\u003e\u003c/mstyle\u003e\u003c/mtd\u003e\u003c/mtr\u003e\u003cmtr\u003e\u003cmtd\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"false\"\u003e\u003cmn\u003e0\u003c/mn\u003e\u003c/mstyle\u003e\u003c/mtd\u003e\u003cmtd\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"false\"\u003e\u003cmsub\u003e\u003cmi\u003eμ\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msub\u003e\u003c/mstyle\u003e\u003c/mtd\u003e\u003c/mtr\u003e\u003c/mtable\u003e\u003cmo fence=\"true\"\u003e]\u003c/mo\u003e\u003c/mrow\u003e\u003c/mrow\u003e\u003c/mstyle\u003e\u003c/mtd\u003e\u003c/mtr\u003e\u003c/mtable\u003e\u003c/mstyle\u003e\u003c/mtd\u003e\u003c/mtr\u003e\u003cmtr\u003e\u003cmtd\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmtable rowspacing=\"0.25em\" columnalign=\"right\" columnspacing=\"\"\u003e\u003cmtr\u003e\u003cmtd\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"true\"\u003e\u003cmrow\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003eμ\u003c/mi\u003e\u003cmo\u003e⃗\u003c/mo\u003e\u003c/mover\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmrow\u003e\u003cmo fence=\"true\"\u003e[\u003c/mo\u003e\u003cmtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"\u003e\u003cmtr\u003e\u003cmtd\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"false\"\u003e\u003cmsub\u003e\u003cmi\u003eμ\u003c/mi\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msub\u003e\u003c/mstyle\u003e\u003c/mtd\u003e\u003cmtd\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"false\"\u003e\u003cmsub\u003e\u003cmi\u003eμ\u003c/mi\u003e\u003cmn\u003e3\u003c/mn\u003e\u003c/msub\u003e\u003c/mstyle\u003e\u003c/mtd\u003e\u003c/mtr\u003e\u003cmtr\u003e\u003cmtd\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"false\"\u003e\u003cmsub\u003e\u003cmi\u003eμ\u003c/mi\u003e\u003cmn\u003e3\u003c/mn\u003e\u003c/msub\u003e\u003c/mstyle\u003e\u003c/mtd\u003e\u003cmtd\u003e\u003cmstyle scriptlevel=\"0\" displaystyle=\"false\"\u003e\u003cmsub\u003e\u003cmi\u003eμ\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msub\u003e\u003c/mstyle\u003e\u003c/mtd\u003e\u003c/mtr\u003e\u003c/mtable\u003e\u003cmo fence=\"true\"\u003e]\u003c/mo\u003e\u003c/mrow\u003e\u003c/mrow\u003e\u003c/mstyle\u003e\u003c/mtd\u003e\u003c/mtr\u003e\u003c/mtable\u003e\u003c/mstyle\u003e\u003c/mtd\u003e\u003c/mtr\u003e\u003c/mtable\u003e\u003c/mstyle\u003e\u003c/mtd\u003e\u003cmtd class =\"mtr-glue\"\u003e\u003c/mtd\u003e\u003cmtd class =\"mml-eqn-num\"\u003e\u003c/mtd\u003e\u003c/mtr\u003e\u003c/mtable\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\begin{align}\\begin{aligned}\\begin{split}\\vec{\\mu} = \\left[\\begin{matrix} \\mu_{1} \u0026amp; 0 \\\\ 0 \u0026amp; \\mu_{1} \\end{matrix}\\right]\\end{split}\\\\\\begin{split}\\vec{\\mu} = \\left[\\begin{matrix} \\mu_{1} \u0026amp; 0 \\\\ 0 \u0026amp; \\mu_{2} \\end{matrix}\\right]\\end{split}\\\\\\begin{split}\\vec{\\mu} = \\left[\\begin{matrix} \\mu_{1} \u0026amp; \\mu_{3} \\\\ \\mu_{3} \u0026amp; \\mu_{2} \\end{matrix}\\right]\\end{split}\\end{aligned}\\end{align}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:9.3001em;vertical-align:-4.4em;\"\u003e\u003c/span\u003e\u003cspan class=\"mtable\"\u003e\u003cspan class=\"col-align-r\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:4.9em;\"\u003e\u003cspan style=\"top:-6.9em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:6.75em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mtable\"\u003e\u003cspan class=\"col-align-r\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:4.75em;\"\u003e\u003cspan style=\"top:-6.75em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.6em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mtable\"\u003e\u003cspan class=\"col-align-r\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.6em;\"\u003e\u003cspan style=\"top:-3.6em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.45em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.714em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eμ\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.2077em;\"\u003e\u003cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'\u003e\u003cpath d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1944em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"minner\"\u003e\u003cspan class=\"mopen delimcenter\" style=\"top:0em;\"\u003e\u003cspan class=\"delimsizing size3\"\u003e[\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mtable\"\u003e\u003cspan class=\"col-align-c\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.45em;\"\u003e\u003cspan style=\"top:-3.61em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eμ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-2.41em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.95em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"arraycolsep\" style=\"width:0.5em;\"\u003e\u003c/span\u003e\u003cspan class=\"arraycolsep\" style=\"width:0.5em;\"\u003e\u003c/span\u003e\u003cspan class=\"col-align-c\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.45em;\"\u003e\u003cspan style=\"top:-3.61em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-2.41em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eμ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.95em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose delimcenter\" style=\"top:0em;\"\u003e\u003cspan class=\"delimsizing size3\"\u003e]\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.1em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.75em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.6em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mtable\"\u003e\u003cspan class=\"col-align-r\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.6em;\"\u003e\u003cspan style=\"top:-3.6em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.45em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.714em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eμ\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.2077em;\"\u003e\u003cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'\u003e\u003cpath d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1944em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"minner\"\u003e\u003cspan class=\"mopen delimcenter\" style=\"top:0em;\"\u003e\u003cspan class=\"delimsizing size3\"\u003e[\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mtable\"\u003e\u003cspan class=\"col-align-c\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.45em;\"\u003e\u003cspan style=\"top:-3.61em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eμ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-2.41em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.95em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"arraycolsep\" style=\"width:0.5em;\"\u003e\u003c/span\u003e\u003cspan class=\"arraycolsep\" style=\"width:0.5em;\"\u003e\u003c/span\u003e\u003cspan class=\"col-align-c\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.45em;\"\u003e\u003cspan style=\"top:-3.61em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e0\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-2.41em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eμ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.95em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose delimcenter\" style=\"top:0em;\"\u003e\u003cspan class=\"delimsizing size3\"\u003e]\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.1em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-0.75em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.6em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mtable\"\u003e\u003cspan class=\"col-align-r\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.6em;\"\u003e\u003cspan style=\"top:-3.6em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.45em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.714em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eμ\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.2077em;\"\u003e\u003cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'\u003e\u003cpath d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1944em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"minner\"\u003e\u003cspan class=\"mopen delimcenter\" style=\"top:0em;\"\u003e\u003cspan class=\"delimsizing size3\"\u003e[\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mtable\"\u003e\u003cspan class=\"col-align-c\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.45em;\"\u003e\u003cspan style=\"top:-3.61em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eμ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-2.41em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eμ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e3\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.95em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"arraycolsep\" style=\"width:0.5em;\"\u003e\u003c/span\u003e\u003cspan class=\"arraycolsep\" style=\"width:0.5em;\"\u003e\u003c/span\u003e\u003cspan class=\"col-align-c\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.45em;\"\u003e\u003cspan style=\"top:-3.61em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eμ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e3\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-2.41em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eμ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3011em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.95em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose delimcenter\" style=\"top:0em;\"\u003e\u003cspan class=\"delimsizing size3\"\u003e]\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.1em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:4.25em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:4.4em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"tag\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:4.9em;\"\u003e\u003cspan style=\"top:-6.9em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:6.75em;\"\u003e\u003c/span\u003e\u003cspan class=\"eqn-num\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:4.4em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"3","key":"lYOdJjkAzG"},{"type":"paragraph","position":{"start":{"line":189,"column":0},"end":{"line":190,"column":0}},"children":[{"type":"text","value":"The matrices that are produced by this function can be seen below!","key":"bAjm9l8zxb"}],"key":"IKSU1zTotH"}],"data":{"id":"nb-cell-18","type":"notebook-content","iooxa":{"id":{"block":"82G9e2DAu4MWgeggqw79","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-18","label":"nb-cell-18","html_id":"nb-cell-18","key":"emaShin0Kz"},{"type":"block","position":{"start":{"line":191,"column":0},"end":{"line":192,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"isotropic       = np.ones(mesh.nC)*4\nanisotropic_vec = np.r_[np.ones(mesh.nC)*4, np.ones(mesh.nC)]\nanisotropic     = np.r_[np.ones(mesh.nC)*4, np.ones(mesh.nC), np.ones(mesh.nC)*3]\nMf_sig_i = mesh.get_face_inner_product(isotropic)\nMf_sig_v = mesh.get_face_inner_product(anisotropic_vec)\nMf_sig_a = mesh.get_face_inner_product(anisotropic)\nclim = (\n    np.min(map(np.min, (Mf_sig_i.data, Mf_sig_v.data, Mf_sig_a.data))),\n    np.max(map(np.max, (Mf_sig_i.data, Mf_sig_v.data, Mf_sig_a.data)))\n)\nfig, ax = plt.subplots(1,3, figsize=(15,4))\ndef plot_spy(ax, Mf, title):\n    dense = Mf.toarray()\n    dense[dense == 0] = np.nan\n    ms = ax.matshow(dense)#, clim=clim)\n    plt.colorbar(ms, ax=ax)\n    ax.set_xlabel(title)\nlist(map(plot_spy, ax, (Mf_sig_i, Mf_sig_v, Mf_sig_a), ('Isotropic', 'Coordinate Anisotropy', 'Full Anisotropy')));","identifier":"nb-cell-19-code","enumerator":"8","html_id":"nb-cell-19-code","key":"KKsfK0HB4E"},{"type":"output","id":"UQ9v2QF9nfk6R2XblHi6I","data":[{"output_type":"display_data","metadata":{"needs_background":"light"},"data":{"image/png":{"content_type":"image/png","hash":"cc5726bda26e4959b42294f2cbf7efff","path":"/tle-finitevolume/build/cc5726bda26e4959b42294f2cbf7efff.png"},"text/plain":{"content":"\u003cFigure size 1080x288 with 6 Axes\u003e","content_type":"text/plain"}}}],"identifier":"nb-cell-19-output","html_id":"nb-cell-19-output","key":"nEkVYedjSD"}],"data":{"id":"nb-cell-19","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"oG3qra6QUeqwyfIQunfa","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"GzIgLkR3zaDoWst5C0gy","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-19","label":"nb-cell-19","html_id":"nb-cell-19","key":"Z4N379t6ez"},{"type":"block","position":{"start":{"line":218,"column":0},"end":{"line":219,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":220,"column":0},"end":{"line":221,"column":0}},"children":[{"type":"text","value":"In the last figure you can see that there is coupling between the cells in x and y due to the non-coordinate aligned anisotropy. This will make the matrix system harder to solve when we try to invert it!","key":"ON4PnlXhcH"}],"key":"t7LdJRSqk9"}],"data":{"id":"nb-cell-20","type":"notebook-content","iooxa":{"id":{"block":"gg0HpwxiBxFmCKJlLfvp","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-20","label":"nb-cell-20","html_id":"nb-cell-20","key":"EI47gztA7A"},{"type":"block","position":{"start":{"line":222,"column":0},"end":{"line":223,"column":0}},"children":[{"type":"heading","depth":1,"position":{"start":{"line":224,"column":0},"end":{"line":225,"column":0}},"children":[{"type":"text","value":"Ok, but does it work?","key":"bHDCszG0bP"}],"identifier":"ok-but-does-it-work","label":"Ok, but does it work?","html_id":"ok-but-does-it-work","implicit":true,"key":"a7dFXMf2QR"},{"type":"paragraph","position":{"start":{"line":226,"column":0},"end":{"line":227,"column":0}},"children":[{"type":"text","value":"Unfortunately the testing of the innerproducts is not that visual. We need to make sure that the integral of some made up function evaluates to the correct value.","key":"y3GwPftd90"}],"key":"lMIx5QNm83"},{"type":"paragraph","position":{"start":{"line":228,"column":0},"end":{"line":229,"column":0}},"children":[{"type":"text","value":"So to make something up, and integrate it, we will use ","key":"uwXUo3m7xW"},{"type":"strong","children":[{"type":"text","value":"sympy","key":"kJ2EVhOV0K"}],"key":"JO4UvSPCB6"},{"type":"text","value":"!","key":"VK8KtkZTii"}],"key":"Ml8mnePqRA"},{"type":"paragraph","position":{"start":{"line":230,"column":0},"end":{"line":235,"column":0}},"children":[{"type":"text","value":"We will evaluate the integral:\n","key":"vN649ujIzU"}],"key":"VhLsWlARmP"},{"type":"math","value":"\n\\int_0^1 \\int_0^1 \\sigma(x,y) \\vec{j}(x,y) \\cdot \\vec{j}(x,y) \\quad dx dy","html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsubsup\u003e\u003cmo\u003e∫\u003c/mo\u003e\u003cmn\u003e0\u003c/mn\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msubsup\u003e\u003cmsubsup\u003e\u003cmo\u003e∫\u003c/mo\u003e\u003cmn\u003e0\u003c/mn\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/msubsup\u003e\u003cmi\u003eσ\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmi\u003ey\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmo\u003e⃗\u003c/mo\u003e\u003c/mover\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmi\u003ey\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e⋅\u003c/mo\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmo\u003e⃗\u003c/mo\u003e\u003c/mover\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmi\u003ey\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmspace width=\"1em\"/\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\n\\int_0^1 \\int_0^1 \\sigma(x,y) \\vec{j}(x,y) \\cdot \\vec{j}(x,y) \\quad dx dy\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.476em;vertical-align:-0.9119em;\"\u003e\u003c/span\u003e\u003cspan class=\"mop\"\u003e\u003cspan class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\"\u003e∫\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.564em;\"\u003e\u003cspan style=\"top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e0\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.8129em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9119em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mop\"\u003e\u003cspan class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\"\u003e∫\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.564em;\"\u003e\u003cspan style=\"top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e0\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.8129em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9119em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eσ\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9425em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.2285em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.2355em;\"\u003e\u003cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'\u003e\u003cpath d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1944em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⋅\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.1925em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9425em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.2285em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.2355em;\"\u003e\u003cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'\u003e\u003cpath d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1944em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:1em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"4","key":"F0VugzJNzh"},{"type":"paragraph","position":{"start":{"line":230,"column":0},"end":{"line":235,"column":0}},"children":[{"type":"text","value":"\nby making up some ridiculous functions.","key":"z8R7UmJkI7"}],"key":"wsZouBHdL3"}],"data":{"id":"nb-cell-21","type":"notebook-content","iooxa":{"id":{"block":"mGY80A0iX7A0gH1lrGiQ","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-21","label":"nb-cell-21","html_id":"nb-cell-21","key":"oHSRsG2as2"},{"type":"block","position":{"start":{"line":236,"column":0},"end":{"line":237,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"import sympy\nfrom sympy.abc import x, y\n\n# Here we will make up some j vectors that vary in space\nj = sympy.Matrix([\n    x**2+y*5,\n    (5**2)*x+y*5\n])\n\n# Create an isotropic sigma vector\nSig = sympy.Matrix([\n    [x*y*432/1163,      0      ],\n    [     0      , x*y*432/1163]\n])\n\n# Do the inner product!\njTSj = j.T*Sig*j\nans  = sympy.integrate(sympy.integrate(jTSj, (x,0,1)), (y,0,1))[0] # The `[0]` is to make it an int.\n\nprint( \"It is trivial to see that the answer is {}.\".format(ans) )","identifier":"nb-cell-22-code","enumerator":"9","html_id":"nb-cell-22-code","key":"iFRZnJ4AP3"},{"type":"output","id":"2uUM7eCYVVuOxplzWqzyE","data":[{"name":"stdout","output_type":"stream","text":"It is trivial to see that the answer is 42.\n"}],"identifier":"nb-cell-22-output","html_id":"nb-cell-22-output","key":"o493DRrZe9"}],"data":{"id":"nb-cell-22","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"YHg7nx2e6BHty5xLHFmK","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"p5vGrxND1WnUpjXOfnL4","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-22","label":"nb-cell-22","html_id":"nb-cell-22","key":"QT4XmV61wg"},{"type":"block","position":{"start":{"line":265,"column":0},"end":{"line":266,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":267,"column":0},"end":{"line":268,"column":0}},"children":[{"type":"text","value":"Wonderful. Everything seems right in the world with that answer. Next step is to sub in the locations of the grid on both the faces in x and y as well as the cell centers.","key":"gCmLRPogrm"}],"key":"RUvCFAnTEq"}],"data":{"id":"nb-cell-23","type":"notebook-content","iooxa":{"id":{"block":"Q4LY68w68gHywJXJgboO","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-23","label":"nb-cell-23","html_id":"nb-cell-23","key":"qrGbkvngcs"},{"type":"block","position":{"start":{"line":269,"column":0},"end":{"line":270,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"def get_vectors(mesh):\n    \"\"\"Gets the vectors sig and [jx, jy] from sympy.\"\"\"\n    f_jx  = sympy.lambdify((x,y), j[0], 'numpy')\n    f_jy  = sympy.lambdify((x,y), j[1], 'numpy')\n    f_sig = sympy.lambdify((x,y), Sig[0], 'numpy')\n    jx  = f_jx(mesh.gridFx[:,0], mesh.gridFx[:,1])\n    jy  = f_jy(mesh.gridFy[:,0], mesh.gridFy[:,1])\n    sig = f_sig(mesh.gridCC[:,0], mesh.gridCC[:,1])\n    return sig, np.r_[jx, jy]","identifier":"nb-cell-24-code","enumerator":"10","html_id":"nb-cell-24-code","key":"lGNK5D87mN"},{"type":"output","id":"iUzXauYJHsaglu1JyR2Jn","data":[],"identifier":"nb-cell-24-output","html_id":"nb-cell-24-output","key":"el18snc0Mn"}],"data":{"id":"nb-cell-24","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"Wtyf5RJU5fa9fGZZ5yol","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"7Gzd8hQdpwr6jqp2FQFU","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-24","label":"nb-cell-24","html_id":"nb-cell-24","key":"exK1fs9M2d"},{"type":"block","position":{"start":{"line":287,"column":0},"end":{"line":288,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":289,"column":0},"end":{"line":290,"column":0}},"children":[{"type":"text","value":"Using these vectors (","key":"msDaSCDf6j"},{"type":"inlineMath","value":"\\sigma","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eσ\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\sigma\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eσ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Ekz01RxdH5"},{"type":"text","value":" and ","key":"PlzHVo52t8"},{"type":"inlineMath","value":"\\mathbf{j}","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{j}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"fen7DNKmmh"},{"type":"text","value":") we can evaluate the result on our mesh","key":"PBUWMbUR2x"}],"key":"bAOcXq31zV"}],"data":{"id":"nb-cell-25","type":"notebook-content","iooxa":{"id":{"block":"PcA8DQgBBhOOq3iMGuCl","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-25","label":"nb-cell-25","html_id":"nb-cell-25","key":"bHIMh81b0Z"},{"type":"block","position":{"start":{"line":291,"column":0},"end":{"line":292,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"n = 5 # get's better if you add cells!\nmesh = discretize.TensorMesh([n,n])\nsig, jv = get_vectors(mesh)\nMsig = mesh.get_face_inner_product(sig)\nnumeric_ans = jv.T.dot(Msig.dot(jv))\nprint( \"Numerically we get {}.\".format(numeric_ans) )","identifier":"nb-cell-26-code","enumerator":"11","html_id":"nb-cell-26-code","key":"eXTtMA5m7V"},{"type":"output","id":"9cTpC0aVKWLG0aTQ8587q","data":[{"name":"stdout","output_type":"stream","text":"Numerically we get 41.18917558039555.\n"}],"identifier":"nb-cell-26-output","html_id":"nb-cell-26-output","key":"XBocCgQoUX"}],"data":{"id":"nb-cell-26","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"qddmFAn8izDKO9ynQWyi","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"N5fL7R5F7ohI7NYHfTpZ","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-26","label":"nb-cell-26","html_id":"nb-cell-26","key":"c9MeUITNRd"},{"type":"block","position":{"start":{"line":306,"column":0},"end":{"line":307,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":308,"column":0},"end":{"line":309,"column":0}},"children":[{"type":"text","value":"That is pretty close, but to be rigorous we should look at the order of the convergence which should be ","key":"YZIzR00R9R"},{"type":"inlineMath","value":"\\mathcal{O}(h^2)","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"script\"\u003eO\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsup\u003e\u003cmi\u003eh\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathcal{O}(h^2)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathcal\" style=\"margin-right:0.02778em;\"\u003eO\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eh\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"kZC93onWhm"},{"type":"text","value":".","key":"U3Qn2DasrY"}],"key":"mgoolrom7d"},{"type":"paragraph","position":{"start":{"line":310,"column":0},"end":{"line":315,"column":0}},"children":[{"type":"text","value":"SimPEG has a number of testing functions for\n","key":"AaQly5ue4r"},{"type":"link","url":"http://docs.simpeg.xyz/content/api_core/api_Tests.html#SimPEG.Tests.checkDerivative","children":[{"type":"text","value":"derivatives","key":"pKUwcgRzt1"}],"urlSource":"http://docs.simpeg.xyz/content/api_core/api_Tests.html#SimPEG.Tests.checkDerivative","key":"bRvFlo3Qm4"},{"type":"text","value":"\nand\n","key":"WH5j68EstR"},{"type":"link","url":"http://docs.simpeg.xyz/content/api_core/api_Tests.html#SimPEG.Tests.OrderTest","children":[{"type":"text","value":"order of convergence","key":"DvK917zavv"}],"urlSource":"http://docs.simpeg.xyz/content/api_core/api_Tests.html#SimPEG.Tests.OrderTest","key":"e6A4fn8RNu"},{"type":"text","value":"\nthat make this pretty simple!","key":"nGMcITK5VQ"}],"key":"yX4BeCSNrL"}],"data":{"id":"nb-cell-27","type":"notebook-content","iooxa":{"id":{"block":"Wmu04ObkA2uUXBGHYg32","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-27","label":"nb-cell-27","html_id":"nb-cell-27","key":"z8O3HFj0xi"},{"type":"block","position":{"start":{"line":316,"column":0},"end":{"line":317,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"import sys\nimport unittest\nfrom discretize.tests import OrderTest\n\nclass Testify(OrderTest):\n    meshDimension = 2\n    def getError(self):\n        sig, jv = get_vectors(self.M)\n        Msig = self.M.get_face_inner_product(sig)\n        return float(ans) - jv.T.dot(Msig.dot(jv))\n    def test_order(self):\n        self.orderTest()\n\n# This just runs the unittest:\nsuite = unittest.TestLoader().loadTestsFromTestCase( Testify )\nunittest.TextTestRunner().run( suite );","identifier":"nb-cell-28-code","enumerator":"12","html_id":"nb-cell-28-code","key":"TrMypbifAT"},{"type":"output","id":"6gPG9_Da1YO85sLJH-2j4","data":[{"name":"stderr","output_type":"stream","text":"/opt/anaconda3/envs/simpeg/lib/python3.8/site-packages/discretize/utils/code_utils.py:247: FutureWarning: setupMesh has been deprecated, please use setup_mesh. It will be removed in version 1.0.0 of discretize.\n  warnings.warn(\n."},{"name":"stdout","output_type":"stream","text":"\nuniformTensorMesh:  Order Test\n_____________________________________________\n   h  |    error    | e(i-1)/e(i) |  order\n~~~~~~|~~~~~~~~~~~~~|~~~~~~~~~~~~~|~~~~~~~~~~\n   4  |  1.27e+00   |\n   8  |  3.17e-01   |   3.9942    |  1.9979\n  16  |  7.93e-02   |   3.9985    |  1.9995\n  32  |  1.98e-02   |   3.9996    |  1.9999\n---------------------------------------------\nHappy little convergence test!\n\n"},{"name":"stderr","output_type":"stream","text":"\n----------------------------------------------------------------------\nRan 1 test in 0.090s\n\nOK\n"}],"identifier":"nb-cell-28-output","html_id":"nb-cell-28-output","key":"oD9uC3bmpQ"}],"data":{"id":"nb-cell-28","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"oCa9boN1s3XlZa9SvmdU","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"tGj342IRsaYHRvrqwYBJ","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-28","label":"nb-cell-28","html_id":"nb-cell-28","key":"mslXhiWQ6J"},{"type":"block","position":{"start":{"line":341,"column":0},"end":{"line":342,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":343,"column":0},"end":{"line":344,"column":0}},"children":[{"type":"text","value":"These basic operations on the mesh for inner products and differential operators are core pieces of SimPEG, and they need to be tested continuously to ensure that no one has broken them!","key":"krViN4N17s"}],"key":"OGLWhQrbtx"},{"type":"paragraph","position":{"start":{"line":345,"column":0},"end":{"line":346,"column":0}},"children":[{"type":"text","value":"On every single change to the SimPEG codebase many hours of testing are completed!","key":"cJyXYTzbEJ"}],"key":"Sxp5RLL8oX"}],"data":{"id":"nb-cell-29","type":"notebook-content","iooxa":{"id":{"block":"aTIbN9BFtHIPWlwGCeG6","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-29","label":"nb-cell-29","html_id":"nb-cell-29","key":"ESMDEfDT00"},{"type":"block","position":{"start":{"line":347,"column":0},"end":{"line":348,"column":0}},"children":[{"type":"heading","depth":1,"position":{"start":{"line":349,"column":0},"end":{"line":350,"column":0}},"children":[{"type":"text","value":"Next up ...","key":"hzyWe8m4Ky"}],"identifier":"next-up","label":"Next up ...","html_id":"next-up","implicit":true,"key":"Jqzpz1ylHT"},{"type":"paragraph","position":{"start":{"line":351,"column":0},"end":{"line":352,"column":0}},"children":[{"type":"text","value":"In the ","key":"Wbh5GG8IRP"},{"type":"link","url":"/all-together-now","children":[{"type":"text","value":"next notebook","key":"YAFgadR7TP"}],"urlSource":"all-together-now.ipynb","internal":true,"dataUrl":"/all-together-now.json","protocol":"file","key":"id6f1MSPp4"},{"type":"text","value":" we will use our knowledge of the ","key":"NRcGD96XVA"},{"type":"link","url":"/mesh","children":[{"type":"text","value":"mesh","key":"Se5sXhHuHo"}],"urlSource":"mesh.ipynb","internal":true,"dataUrl":"/mesh.json","protocol":"file","key":"mwuYFZkEee"},{"type":"text","value":" and the ","key":"DH5PDQM6m4"},{"type":"link","url":"/divergence","children":[{"type":"text","value":"divergence","key":"ZbR0NgHWki"}],"urlSource":"divergence.ipynb","internal":true,"dataUrl":"/divergence.json","protocol":"file","key":"UbWUdz1RHK"},{"type":"text","value":" implementations to bring the DC resistivity equations together and show some pretty figures!","key":"KeHlGLS6vf"}],"key":"QpdeIvPHC0"}],"data":{"id":"nb-cell-30","type":"notebook-content","iooxa":{"id":{"block":"XnthZqZ9T4KoIpVw1HqS","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-30","label":"nb-cell-30","html_id":"nb-cell-30","key":"yYPmghGnpR"}],"key":"eUmKUWOmoe"},"references":{"cite":{"order":[],"data":{}}},"footer":{},"domain":"http://localhost:3000"}},"actionData":null,"errors":null},"future":{"unstable_cssModules":false,"unstable_cssSideEffectImports":false,"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"unstable_vanillaExtract":false,"v2_errorBoundary":false,"v2_meta":false,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/tle-finitevolume/build/manifest-2E91AB14.js";
import * as route0 from "/tle-finitevolume/build/root-3VTM3HH5.js";
import * as route1 from "/tle-finitevolume/build/routes/$-OY73AADE.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/tle-finitevolume/build/entry.client-34LOLN62.js");</script></body></html>