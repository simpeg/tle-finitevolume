<!DOCTYPE html><html lang="en" class="light scroll-p-20"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Pixels and Their Neighbours - Pixels and Their Neighbours: Finite Volume</title><meta name="image" content="/tle-finitevolume/build/dc-setup-613da4e1507fa3e37aae2ebfe06df13a.png"/><meta property="og:title" content="Pixels and Their Neighbours - Pixels and Their Neighbours: Finite Volume"/><meta property="og:image" content="/tle-finitevolume/build/dc-setup-613da4e1507fa3e37aae2ebfe06df13a.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Pixels and Their Neighbours - Pixels and Their Neighbours: Finite Volume"/><meta name="twitter:image" content="/tle-finitevolume/build/dc-setup-613da4e1507fa3e37aae2ebfe06df13a.png"/><meta name="twitter:alt" content="Pixels and Their Neighbours - Pixels and Their Neighbours: Finite Volume"/><link rel="stylesheet" href="/tle-finitevolume/build/_assets/app-ADU2AYLI.css"/><link rel="stylesheet" href="/tle-finitevolume/build/_assets/thebe-core-BKMFZL7Z.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 fixed w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-wrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="h-8 w-8 p-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 013.75 6h16.5a.75.75 0 010 1.5H3.75A.75.75 0 013 6.75zM3 12a.75.75 0 01.75-.75h16.5a.75.75 0 010 1.5H3.75A.75.75 0 013 12zm0 5.25a.75.75 0 01.75-.75h16.5a.75.75 0 010 1.5H3.75a.75.75 0 01-.75-.75z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center dark:text-white w-fit ml-3 md:ml-5 xl:ml-7" href="/tle-finitevolume/"><span class="text-md sm:text-xl tracking-tight sm:mr-5">Pixels and their neighbours</span></a></div><div class="flex-grow flex items-center w-auto"><div class="text-md flex-grow hidden lg:block"></div><div class="block flex-grow"></div><button class="theme rounded-full border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 mx-3 h-8 w-8" title="Change theme to dark mode." aria-label="Change theme to dark mode."><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="h-full w-full p-0.5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z"></path></svg></button><div class="block sm:hidden"><div class="relative" data-headlessui-state=""><div><button class="bg-transparent flex text-sm rounded-full focus:outline-none" id="headlessui-menu-button-:Rcj4p:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Open Menu</span><div class="flex items-center text-stone-200 hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="h-8 w-8 p-1"><path fill-rule="evenodd" d="M10.5 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zm0 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zm0 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0z" clip-rule="evenodd"></path></svg></div></button></div></div></div><div class="hidden sm:block"><a class="inline-block text-md px-4 py-2 mx-1 leading-none border rounded border-stone-700 dark:border-white text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 hover:bg-neutral-100 mt-0" href="/tle-finitevolume/build/cockett-heagy-oldenb-c6bbd4ad57b7a4be56ea2682a7fd4a03.pdf">Download PDF</a></div></div></nav></div><div class="fixed xl:article-grid article-grid-gap xl:w-screen z-30 xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><nav aria-label="Table of Contents" class="flex-grow overflow-y-auto transition-opacity mt-6 pb-3 ml-3 xl:ml-0 mr-3"><ul class="space-y-6 lg:space-y-2"><li class="text-slate-900 leading-5 dark:text-slate-100 font-semibold"><a title="Pixels and Their Neighbours" class="block break-words mb-8 lg:mb-3 font-semibold text-slate-900 dark:text-slate-200 border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/tle-finitevolume/">Pixels and Their Neighbours</a></li><li class=""><a title="Getting Started" class="block break-words border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/tle-finitevolume/index">Getting Started</a></li><li class=""><a title="Finite Volume Mesh" class="block break-words border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/tle-finitevolume/mesh">Finite Volume Mesh</a></li><li class=""><a title="Divergence Operator" class="block break-words border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/tle-finitevolume/divergence">Divergence Operator</a></li><li class=""><a title="Weak Formulation" class="block break-words border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/tle-finitevolume/weak-formulation">Weak Formulation</a></li><li class=""><a title="All Together Now" class="block break-words border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/tle-finitevolume/all-together-now">All Together Now</a></li></ul></nav><div class="flex-none py-4 opacity-0 transition-all duration-700 translate-y-6"><a class="flex w-fit mx-auto text-gray-700 hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://myst-tools.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center text-sm ml-2">Made with MyST</span></a></div></div></div><article class="article content article-grid article-grid-gap" style="margin-top:76px"><main class="article-grid article-subgrid-gap col-screen"><div class="mb-8"><div class="flex mt-3 mb-5 text-sm font-light items-center h-6"><div class="flex-none pr-2 smallcaps border-r mr-2">tutorial</div><div class="flex-none mr-2"><span class="smallcaps font-semibold">The Leading Edge</span></div><div class="flex-grow"></div><a href="https://creativecommons.org/licenses/by-sa/3.0/" target="_blank" rel="noopener noreferrer" class="opacity-50 hover:opacity-100 text-inherit hover:text-inherit" aria-label="Content License: Creative Commons Attribution Share Alike 3.0 Unported (CC-BY-SA-3.0)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="h-5 w-5 mx-1 inline-block"><title>Content License: Creative Commons Attribution Share Alike 3.0 Unported (CC-BY-SA-3.0)</title><path d="M12 2.2c2.7 0 5 1 7 2.9.9.9 1.6 2 2.1 3.1.5 1.2.7 2.4.7 3.8 0 1.3-.2 2.6-.7 3.8-.5 1.2-1.2 2.2-2.1 3.1-1 .9-2 1.7-3.2 2.2-1.2.5-2.5.7-3.7.7s-2.6-.3-3.8-.8c-1.2-.5-2.2-1.2-3.2-2.1s-1.6-2-2.1-3.2-.8-2.4-.8-3.7c0-1.3.2-2.5.7-3.7S4.2 6 5.1 5.1C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C5.6 7.1 5 8 4.6 9c-.4 1-.6 2-.6 3s.2 2.1.6 3c.4 1 1 1.8 1.8 2.6S8 19 9 19.4c1 .4 2 .6 3 .6s2.1-.2 3-.6c1-.4 1.9-1 2.7-1.8 1.5-1.5 2.3-3.3 2.3-5.6 0-1.1-.2-2.1-.6-3.1-.4-1-1-1.8-1.7-2.6C16.1 4.8 14.2 4 12 4zm-.1 6.4l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.5.3-1 .4-1.5.4-.9 0-1.6-.3-2.1-.8-.5-.6-.8-1.3-.8-2.3 0-.9.3-1.7.8-2.2.6-.6 1.3-.8 2.1-.8 1.2 0 2.1.4 2.6 1.4zm5.6 0l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.4.2-.9.3-1.4.3-.9 0-1.6-.3-2.1-.8s-.8-1.3-.8-2.2c0-.9.3-1.7.8-2.2.5-.5 1.2-.8 2-.8 1.2 0 2.1.4 2.6 1.4z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="h-5 w-5 mr-1 inline-block"><title>Credit must be given to the creator</title><path d="M12 2.2c2.7 0 5 .9 6.9 2.8 1.9 1.9 2.8 4.2 2.8 6.9s-.9 5-2.8 6.8c-2 1.9-4.3 2.9-7 2.9-2.6 0-4.9-1-6.9-2.9-1.8-1.7-2.8-4-2.8-6.7s1-5 2.9-6.9C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C4.8 8 4 9.9 4 12c0 2.2.8 4 2.4 5.6C8 19.2 9.8 20 12 20c2.2 0 4.1-.8 5.7-2.4 1.5-1.5 2.3-3.3 2.3-5.6 0-2.2-.8-4.1-2.3-5.7C16.1 4.8 14.2 4 12 4zm2.6 5.6v4h-1.1v4.7h-3v-4.7H9.4v-4c0-.2.1-.3.2-.4.1-.2.2-.2.4-.2h4c.2 0 .3.1.4.2.2.1.2.2.2.4zm-4-2.5c0-.9.5-1.4 1.4-1.4s1.4.5 1.4 1.4c0 .9-.5 1.4-1.4 1.4s-1.4-.5-1.4-1.4z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="h-5 w-5 mr-1 inline-block"><title>Adaptations must be shared under the same terms</title><path d="M12 2.2c2.7 0 5 .9 6.9 2.8 1.9 1.9 2.8 4.2 2.8 6.9s-.9 5-2.8 6.9c-2 1.9-4.3 2.9-7 2.9-2.6 0-4.9-1-6.9-2.9C3.2 17 2.2 14.7 2.2 12s1-5 2.9-6.9C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.4C4.8 8 4 9.9 4 12c0 2.2.8 4 2.4 5.6C8 19.2 9.8 20 12 20c2.2 0 4.1-.8 5.7-2.4 1.5-1.5 2.3-3.3 2.3-5.6 0-2.2-.8-4.1-2.3-5.6C16.1 4.8 14.2 4 12 4zm-4.3 6.6c.2-1.2.7-2.1 1.4-2.8.8-.7 1.7-1 2.8-1 1.5 0 2.8.5 3.7 1.5.9 1 1.4 2.3 1.4 3.8s-.5 2.7-1.4 3.7c-.9 1-2.2 1.5-3.7 1.5-1.1 0-2.1-.3-2.9-1-.8-.7-1.3-1.6-1.4-2.8h2.5c.1 1.2.8 1.8 2.1 1.8.7 0 1.2-.3 1.7-.9.4-.6.6-1.4.6-2.4s-.2-1.8-.6-2.4c-.4-.5-.9-.8-1.7-.8-1.3 0-2 .6-2.2 1.7h.7l-1.9 1.9-1.9-1.9.8.1z"></path></svg></a><a href="https://en.wikipedia.org/wiki/Open_access" target="_blank" rel="noopener noreferrer" title="Open Access" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="w-5 h-5 mr-1 inline-block opacity-60 hover:opacity-100 hover:text-[#E18435]"><path d="M17.1 12.6h-2V7.5c0-1.7-1.4-3.1-3-3.1-.8 0-1.6.3-2.2.9-.6.5-.9 1.3-.9 2.2v.7H7v-.7c0-1.4.5-2.7 1.5-3.7s2.2-1.5 3.6-1.5 2.6.5 3.6 1.5 1.5 2.3 1.5 3.7v5.1z"></path><path d="M12 21.8c-.8 0-1.6-.2-2.3-.5-.7-.3-1.4-.8-1.9-1.3-.6-.6-1-1.2-1.3-2-.3-.8-.5-1.6-.5-2.4s.2-1.6.5-2.4c.3-.7.7-1.4 1.3-2s1.2-1 1.9-1.3c.7-.3 1.5-.5 2.3-.5.8 0 1.6.2 2.3.5.7.3 1.4.8 1.9 1.3.6.6 1 1.2 1.3 2 .3.8.5 1.6.5 2.4s-.2 1.6-.5 2.4c-.3.7-.7 1.4-1.3 2-.6.6-1.2 1-1.9 1.3-.7.3-1.5.5-2.3.5zm0-10.3c-2.2 0-4 1.8-4 4.1s1.8 4.1 4 4.1 4-1.8 4-4.1-1.8-4.1-4-4.1z"></path><circle cx="12" cy="15.6" r="1.7"></circle></svg></a><a href="https://github.com/simpeg/tle-finitevolume" title="GitHub Repository: simpeg/tle-finitevolume" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="w-5 h-5 mr-1 inline-block opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="flex relative grow-0 inline-block mx-1" data-headlessui-state=""><button class="relative" id="headlessui-menu-button-:R1gaop:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-5 h-5 ml-2 -mr-1"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">Pixels and Their Neighbours</h1><header class="not-prose mt-4"><div class="grid grid-cols-1 sm:grid-cols-2 gap-y-1"><div class="font-thin text-xs uppercase pb-2">Authors</div><div class="font-thin text-xs uppercase pb-2">Affiliations</div><div><span class="font-semibold text-sm">Rowan Cockett<a class="ml-1" href="mailto:rowan@curvenote.com" title="Rowan Cockett &lt;rowan@curvenote.com&gt;" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="w-4 h-4 inline-block text-gray-400 hover:text-blue-400 -translate-y-[0.1em]"><path d="M21.8 18c0 1.1-.9 2-1.9 2H4.2c-1.1 0-1.9-.9-1.9-2V9.9c0-.5.3-.7.8-.4l7.8 4.7c.7.4 1.7.4 2.4 0L21 9.5c.4-.2.8-.1.8.4V18z"></path><path d="M21.8 6c0-1.1-.9-2-1.9-2H4.2c-1.1 0-2 .9-2 2v.4c0 .5.3 1.1.8 1.3l8.5 5.1c.2.1.7.1.9 0l8.6-5c.4-.3.8-.9.8-1.3-.1-.1-.1-.5 0-.5z"></path></svg></a><a class="ml-1" href="https://orcid.org/0000-0002-7859-8394" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="w-4 h-4 inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span></div><div class="text-sm"><div>University of British Columbia</div></div><div><span class="font-semibold text-sm">Lindsey Heagy<a class="ml-1" href="https://orcid.org/0000-0002-1551-5926" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="w-4 h-4 inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span></div><div class="text-sm"><div>University of British Columbia</div></div><div><span class="font-semibold text-sm">Douglas Oldenburg<a class="ml-1" href="https://orcid.org/0000-0002-4327-2124" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="w-4 h-4 inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span></div><div class="text-sm"><div>University of British Columbia</div></div></div></header><div class="flex mt-2 text-sm font-light"><time dateTime="2016/08/01" class="text-spacer">August 1, 2016</time><div class="flex-none" title="DOI (Digital Object Identifier)"><a class="font-light hover:font-light no-underline hover:underline text-inherit hover:text-inherit" target="_blank" rel="noopener noreferrer" href="https://doi.org/10.1190/tle35080703.1">https://doi.org/10.1190/tle35080703.1</a></div></div></div><div class="flex items-center"><div class="flex-grow"></div></div><div id="JiBcLiifhD" class="relative group/block article-grid article-subgrid-gap col-screen"><p>In this tutorial we take you on the journey from continuous equations to their discrete matrix representations using the finite volume method for the Direct Current (DC) resistivity problem. These techniques are widely applicable across geophysical simulation types and have their parallels in finite element and finite difference. We show derivations visually, as you would on a whiteboard, and have provided an accompanying notebook to explore the numerical results using <a target="_blank" href="http://simpeg.xyz/" rel="noreferrer">SimPEG</a>.</p></div><div id="NIMF14a06x" class="relative group/block article-grid article-subgrid-gap col-screen"><aside class="my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50 dark:bg-stone-800 overflow-hidden rounded-md border-l-4 border-blue-500"><div class="m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="h-8 w-8 inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path fill-rule="evenodd" d="M14.615 1.595a.75.75 0 01.359.852L12.982 9.75h7.268a.75.75 0 01.548 1.262l-10.5 11.25a.75.75 0 01-1.272-.71l1.992-7.302H3.75a.75.75 0 01-.548-1.262l10.5-11.25a.75.75 0 01.913-.143z" clip-rule="evenodd"></path></svg><div class="text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Important</div></div><div class="px-4 py-1"><p>This article was originally published in the Leading Edge (<span data-headlessui-state=""><cite class="border-dotted cursor-zoom-in border-b-2 border-b-blue-600 hover:text-blue-600 hover:border-solid" aria-expanded="false" data-headlessui-state="">Cockett et al., 2016</cite></span>) and is licensed under <a target="_blank" href="https://creativecommons.org/licenses/by-sa/3.0/" rel="noreferrer">CC-BY-SA-3.0</a>.</p></div></aside></div><div id="TVeSgJr01k" class="relative group/block article-grid article-subgrid-gap col-screen"><h1 id="dc-resistivity" class="relative group"><span class="heading-text">DC Resistivity</span><a class="select-none no-underline px-2 font-normal transition-opacity opacity-0 group-hover:opacity-70" href="#dc-resistivity" title="Link to this Section" aria-label="Link to this Section">¶</a></h1><p>DC resistivity surveys obtain information about subsurface electrical conductivity, <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span></span></span>. This physical property is often diagnostic in mineral exploration, geotechnical, environmental and hydrogeologic problems, where the target of interest has a significant electrical conductivity contrast from the background. In a DC resistivity survey, steady state currents are set up in the subsurface by injecting current through a positive electrode and completing the circuit with a return electrode (<span data-headlessui-state=""><span class="border-dotted cursor-zoom-in border-b-2 border-b-blue-600 hover:text-blue-600 hover:border-solid" aria-expanded="false" data-headlessui-state="">Figure <!-- -->1</span></span>).</p><figure id="dc-setup" class="figure col-margin-right row-span-2"><img style="width:90%;margin:0 auto" src="/tle-finitevolume/build/dc-setup-613da4e1507fa3e37aae2ebfe06df13a.png" alt="Setup of a DC resistivity survey." data-canonical-url="images/dc-setup.png"/><figcaption class="group"><p><a class="select-none no-underline mr-1 text-inherit hover:text-inherit font-semibold hover:font-semibold hover:underline" href="#dc-setup" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->1<!-- -->:</a>Setup of a DC resistivity survey.</p></figcaption></figure><p>The equations for DC resistivity are derived in (<span data-headlessui-state=""><span class="border-dotted cursor-zoom-in border-b-2 border-b-blue-600 hover:text-blue-600 hover:border-solid" aria-expanded="false" data-headlessui-state="">Figure <!-- -->2</span></span>). Conservation of charge (which can be derived by taking the divergence of Ampere&#x27;s law at steady state) connects the divergence of the current density everywhere in space to the source term which consists of two point sources, one positive and one negative.</p><p>The flow of current sets up electric fields according to Ohm&#x27;s law, which relates current density to electric fields through the electrical conductivity. From Faraday&#x27;s law for steady state fields, we can describe the electric field in terms of a scalar potential, <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ϕ</span></span></span></span></span>, which we sample at potential electrodes to obtain data in the form of potential differences.</p><figure id="dc-eqns" class="figure"><img style="margin:0 auto" src="/tle-finitevolume/build/dc-eqns-14b9e00423d94247d3f7fdce330861d4.png" alt="Derivation of the DC resistivity equations." data-canonical-url="images/dc-eqns.png"/><figcaption class="group"><p><a class="select-none no-underline mr-1 text-inherit hover:text-inherit font-semibold hover:font-semibold hover:underline" href="#dc-eqns" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->2<!-- -->:</a>Derivation of the DC resistivity equations.</p></figcaption></figure><p>To set up a solvable system of equations, we need the same number of unknowns as equations, in this case two unknowns (one scalar, <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ϕ</span></span></span></span></span>, and one vector <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>j</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.137em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span><span style="top:-3.2285em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span></span>) and two first-order equations (one scalar, one vector).</p><p>In this tutorial, we walk through setting up these first order equations in finite volume in three steps: (1) defining where the variables live on the mesh; (2) looking at a single cell to define the discrete divergence and the weak formulation; and (3) moving from a cell based view to the entire mesh to construct and solve the resulting matrix system. The notebooks included with this tutorial leverage the <a target="_blank" href="http://simpeg.xyz/" rel="noreferrer">SimPEG</a> package, which extends the methods discussed here to various mesh types.</p><h1 id="where-do-things-live" class="relative group"><span class="heading-text">Where do things live?</span><a class="select-none no-underline px-2 font-normal transition-opacity opacity-0 group-hover:opacity-70" href="#where-do-things-live" title="Link to this Section" aria-label="Link to this Section">¶</a></h1><p>To bring our continuous equations into the computer, we need to discretize the earth and represent it using a finite(!) set of numbers. In this tutorial we will explain the discretization in 2D and generalize to 3D in the notebooks. A 2D (or 3D!) mesh is used to divide up space, and we can represent functions (fields, parameters, etc.) on this mesh at a few discrete places: the nodes, edges, faces, or cell centers. For consistency between 2D and 3D we refer to faces having area and cells having volume, regardless of their dimensionality. Nodes and cell centers naturally hold scalar quantities while edges and faces have implied directionality and therefore naturally describe vectors. The conductivity, <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span></span></span>, changes as a function of space, and is likely to have discontinuities (e.g. if we cross a geologic boundary). As such, we will represent the conductivity as a constant over each cell, and discretize it at the center of the cell. The electrical current density, <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>j</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.137em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span><span style="top:-3.2285em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span></span>, will be continuous across conductivity interfaces, and therefore, we will represent it on the faces of each cell. Remember that <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>j</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.137em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span><span style="top:-3.2285em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span></span> is a vector; the direction of it is implied by the mesh definition (i.e. in <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span>, <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span> or <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span></span>), so we can store the array <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">j</mi></mrow><annotation encoding="application/x-tex">\mathbf{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathbf">j</span></span></span></span></span> as <em>scalars</em> that live on the face and inherit the face&#x27;s normal. When <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>j</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.137em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span><span style="top:-3.2285em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span></span> is defined on the faces of a cell the potential, <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ϕ</span></span></span></span></span>, will be put on the cell centers (since <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>j</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.137em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span><span style="top:-3.2285em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span></span> is related to <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ϕ</span></span></span></span></span> through spatial derivatives, it allows us to approximate centered derivatives leading to a staggered, second-order discretization). Once we have the functions placed on our mesh, we look at a single cell to discretize each first order equation. For simplicity in this tutorial we will choose to have all of the faces of our mesh be aligned with our spatial axes (<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span>, <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span> or <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span></span>), the extension to curvilinear meshes will be presented in the supporting notebooks.</p><figure id="fig-mesh" class="figure"><img style="width:100%;margin:0 auto" src="/tle-finitevolume/build/mesh-e776e801e0f099683f149fbe1d1c92f5.png" alt="Anatomy of a finite volume cell." data-canonical-url="images/mesh.png"/><figcaption class="group"><p><a class="select-none no-underline mr-1 text-inherit hover:text-inherit font-semibold hover:font-semibold hover:underline" href="#fig-mesh" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->3<!-- -->:</a>Anatomy of a finite volume cell.</p></figcaption></figure><h1 id="one-cell-at-a-time" class="relative group"><span class="heading-text">One cell at a time</span><a class="select-none no-underline px-2 font-normal transition-opacity opacity-0 group-hover:opacity-70" href="#one-cell-at-a-time" title="Link to this Section" aria-label="Link to this Section">¶</a></h1><p>To discretize the first order differential equations we consider a single cell in the mesh and we will work through the discrete description of equations (1) and (2) over that cell.</p><h2 id="id-1-in-and-out" class="relative group"><span class="heading-text">(1) In and out</span><a class="select-none no-underline px-2 font-normal transition-opacity opacity-0 group-hover:opacity-70" href="#id-1-in-and-out" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><figure id="fig-div" class="figure col-page-right"><img style="width:90%;margin-right:auto" src="/tle-finitevolume/build/divergence-c0bef8172fc19fa7f262e78596c71990.png" alt="Geometrical definition of the divergence and the discretization." data-canonical-url="images/divergence.png"/><figcaption class="group"><p><a class="select-none no-underline mr-1 text-inherit hover:text-inherit font-semibold hover:font-semibold hover:underline" href="#fig-div" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->4<!-- -->:</a>Geometrical definition of the divergence and the discretization.</p></figcaption></figure><p>So we have half of the equation discretized - the left hand side. Now we need to take care of the source: it contains two dirac delta functions - these are infinite at their origins, <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><msup><mi>s</mi><mo>+</mo></msup></msub></mrow><annotation encoding="application/x-tex">r_{s^+}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3419em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7027em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> and <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><msup><mi>s</mi><mo>−</mo></msup></msub></mrow><annotation encoding="application/x-tex">r_{s^-}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3419em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7027em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mbin mtight">−</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>. However, the volume integral of a delta function <em>is</em> well defined: it is <em>unity</em> if the volume contains the origin of the delta function otherwise it is <em>zero</em>.</p><p>As such, we can integrate both sides of the equation over the volume enclosed by the cell. Since <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">D</mi><mi mathvariant="bold">j</mi></mrow><annotation encoding="application/x-tex">\mathbf{D}\mathbf{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathbf">Dj</span></span></span></span></span> is constant over the cell, the integral is simply a multiplication by the volume of the cell <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>v</mtext><mi mathvariant="bold">D</mi><mi mathvariant="bold">j</mi></mrow><annotation encoding="application/x-tex">\text{v} \mathbf{D} \mathbf{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">v</span></span><span class="mord mathbf">Dj</span></span></span></span></span>. The integral of the source is zero unless one of the source electrodes is located inside the cell, in which case it is <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><mo>±</mo><mi>I</mi></mrow><annotation encoding="application/x-tex">q = \pm I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord">±</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span></span>. Now we have a discrete description of equation 1 over a single cell:</p><div id="eq-div" class="flex group my-5"><div class="overflow-x-auto flex-grow"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>v</mtext><mi mathvariant="bold">D</mi><mi mathvariant="bold">j</mi><mo>=</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">\text{v} \mathbf{D}\mathbf{j} = q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">v</span></span><span class="mord mathbf">Dj</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span></span></div><div class="flex-none text-right m-0 pl-2 self-center relative select-none"><a class="select-none no-underline text-inherit hover:text-inherit hover:underline" href="#eq-div" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->1<!-- -->)</a></div></div><h2 id="id-2-scalar-equations-only-please" class="relative group"><span class="heading-text">(2) Scalar equations only, please</span><a class="select-none no-underline px-2 font-normal transition-opacity opacity-0 group-hover:opacity-70" href="#id-2-scalar-equations-only-please" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Equation <span data-headlessui-state=""><span class="border-dotted cursor-zoom-in border-b-2 border-b-blue-600 hover:text-blue-600 hover:border-solid" aria-expanded="false" data-headlessui-state="">(<!-- -->1<!-- -->)</span></span> is a vector equation, so really it is two or three equations involving multiple components of <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>j</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.137em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span><span style="top:-3.2285em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span></span>. We want to work with a single scalar equation, allow for anisotropic physical properties, and potentially work with non-axis-aligned meshes - how do we do this?! We can use the <strong>weak formulation</strong> where we take the inner product (<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∫</mo><mover accent="true"><mi>a</mi><mo>⃗</mo></mover><mo>⋅</mo><mover accent="true"><mi>b</mi><mo>⃗</mo></mover><mi>d</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">\int \vec{a} \cdot \vec{b} dv</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1111em;vertical-align:-0.3061em;"></span><span class="mop op-symbol small-op" style="margin-right:0.19445em;position:relative;top:-0.0006em;">∫</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">a</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9774em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9774em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">b</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span></span>) of the equation with a generic face function, <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>f</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{f}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1719em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9774em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.0688em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span></span>. This reduces requirements of differentiability on the original equation and also allows us to consider tensor anisotropy or curvilinear meshes .</p><p>In <span data-headlessui-state=""><span class="border-dotted cursor-zoom-in border-b-2 border-b-blue-600 hover:text-blue-600 hover:border-solid" aria-expanded="false" data-headlessui-state="">Figure <!-- -->5</span></span>, we visually walk through the discretization of equation (b). On the left hand side, a dot product requires a <em>single</em> cartesian vector, <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">j</mi><mi mathvariant="bold">x</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">j</mi><mi mathvariant="bold">y</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{j_x, j_y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">j</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1611em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">j</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1611em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight" style="margin-right:0.01597em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span></span>. However, we have a <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span></span> defined on each face (2 <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>j</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">j_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> and 2 <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>j</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">j_y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9456em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span> in 2D!). There are many different ways to evaluate this inner product: we could approximate the integral using trapezoidal, midpoint or higher order approximations. A simple method is to break the integral into four sections (or 8 in 3D) and apply the midpoint rule for each section using the closest <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">j</mi></mrow><annotation encoding="application/x-tex">\mathbf{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathbf">j</span></span></span></span></span> components to compose a cartesian vector. A <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{P}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8361em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> matrix (size <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>×</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">2 \times 4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span></span></span></span></span>) is used to pick out the appropriate faces and compose the corresponding vector (these matrices are shown with colors corresponding to the appropriate face in the figure). On the right hand side, we use a vector identity to integrate by parts. The second term will cancel over the entire mesh (as the normals of adjacent cell faces point in opposite directions) and <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ϕ</span></span></span></span></span> on mesh boundary faces are zero by the Dirichlet boundary condition. This leaves us with the divergence, which we already know how to do!</p><figure id="fig-weak-formulation" class="figure"><img style="width:100%;margin:0 auto" src="/tle-finitevolume/build/weak-formulation-4b2a17d0b5767005d07fdb3714e0aa80.png" alt="Discretization using the weak formulation and inner products." data-canonical-url="images/weak-formulation.png"/><figcaption class="group"><p><a class="select-none no-underline mr-1 text-inherit hover:text-inherit font-semibold hover:font-semibold hover:underline" href="#fig-weak-formulation" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->5<!-- -->:</a>Discretization using the weak formulation and inner products.</p></figcaption></figure><p>The final step is to recognize that, now discretized, we can cancel the general face function <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">f</mi></mrow><annotation encoding="application/x-tex">\mathbf{f}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span></span></span> and transpose the result (for convention&#x27;s sake):</p><div id="JKwojxzYzP" class="flex group my-5"><div class="overflow-x-auto flex-grow"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mn>1</mn><mn>4</mn></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mn>4</mn></munderover><msubsup><mi mathvariant="bold">P</mi><mi>i</mi><mi mathvariant="normal">⊤</mi></msubsup><msqrt><mi>v</mi></msqrt><msup><mi mathvariant="bold">Σ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><msqrt><mi>v</mi></msqrt><msub><mi mathvariant="bold">P</mi><mi>i</mi></msub><mi mathvariant="bold">j</mi><mo>=</mo><msup><mi mathvariant="bold">D</mi><mi mathvariant="normal">⊤</mi></msup><mi>v</mi><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\frac{1}{4} \sum_{i=1}^4 \mathbf{P}_i^\top \sqrt{v} \mathbf{\Sigma}^{-1} \sqrt{v} \mathbf{P}_i \mathbf{j} = \mathbf{D}^\top v \phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0788em;vertical-align:-1.2777em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbf">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8492em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span><span style="top:-2.8092em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1908em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathbf">Σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8492em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span><span style="top:-2.8092em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1908em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathbf">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathbf">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0935em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathbf">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">ϕ</span></span></span></span></span></div><div class="flex-none text-right m-0 pl-2 self-center relative select-none"><a class="select-none no-underline text-inherit hover:text-inherit hover:underline" href="#JKwojxzYzP" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->2<!-- -->)</a></div></div><h1 id="all-together-now" class="relative group"><span class="heading-text">All together now</span><a class="select-none no-underline px-2 font-normal transition-opacity opacity-0 group-hover:opacity-70" href="#all-together-now" title="Link to this Section" aria-label="Link to this Section">¶</a></h1><p>We have now discretized the two first order equations over a single cell. What is left is to assemble and solve the DC system over the entire mesh. To implement the divergence on the full mesh, the stencil of ±1&#x27;s must index into <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">j</mi></mrow><annotation encoding="application/x-tex">\mathbf{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathbf">j</span></span></span></span></span> on the entire mesh (instead of four elements). Although this can be done in a <code>for-loop</code>, it is conceptually, and often computationally, easier to create this stencil using nested Kronecker Products (see notebook). The volume and area terms in the divergence get expanded to diagonal matrices, and we multiply them together to get the discrete divergence operator. The discretization of the <em>face</em> inner product can be abstracted to a function, <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">M</mi><mi>f</mi></msub><mo stretchy="false">(</mo><msup><mi>σ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{M}_f(\sigma^{-1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1002em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathbf">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>, that completes the inner product on the entire mesh at once. The main difference when implementing this is the <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">P</mi></mrow><annotation encoding="application/x-tex">\mathbf{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">P</span></span></span></span></span> matrices, which must index into the entire mesh. With the necessary operators defined for both equations on the entire mesh, we are left with two discrete equations:</p><div id="ekqNIgLcko" class="flex group my-5"><div class="overflow-x-auto flex-grow"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>diag</mtext><mo stretchy="false">(</mo><mi mathvariant="bold">v</mi><mo stretchy="false">)</mo><mi mathvariant="bold">D</mi><mi mathvariant="bold">j</mi><mo>=</mo><mi mathvariant="bold">q</mi></mrow><annotation encoding="application/x-tex">\text{diag}(\mathbf{v}) \mathbf{D}\mathbf{j} = \mathbf{q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">diag</span></span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="mclose">)</span><span class="mord mathbf">Dj</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em;"></span><span class="mord mathbf">q</span></span></span></span></span></div><div class="flex-none text-right m-0 pl-2 self-center relative select-none"><a class="select-none no-underline text-inherit hover:text-inherit hover:underline" href="#ekqNIgLcko" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->3<!-- -->)</a></div></div><div id="PegKRfb7TX" class="flex group my-5"><div class="overflow-x-auto flex-grow"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="bold">M</mi><mi>f</mi></msub><mo stretchy="false">(</mo><msup><mi>σ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">)</mo><mi mathvariant="bold">j</mi><mo>=</mo><msup><mi mathvariant="bold">D</mi><mi mathvariant="normal">⊤</mi></msup><mtext>diag</mtext><mo stretchy="false">(</mo><mi mathvariant="bold">v</mi><mo stretchy="false">)</mo><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\mathbf{M}_f(\sigma^{-1}) \mathbf{j} = \mathbf{D}^\top \text{diag}(\mathbf{v})\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1502em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathbf">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathbf">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1491em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathbf">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord text"><span class="mord">diag</span></span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="mclose">)</span><span class="mord mathnormal">ϕ</span></span></span></span></span></div><div class="flex-none text-right m-0 pl-2 self-center relative select-none"><a class="select-none no-underline text-inherit hover:text-inherit hover:underline" href="#PegKRfb7TX" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->4<!-- -->)</a></div></div><p>Note that now all variables are defined over the entire mesh. We could solve this coupled system or we could eliminate <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">j</mi></mrow><annotation encoding="application/x-tex">\mathbf{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathbf">j</span></span></span></span></span> and solve for <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ϕ</span></span></span></span></span> directly (a smaller, second-order system).</p></div><div id="NmRtLqTSkG" class="relative group/block shaded article-grid article-subgrid-gap col-screen"><div id="k96AllU7uc" class="flex group my-5"><div class="overflow-x-auto flex-grow"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>diag</mtext><mo stretchy="false">(</mo><mi mathvariant="bold">v</mi><mo stretchy="false">)</mo><mi mathvariant="bold">D</mi><msub><mi mathvariant="bold">M</mi><mi>f</mi></msub><mo stretchy="false">(</mo><msup><mi>σ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mo stretchy="false">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mi mathvariant="bold">D</mi><mi mathvariant="normal">⊤</mi></msup><mtext>diag</mtext><mo stretchy="false">(</mo><mi mathvariant="bold">v</mi><mo stretchy="false">)</mo><mi>ϕ</mi><mo>=</mo><mi mathvariant="bold">q</mi></mrow><annotation encoding="application/x-tex">\text{diag}({\mathbf{v}}) \mathbf{D}\mathbf{M}_f(\sigma^{-1})^{-1}\mathbf{D}^\top\text{diag}({\mathbf{v}})\phi = \mathbf{q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1852em;vertical-align:-0.2861em;"></span><span class="mord text"><span class="mord">diag</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="mclose">)</span><span class="mord mathbf">D</span><span class="mord"><span class="mord mathbf">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathbf">D</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mord text"><span class="mord">diag</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="mclose">)</span><span class="mord mathnormal">ϕ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em;"></span><span class="mord mathbf">q</span></span></span></span></span></div><div class="flex-none text-right m-0 pl-2 self-center relative select-none"><a class="select-none no-underline text-inherit hover:text-inherit hover:underline" href="#k96AllU7uc" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->5<!-- -->)</a></div></div></div><div id="xs1eIvH1CD" class="relative group/block article-grid article-subgrid-gap col-screen"><p>By solving this system matrix, we obtain a solution for the electric potential <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ϕ</span></span></span></span></span> everywhere in the domain. Creating predicted data from this requires an interpolation to the electrode locations and subtraction to obtain potential differences!</p><figure id="fig-results" class="figure"><img style="width:100%;margin:0 auto" src="/tle-finitevolume/build/dc-results-7f738d7d06a3b406848851da4f9586bd.png" alt="Electric potential on (a) tensor and (b) curvilinear meshes." data-canonical-url="images/dc-results.png"/><figcaption class="group"><p><a class="select-none no-underline mr-1 text-inherit hover:text-inherit font-semibold hover:font-semibold hover:underline" href="#fig-results" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->6<!-- -->:</a>Electric potential on (a) tensor and (b) curvilinear meshes.</p></figcaption></figure><p>Moving from continuous equations to their discrete analogues is fundamental in geophysical simulations. In this tutorial, we have started from a continuous description of the governing equations for the DC resistivity problem, selected locations on the mesh to discretize the continuous functions, constructed differential operators by considering one cell at a time, assembled and solved the discrete DC equations. Composing the finite volume system in this way allows us to move to different meshes and incorporate various types of boundary conditions that are often necessary when solving these equations in practice.</p></div><div id="WQq2Pv0ejY" class="relative group/block article-grid article-subgrid-gap col-screen"><p>Associated notebooks are available on <a target="_blank" href="https://github.com/simpeg/tle-finitevolume" rel="noreferrer">GitHub</a> and can be run online with <a target="_blank" href="http://mybinder.org/repo/simpeg/tle-finitevolume" rel="noreferrer">MyBinder</a>.</p></div><div id="l2pFYm01Xr" class="relative group/block article-grid article-subgrid-gap col-screen"><p>All article content, except where otherwise noted (including republished material), is licensed under a Creative Commons Attribution 3.0 Unported License (CC BY-SA). See <a target="_blank" href="https://creativecommons.org/licenses/by-sa/3.0/" rel="noreferrer">https://​​creativecommons​​.org​​/licenses​​/by​​-sa​​/3​​.0​​/</a>. Distribution or reproduction of this work in whole or in part commercially or noncommercially requires full attribution of the <span data-headlessui-state=""><cite class="border-dotted cursor-zoom-in border-b-2 border-b-blue-600 hover:text-blue-600 hover:border-solid" aria-expanded="false" data-headlessui-state="">original publication</cite></span>, including its digital object identifier (DOI). Derivatives of this work must carry the same license. All rights reserved.</p></div><section class="article-grid article-subgrid-gap col-screen"><div><header class="text-lg font-semibold text-stone-900 dark:text-white">References</header></div><div class="text-xs mb-8 pl-3 text-stone-500 dark:text-stone-300"><ol><li class="break-words" id="cite-Cockett_2016">Cockett, R., Heagy, L. J., &amp; Oldenburg, D. W. (2016). Pixels and their neighbors: Finite volume. <i>The Leading Edge</i>, <i>35</i>(8), 703–706. <a target="_blank" rel="noreferrer" href="https://doi.org/10.1190/tle35080703.1">10.1190/tle35080703.1</a></li></ol></div></section><div class="flex space-x-4 my-10"></div><nav></nav></main></article><script>((d,f)=>{if(!window.history.state||!window.history.state.key){let m=Math.random().toString(32).slice(2);window.history.replaceState({key:m},"")}try{let _=JSON.parse(sessionStorage.getItem(d)||"{}")[f||window.history.state.key];typeof _=="number"&&window.scrollTo(0,_)}catch(m){console.error(m),sessionStorage.removeItem(d)}})("positions", null)</script><link rel="modulepreload" href="/tle-finitevolume/build/manifest-2E91AB14.js"/><link rel="modulepreload" href="/tle-finitevolume/build/entry.client-34LOLN62.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-STCNRLUL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RAQ24GF6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-GATM77RM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3TZSZRI6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KDXZNC3T.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-A22JXTHK.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ZSIJYUGB.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CBNYJD3L.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DVCLQKI7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WNJSKYG3.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PJMGMBEF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-K4RCRPLV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MRIGPM2R.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-22THSYFL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MMC7DYY7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QCCLA5MS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-GKEX5P47.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PEZFBKC5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-GTDPPE5F.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WJAI73GQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-K3TZNCZM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LDZM4ZQD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EOJFZMT2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RHXQDGRU.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SGOFNTDL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JRSC6QBF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5ZPDX7PC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-I6CDKV3U.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-2SVF2XVU.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-YEQXTS7N.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-6Q25IZ5I.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LAXY2Z7G.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-STDT2SES.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-YPFJUWOK.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RNKF7ZYK.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Y3YNFCGX.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-2LSBMUX5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3WL2G4JH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-INCGFJJF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LAPR5CPM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WSGNN42Q.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LU3YBBX7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IO4TB7PQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TSDPYKGF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-OMZ63QZB.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ZBISOK7U.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-BFBSQVLM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-6NCTOO7H.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-35WHJMWC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-YSHWLRE5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-AFEAABZJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-H7ARGAD6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-NBX3MV4B.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LMIZNBNM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DIMQGE5G.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IAVLWJTK.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-HDQQIMKH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PPT3ZRQO.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DNTJS3HB.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-S4ASJ6WF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RWHSI6SS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TNC2IPU2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-HFKBYAKP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PE33EVMV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FHO2R5HQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7C63K5ZS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WLUE5D5N.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VGRADKJH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-OWFODDTP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IW66K23Q.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KYNTYNCC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PI75YC4W.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EL6N5MSU.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QBHOJFHW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4BX5SM52.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QWH7N7D5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-NHIRP2UW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-6KSP4KLH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VBEDDNKJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-B2HWZEB2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-I7JFPAYF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FW7ZENTV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IJHX74IM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-X4KFDT3J.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-I34TMOY6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-242IW4WY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EK6E5JAG.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-65GQPTAP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-OVRHUZZH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5I37TIZC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3N5EHFNM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-BIWPEXNE.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IBCYTMNP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-POO5RHVM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-OF6DTJRZ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QR7ET4LW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7ZRRD45L.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TL55OYNZ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SCCI2NO7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EPJQPYA2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-L6C7BXKA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QDETX3JT.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RH4EV35E.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5KHJHUOA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EQFQMUSV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-NPAKE72N.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PHOSHZFJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Y3PIPDQ7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-XKEJZ5C2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JQBCSWND.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ZUMT74W6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LFWDUXHM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-OXKZZVGI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CTZWZHUQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-D6SYBG5Y.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3GF2HD7O.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7JHMMAVX.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-UQ6TCMQE.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ZWPTSOKS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RGMPOWKL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FO7QNBMJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5OAXYVES.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ULBOFEUJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-BGY2PCTD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RLEXZ676.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5XGARS2D.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EOG3HBB2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-UDALPQXN.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CMQNPUMD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ZTHCIUYW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-HD4XYXOQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-6REJDOM5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-P6CCROY3.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JPIL6CZA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WUGZA3GJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-R6VMYYLS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FIUXFW2P.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-XYG5SNFW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5D2C2ZDA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SW6XFMQD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5CYLIJGM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3Q2KBA6X.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TPIWPMHX.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Z4TDC2YQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LA2YA4XX.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JIVCDPO2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-35IRQLNA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5K545OGO.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3L3Z3F6X.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-AD4PBXM6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-XKDLTTDF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-2PWAQOA6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VJ3VAB3H.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CYAOAKX5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-AAY5LSVK.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-B23JCRYQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MPIN2NQF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LD53Z7OK.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FBK434DZ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-GGT4H2PL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Z7P6TLAI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TH6IRUKI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MKLGTMZG.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-X4YOA4FP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-GQ5F3JOI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-X7APFMBA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QGQCU7Z5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-XWH5YON6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-L5HMB5WH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FLGTY6ML.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MYHK3VFC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3OOET6B3.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7NDTMEBY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JTFUE3TU.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-NPNO47VJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CEJPUMDN.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3UCYOZRC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QW3YGU7K.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4IDUKFNS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-BHAGSTTY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-NVGCL4ST.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CAPUTC5J.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FCUGECQA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-T5LEH3GP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QYFXPV5P.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ICZ2IBMN.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-2LGL2A76.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JW5HIPWL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WPIFJFBP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EI7MM2ZM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CPP55WXY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CMHA6RZZ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-737BPBEV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3A5424CL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JBWUJHML.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5EU2WZ4K.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-U4JP6WYN.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-6VMC3C6H.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DPD34KFT.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-P3HINRLA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-OEMWIF5I.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3ICMK33L.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-UVDURX6W.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EW2JJMFI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3IRPCF34.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MTWD2M7E.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-H7DOBPSH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FBVPMWWA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QMWX2HBM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JECYL6B6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7VXWSOTE.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-OFRX2LO7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IZ74E2PR.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LYZU5FLL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4QSJGUBC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-6NQHZQ5K.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3QPZ4I6A.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ID6MLM44.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ONF5ZEGX.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DCFHNYE2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WJC2TMC3.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Z4DXDTUR.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QJ653JTH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JB3B6A6E.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-GSHJN3MF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FEKTRG3M.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MPEWCBTI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-M6K2JCPM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FOUTP5HW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-OTRPIZML.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IKIZ2PYB.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VBLH3B7N.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-E724CIFR.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-F7RAUHZW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-577UU5TB.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-H5PDIPNZ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4R3JC4QW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-GNWNFVG7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JDKLS2ST.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RG2LYK5A.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7LUKHWIG.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KMNLZGTB.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-2KDE3HUQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-T7CNODMI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-UDP4Q2IW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SJW5G5ZV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-HGNYMY75.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5N53WRE2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IMXUHBPL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3ZCVCFNE.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-BN7JUA2J.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ILC5MFOH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WE62QWZJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TJKSLYFR.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KHHVIB5E.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MIEZSYDG.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DGWOMBJL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Q6WM2H72.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ZIMHSXAS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SUG474HR.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PCOW4WWS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CIYXD62H.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MDFBER5W.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-GX3CRW3F.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DGXGRRYX.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SSPVJ6IS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-HSSYMLB3.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-K4SMJ7WJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5GXFTTWI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PTBOR72Y.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LFO3DTKE.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-73RIUVPQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-G3WMP5TT.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Q7I77NW3.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RBSMNSRG.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TUTQC6ID.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5UGH6N65.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PZ433YLG.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SE6PSEOU.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EGAOT2MX.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-J4DVQC56.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-2HJQA6UR.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-AGF2AH6W.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-NQTTBETD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-HBD5TQ2W.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-BACRIHFA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-243ERP6K.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KVJXK4XS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4N3NM4UF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KEHCZZC6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IUFDJPNC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RHRSIKTF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LFJ5TAP5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5PKXRQNT.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IOD7UDJW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-UWNWXDHD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KKTDCDBD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EVHKG4ID.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-HZZT2QMW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SW2DO3HC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-UND5NCGU.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-N7BF3QMQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7DGHQJFM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-27JJJT5J.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7QILXESG.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QCI56KOS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IXXNFT7F.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FWUCSQCC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IRAY7AJW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DFU4VUYA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-AHRRAAFU.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FESZSXW4.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3VZJTP67.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-BE4WR3U4.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DFWGE7D2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7LKNMJOX.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VBOASNGM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-NVJX6L3I.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MUFDH4AZ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PCR5CMRA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KWT6S4ZV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5EGBKIHD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4BM4EP7Z.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-2K3JD7CH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RYSRWBFG.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-R76BX44Y.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EK6V5TFM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WIU3N2FZ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EUE65WU3.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4UPEPJRI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3HC64KIS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-E7XN57I6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VD4LJQH2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-67TXQYDP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-BEK3ZAYS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ZUMZ7YJB.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KQ7IVWBF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-C7ZQ7QWM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EFKCDIR4.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Y2A4AEYV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-UDIA6SFH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DXS5MIF7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CU3ZAA3J.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DLV26HDB.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-YWKBZMKK.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IXBCY7Z5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-XPKNF2GY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EXKS2N3U.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4CEEQ2WE.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-NNZYS7WL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3PWB3N72.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KDJ5AN5I.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IUKUVFD7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VI4FDREV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DRI5LEAT.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PXNDIUUW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WCSHVD66.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-44BZ4THS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KB6HQ3EV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-2IYZCRU7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ZC7GDBHQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MCW2X7P7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DBUVFRIJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-6GVV3CEI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-2ABAEOW6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3FPQWUCY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QOWH7JTY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4UQMVVJD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-57KO4L4Z.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PFDMZH4N.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JEBEDPBU.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3UFOYY7A.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DIUUOJG4.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-6KM7QLBA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QPEXGL65.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QOOYPE7X.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TYPZLHDR.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-NA5I5QSJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SVTVILDP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-NQOKPCQW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LBLFO2HD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-YBORSE7I.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-BNGMH6DJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TZEP4DU4.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WCZT4D6O.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EPZEB247.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-V36SVQOY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4NAMW6WM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Q7C3UT7I.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4NBANXMK.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-B6HZCSXG.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KYUAMBOV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QXS4MDGE.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-XO4MHCV5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-K23AXNVS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MNH6Q45X.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KHSXAZVY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-I5HZ6ZYD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DD3EWMVQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-K3DINP7C.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SZCYG5DL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-G6K2WDLD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TT6A6KRU.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FFELNGZL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-XCR3PWHN.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KESEDRO7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3DPXFF7X.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-P2KWQRNH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-HE2JMOB7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7DAB7OQH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7BNPYNPF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-F6PJ5VKY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VEB4DE47.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3Z7Y2QVW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MJ2VZ5KW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-M5AYHQJ4.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EFVWKFVT.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ICIFS5EX.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ZOSHAV3A.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5RZV4TWL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4KTLW4ZP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-T5E3KDVE.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-G4EWYFK2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ERF5MWXM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CFFS7EVD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QUDMGLFB.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7P32TNPW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JNYJ45RP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QINAB234.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-XXXALNY2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-74EWDK7I.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Q4IILUOS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-23WVLS7Q.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TL662EAH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MTQ2LD43.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-H6F4WG4L.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3WQU5EXB.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LDELMZ4A.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WDVSZKGW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-YBLFDHYD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-AGHHASP5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VAFNTHPE.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-GSQMQQYC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MWV6DYON.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DAFCVUAF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WXZLAVXJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4VFJTBR6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FKLMBUGG.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Q7PP7CGY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-56EHYZPP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-AJUK5WL4.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-XCY37IJJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4JJCRQLI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-6KRBY7ML.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QGRYECQP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-A5LRZ46O.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TFVFGSAC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CUXHMWVY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VLWCT2QF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-6AZYACTL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3K4C4EPY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-BMYASLMN.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WYLJH6RZ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ZJYHOD4M.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-STYFKBEC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-K6CGA3JU.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-26ODLRKY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-GQVYEF7L.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-O2ZMCC5B.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EGDTKE4G.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TZM7LRM3.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CUPAVG4I.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PBNVY5X4.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SHFEZ3LD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-U4F6TERZ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LIGNPJJR.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KIIZZSG2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-UV53JTY3.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VB6MEWRX.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-32OQE7MH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3VPM6F4D.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-P34ZT5AA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MTBRW4O3.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TTGWMB65.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IWHXKN3M.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-2LPZT57S.js"/><link rel="modulepreload" href="/tle-finitevolume/build/root-3VTM3HH5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IPZA66IR.js"/><link rel="modulepreload" href="/tle-finitevolume/build/routes/$-OY73AADE.js"/><script>window.__remixContext = {"state":{"loaderData":{"root":{"theme":"light","config":{"title":"Pixels and Their Neighbours: Finite Volume","logo_text":"Pixels and their neighbours","myst":"v1","nav":[],"actions":[{"title":"Download PDF","filename":"cockett-heagy-oldenburg-2016.pdf","url":"/tle-finitevolume/build/cockett-heagy-oldenb-c6bbd4ad57b7a4be56ea2682a7fd4a03.pdf","static":true}],"projects":[{"date":"2016/08/01","doi":"10.1190/tle35080703.1","open_access":true,"license":{"content":{"id":"CC-BY-SA-3.0","name":"Creative Commons Attribution Share Alike 3.0 Unported","CC":true,"url":"https://creativecommons.org/licenses/by-sa/3.0/"},"code":{"id":"MIT","name":"MIT License","osi":true,"free":true,"url":"https://opensource.org/licenses/MIT"}},"subject":"tutorial","exports":[{"format":"pdf","article":"paper.md"},{"format":"docx","article":"paper.md"},{"format":"xml","article":"paper.md","sub_articles":["notebooks/overview.ipynb","notebooks/mesh.ipynb","notebooks/divergence.ipynb","notebooks/weak-formulation.ipynb","notebooks/all-together-now.ipynb"]}],"title":"Pixels and Their Neighbours","subtitle":"Methods for Finite Volume Simulations","authors":[{"name":"Rowan Cockett","orcid":"0000-0002-7859-8394","corresponding":true,"email":"rowan@curvenote.com","affiliations":["University of British Columbia"]},{"name":"Lindsey Heagy","orcid":"0000-0002-1551-5926","affiliations":["University of British Columbia"]},{"name":"Douglas Oldenburg","orcid":"0000-0002-4327-2124","affiliations":["University of British Columbia"]}],"venue":{"title":"The Leading Edge"},"github":"https://github.com/simpeg/tle-finitevolume","bibliography":[],"index":"paper","pages":[{"slug":"index","title":"Getting Started","description":"","date":"2016/08/01","thumbnail":"/tle-finitevolume/build/dc-setup-613da4e1507fa3e37aae2ebfe06df13a.png","thumbnailOptimized":"","tags":[],"level":1},{"slug":"mesh","title":"Finite Volume Mesh","description":"","date":"2016/08/01","thumbnail":"/tle-finitevolume/build/mesh-e776e801e0f099683f149fbe1d1c92f5.png","thumbnailOptimized":"","tags":[],"level":1},{"slug":"divergence","title":"Divergence Operator","description":"","date":"2016/08/01","thumbnail":"/tle-finitevolume/build/divergence-c0bef8172fc19fa7f262e78596c71990.png","thumbnailOptimized":"","tags":[],"level":1},{"slug":"weak-formulation","title":"Weak Formulation","description":"","date":"2016/08/01","thumbnail":"/tle-finitevolume/build/weak-formulation-4b2a17d0b5767005d07fdb3714e0aa80.png","thumbnailOptimized":"","tags":[],"level":1},{"slug":"all-together-now","title":"All Together Now","description":"We will use our knowledge of the mesh and the divergence implementations to bring the DC resistivity equations together and show some pretty figures.","date":"2016/08/01","thumbnail":"/tle-finitevolume/build/all-together-now-b0ea50a11da3eab8c7ff01e4d07eae45.png","thumbnailOptimized":"","tags":[],"level":1}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/tle-finitevolume"},"routes/$":{"kind":"Article","sha256":"c7e27e8ceafaf03830532dd5ca783b10917309a3debfc49f7b990e3ac4af925b","slug":"paper","dependencies":[],"frontmatter":{"title":"Pixels and Their Neighbours","short_title":"Finite Volume","keywords":["Finite volume","Direct current","Resistivity","DC equations"],"license":{"content":{"id":"CC-BY-SA-3.0","name":"Creative Commons Attribution Share Alike 3.0 Unported","CC":true,"url":"https://creativecommons.org/licenses/by-sa/3.0/"}},"exports":[{"format":"md","filename":"paper.md","url":"/tle-finitevolume/build/paper-956244b63c0a7bb75b6ad24d322a29f9.md"}],"authors":[{"name":"Rowan Cockett","orcid":"0000-0002-7859-8394","corresponding":true,"email":"rowan@curvenote.com","affiliations":["University of British Columbia"]},{"name":"Lindsey Heagy","orcid":"0000-0002-1551-5926","affiliations":["University of British Columbia"]},{"name":"Douglas Oldenburg","orcid":"0000-0002-4327-2124","affiliations":["University of British Columbia"]}],"date":"2016/08/01","doi":"10.1190/tle35080703.1","open_access":true,"github":"https://github.com/simpeg/tle-finitevolume","subject":"tutorial","venue":{"title":"The Leading Edge"},"thumbnail":"/tle-finitevolume/build/dc-setup-613da4e1507fa3e37aae2ebfe06df13a.png"},"mdast":{"type":"root","children":[{"type":"block","position":{"start":{"line":15,"column":0},"end":{"line":16,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":17,"column":0},"end":{"line":18,"column":0}},"children":[{"type":"text","value":"In this tutorial we take you on the journey from continuous equations to their discrete matrix representations using the finite volume method for the Direct Current (DC) resistivity problem. These techniques are widely applicable across geophysical simulation types and have their parallels in finite element and finite difference. We show derivations visually, as you would on a whiteboard, and have provided an accompanying notebook to explore the numerical results using ","key":"eriHbsi0ku"},{"type":"link","url":"http://simpeg.xyz/","children":[{"type":"text","value":"SimPEG","key":"bKerSTVjue"}],"urlSource":"http://simpeg.xyz/","key":"WXDx4FeB7h"},{"type":"text","value":".","key":"rc7uXNA0wK"}],"key":"kgVhQS8B8l"}],"data":{"part":"abstract"},"key":"JiBcLiifhD"},{"type":"block","position":{"start":{"line":19,"column":0},"end":{"line":20,"column":0}},"children":[{"type":"admonition","kind":"important","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Important","key":"sTwGDMzRKT"}],"key":"DpJxxVOkFG"},{"type":"paragraph","position":{"start":{"line":22,"column":0},"end":{"line":23,"column":0}},"children":[{"type":"text","value":"This article was originally published in the Leading Edge (","key":"y4WeJihzRV"},{"type":"cite","url":"http://library.seg.org/doi/10.1190/tle35080703.1","children":[{"type":"text","value":"Cockett et al., 2016","key":"nb6LS9l1g3"}],"urlSource":"http://library.seg.org/doi/10.1190/tle35080703.1","kind":"narrative","label":"Cockett_2016","key":"t1jeaf1Vnb"},{"type":"text","value":") and is licensed under ","key":"x5wV1ROUZw"},{"type":"link","url":"https://creativecommons.org/licenses/by-sa/3.0/","children":[{"type":"text","value":"CC-BY-SA-3.0","key":"YNyodLzLHy"}],"urlSource":"https://creativecommons.org/licenses/by-sa/3.0/","key":"EHdVZMXnpe"},{"type":"text","value":".","key":"V9JFRx46zi"}],"key":"IqH2TOIzDF"}],"key":"JQ4r4IWYqQ"}],"key":"NIMF14a06x"},{"type":"block","position":{"start":{"line":25,"column":0},"end":{"line":26,"column":0}},"children":[{"type":"heading","depth":1,"position":{"start":{"line":27,"column":0},"end":{"line":28,"column":0}},"children":[{"type":"text","value":"DC Resistivity","key":"xQwL98bJmJ"}],"identifier":"dc-resistivity","label":"DC Resistivity","html_id":"dc-resistivity","implicit":true,"key":"iypbvbBVjE"},{"type":"paragraph","position":{"start":{"line":29,"column":0},"end":{"line":30,"column":0}},"children":[{"type":"text","value":"DC resistivity surveys obtain information about subsurface electrical conductivity, ","key":"kePumOgxFd"},{"type":"inlineMath","value":"\\sigma","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eσ\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\sigma\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eσ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"wEI1s0R65i"},{"type":"text","value":". This physical property is often diagnostic in mineral exploration, geotechnical, environmental and hydrogeologic problems, where the target of interest has a significant electrical conductivity contrast from the background. In a DC resistivity survey, steady state currents are set up in the subsurface by injecting current through a positive electrode and completing the circuit with a return electrode (","key":"peAMAxO4Tj"},{"type":"crossReference","children":[{"type":"text","value":"Figure ","key":"xwvXpezJEg"},{"type":"text","value":"1","key":"PGEmUe0BK1"}],"urlSource":"#dc-setup","identifier":"dc-setup","label":"dc-setup","kind":"figure","template":"Figure %s","enumerator":"1","resolved":true,"key":"k2f0e3Hn8M"},{"type":"text","value":").","key":"ODui0rsLR4"}],"key":"jOhDuJaVx1"},{"type":"container","kind":"figure","identifier":"dc-setup","label":"dc-setup","class":"col-margin-right row-span-2","children":[{"type":"image","url":"/tle-finitevolume/build/dc-setup-613da4e1507fa3e37aae2ebfe06df13a.png","width":"90%","alt":"Setup of a DC resistivity survey.","urlSource":"images/dc-setup.png","key":"ZsH3vy1wlf"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":36,"column":0},"end":{"line":37,"column":0}},"children":[{"type":"captionNumber","kind":"figure","label":"dc-setup","identifier":"dc-setup","html_id":"dc-setup","enumerator":"1","children":[{"type":"text","value":"Figure ","key":"BFFyJfryaz"},{"type":"text","value":"1","key":"GRFd9YEQU2"},{"type":"text","value":":","key":"sFjl1OpB2Q"}],"template":"Figure %s:","key":"GQ0hBtWErq"},{"type":"text","value":"Setup of a DC resistivity survey.","key":"qyU6bL6nJy"}],"key":"DgIKfTGBl5"}],"key":"pSqmS5ypbA"}],"enumerator":"1","html_id":"dc-setup","key":"VLzM9hp4Bt"},{"type":"paragraph","position":{"start":{"line":39,"column":0},"end":{"line":40,"column":0}},"children":[{"type":"text","value":"The equations for DC resistivity are derived in (","key":"ZRXSRCY23V"},{"type":"crossReference","children":[{"type":"text","value":"Figure ","key":"cVYosEcowm"},{"type":"text","value":"2","key":"jQX6D1uYsr"}],"urlSource":"#dc-eqns","identifier":"dc-eqns","label":"dc-eqns","kind":"figure","template":"Figure %s","enumerator":"2","resolved":true,"key":"N99xhOceSA"},{"type":"text","value":"). Conservation of charge (which can be derived by taking the divergence of Ampere's law at steady state) connects the divergence of the current density everywhere in space to the source term which consists of two point sources, one positive and one negative.","key":"BdwJqCAUaC"}],"key":"Ax4aWW1apW"},{"type":"paragraph","position":{"start":{"line":41,"column":0},"end":{"line":42,"column":0}},"children":[{"type":"text","value":"The flow of current sets up electric fields according to Ohm's law, which relates current density to electric fields through the electrical conductivity. From Faraday's law for steady state fields, we can describe the electric field in terms of a scalar potential, ","key":"EJsWryBsfm"},{"type":"inlineMath","value":"\\phi","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eϕ\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\phi\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eϕ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"OSf3lMuuDq"},{"type":"text","value":", which we sample at potential electrodes to obtain data in the form of potential differences.","key":"bYN5KRpTIe"}],"key":"MULqEumuS7"},{"type":"container","kind":"figure","identifier":"dc-eqns","label":"dc-eqns","children":[{"type":"image","url":"/tle-finitevolume/build/dc-eqns-14b9e00423d94247d3f7fdce330861d4.png","alt":"Derivation of the DC resistivity equations.","urlSource":"images/dc-eqns.png","key":"DErvYcr55Q"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":45,"column":0},"end":{"line":46,"column":0}},"children":[{"type":"captionNumber","kind":"figure","label":"dc-eqns","identifier":"dc-eqns","html_id":"dc-eqns","enumerator":"2","children":[{"type":"text","value":"Figure ","key":"g0rgZUG83B"},{"type":"text","value":"2","key":"kwDvQiDTEd"},{"type":"text","value":":","key":"ROQ6DeKx16"}],"template":"Figure %s:","key":"ivOMJJfjPf"},{"type":"text","value":"Derivation of the DC resistivity equations.","key":"BpVZ8xUbvj"}],"key":"FEPm8i2oXc"}],"key":"Wc9DhvceIw"}],"enumerator":"2","html_id":"dc-eqns","key":"kAI9sRldol"},{"type":"paragraph","position":{"start":{"line":48,"column":0},"end":{"line":49,"column":0}},"children":[{"type":"text","value":"To set up a solvable system of equations, we need the same number of unknowns as equations, in this case two unknowns (one scalar, ","key":"N8UP44UCKF"},{"type":"inlineMath","value":"\\phi","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eϕ\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\phi\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eϕ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Cqhw58tnTt"},{"type":"text","value":", and one vector ","key":"EKeoDxflH5"},{"type":"inlineMath","value":"\\vec{j}","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmo\u003e⃗\u003c/mo\u003e\u003c/mover\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\vec{j}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.137em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9425em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.2285em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.2355em;\"\u003e\u003cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'\u003e\u003cpath d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1944em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"WkhugcG61V"},{"type":"text","value":") and two first-order equations (one scalar, one vector).","key":"lYYFDuh9nZ"}],"key":"JWuCtQJJha"},{"type":"paragraph","position":{"start":{"line":50,"column":0},"end":{"line":51,"column":0}},"children":[{"type":"text","value":"In this tutorial, we walk through setting up these first order equations in finite volume in three steps: (1) defining where the variables live on the mesh; (2) looking at a single cell to define the discrete divergence and the weak formulation; and (3) moving from a cell based view to the entire mesh to construct and solve the resulting matrix system. The notebooks included with this tutorial leverage the ","key":"gQi5ssMaVu"},{"type":"link","url":"http://simpeg.xyz/","children":[{"type":"text","value":"SimPEG","key":"Lm35j3O8UO"}],"urlSource":"http://simpeg.xyz/","key":"MVFyFGiTWr"},{"type":"text","value":" package, which extends the methods discussed here to various mesh types.","key":"CbwtICS1TD"}],"key":"mjnZ9Nkk6D"},{"type":"heading","depth":1,"position":{"start":{"line":52,"column":0},"end":{"line":53,"column":0}},"children":[{"type":"text","value":"Where do things live?","key":"Z4fotMmPLv"}],"identifier":"where-do-things-live","label":"Where do things live?","html_id":"where-do-things-live","implicit":true,"key":"drJiOx1ZnJ"},{"type":"paragraph","position":{"start":{"line":54,"column":0},"end":{"line":55,"column":0}},"children":[{"type":"text","value":"To bring our continuous equations into the computer, we need to discretize the earth and represent it using a finite(!) set of numbers. In this tutorial we will explain the discretization in 2D and generalize to 3D in the notebooks. A 2D (or 3D!) mesh is used to divide up space, and we can represent functions (fields, parameters, etc.) on this mesh at a few discrete places: the nodes, edges, faces, or cell centers. For consistency between 2D and 3D we refer to faces having area and cells having volume, regardless of their dimensionality. Nodes and cell centers naturally hold scalar quantities while edges and faces have implied directionality and therefore naturally describe vectors. The conductivity, ","key":"Wt2bv87Reh"},{"type":"inlineMath","value":"\\sigma","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eσ\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\sigma\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eσ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"QoJHcCgrZf"},{"type":"text","value":", changes as a function of space, and is likely to have discontinuities (e.g. if we cross a geologic boundary). As such, we will represent the conductivity as a constant over each cell, and discretize it at the center of the cell. The electrical current density, ","key":"dWhfXhO9ph"},{"type":"inlineMath","value":"\\vec{j}","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmo\u003e⃗\u003c/mo\u003e\u003c/mover\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\vec{j}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.137em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9425em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.2285em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.2355em;\"\u003e\u003cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'\u003e\u003cpath d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1944em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"IMsvCXWOHh"},{"type":"text","value":", will be continuous across conductivity interfaces, and therefore, we will represent it on the faces of each cell. Remember that ","key":"oIW3DKBrxP"},{"type":"inlineMath","value":"\\vec{j}","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmo\u003e⃗\u003c/mo\u003e\u003c/mover\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\vec{j}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.137em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9425em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.2285em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.2355em;\"\u003e\u003cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'\u003e\u003cpath d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1944em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"MbC9zqVOzh"},{"type":"text","value":" is a vector; the direction of it is implied by the mesh definition (i.e. in ","key":"nvUZnkQsGL"},{"type":"inlineMath","value":"x","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ex\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"gCnmhToOYq"},{"type":"text","value":", ","key":"ySN72TjiYo"},{"type":"inlineMath","value":"y","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ey\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"j3u2g5YpWk"},{"type":"text","value":" or ","key":"Gdsdzchs7d"},{"type":"inlineMath","value":"z","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ez\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ez\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.04398em;\"\u003ez\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"XKhgQZol43"},{"type":"text","value":"), so we can store the array ","key":"SwW1woogQ2"},{"type":"inlineMath","value":"\\mathbf{j}","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{j}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"mCUQv2gnyv"},{"type":"text","value":" as ","key":"srXjY90tOt"},{"type":"emphasis","children":[{"type":"text","value":"scalars","key":"zZboOWCPkC"}],"key":"U5v4UKh5tm"},{"type":"text","value":" that live on the face and inherit the face's normal. When ","key":"xD6akgeYD9"},{"type":"inlineMath","value":"\\vec{j}","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmo\u003e⃗\u003c/mo\u003e\u003c/mover\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\vec{j}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.137em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9425em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.2285em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.2355em;\"\u003e\u003cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'\u003e\u003cpath d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1944em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"cerCwNOEit"},{"type":"text","value":" is defined on the faces of a cell the potential, ","key":"LKQGhVRq6j"},{"type":"inlineMath","value":"\\phi","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eϕ\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\phi\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eϕ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Cz9C6KC7by"},{"type":"text","value":", will be put on the cell centers (since ","key":"MlK0W5Hnnr"},{"type":"inlineMath","value":"\\vec{j}","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmo\u003e⃗\u003c/mo\u003e\u003c/mover\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\vec{j}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.137em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9425em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.2285em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.2355em;\"\u003e\u003cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'\u003e\u003cpath d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1944em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"BQwSVRbFbl"},{"type":"text","value":" is related to ","key":"Gd2rM8PZSM"},{"type":"inlineMath","value":"\\phi","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eϕ\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\phi\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eϕ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Ohgt3Uxeey"},{"type":"text","value":" through spatial derivatives, it allows us to approximate centered derivatives leading to a staggered, second-order discretization). Once we have the functions placed on our mesh, we look at a single cell to discretize each first order equation. For simplicity in this tutorial we will choose to have all of the faces of our mesh be aligned with our spatial axes (","key":"MfxlJgWWsx"},{"type":"inlineMath","value":"x","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ex\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Np1KkpHKj3"},{"type":"text","value":", ","key":"AVeDeOHKqa"},{"type":"inlineMath","value":"y","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ey\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"dT0K4CiVLD"},{"type":"text","value":" or ","key":"dOeLXC1qqE"},{"type":"inlineMath","value":"z","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ez\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ez\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.4306em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.04398em;\"\u003ez\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"CcYEiS0lI1"},{"type":"text","value":"), the extension to curvilinear meshes will be presented in the supporting notebooks.","key":"T9YHnF4F4v"}],"key":"LZqmPZgaPA"},{"type":"container","kind":"figure","identifier":"fig-mesh","label":"fig-mesh","children":[{"type":"image","url":"/tle-finitevolume/build/mesh-e776e801e0f099683f149fbe1d1c92f5.png","width":"100%","align":"center","alt":"Anatomy of a finite volume cell.","urlSource":"images/mesh.png","key":"ExjpmD5cAx"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":61,"column":0},"end":{"line":62,"column":0}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-mesh","identifier":"fig-mesh","html_id":"fig-mesh","enumerator":"3","children":[{"type":"text","value":"Figure ","key":"zIGHfkloAH"},{"type":"text","value":"3","key":"vYzYkeBD9c"},{"type":"text","value":":","key":"d9IAk8JUNV"}],"template":"Figure %s:","key":"JlGCkcQVb9"},{"type":"text","value":"Anatomy of a finite volume cell.","key":"ZaQPkuri5U"}],"key":"ftm9AOyexe"}],"key":"l9VWaXKzRX"}],"enumerator":"3","html_id":"fig-mesh","key":"l5BWDui3mN"},{"type":"heading","depth":1,"position":{"start":{"line":64,"column":0},"end":{"line":65,"column":0}},"children":[{"type":"text","value":"One cell at a time","key":"kak9x6XclY"}],"identifier":"one-cell-at-a-time","label":"One cell at a time","html_id":"one-cell-at-a-time","implicit":true,"key":"asXUJRYonz"},{"type":"paragraph","position":{"start":{"line":66,"column":0},"end":{"line":67,"column":0}},"children":[{"type":"text","value":"To discretize the first order differential equations we consider a single cell in the mesh and we will work through the discrete description of equations (1) and (2) over that cell.","key":"WkOz9Rntu2"}],"key":"KYRZ3P6V4x"},{"type":"heading","depth":2,"position":{"start":{"line":68,"column":0},"end":{"line":69,"column":0}},"children":[{"type":"text","value":"(1) In and out","key":"TGpiNpGDu6"}],"identifier":"id-1-in-and-out","label":"(1) In and out","html_id":"id-1-in-and-out","implicit":true,"key":"POeFDIh89G"},{"type":"container","kind":"figure","identifier":"fig-div","label":"fig-div","class":"col-page-right","children":[{"type":"image","url":"/tle-finitevolume/build/divergence-c0bef8172fc19fa7f262e78596c71990.png","width":"90%","align":"left","alt":"Geometrical definition of the divergence and the discretization.","urlSource":"images/divergence.png","key":"YrU7xSMsVW"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":76,"column":0},"end":{"line":77,"column":0}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-div","identifier":"fig-div","html_id":"fig-div","enumerator":"4","children":[{"type":"text","value":"Figure ","key":"u4W0puJuov"},{"type":"text","value":"4","key":"HychwBJSvp"},{"type":"text","value":":","key":"TKCEqIAr7A"}],"template":"Figure %s:","key":"MO2A5Z0hKl"},{"type":"text","value":"Geometrical definition of the divergence and the discretization.","key":"SdJhz4XxOJ"}],"key":"CUF3xFtPny"}],"key":"us1tAm0Vcv"}],"enumerator":"4","html_id":"fig-div","key":"Fz4dDtHPxj"},{"type":"paragraph","position":{"start":{"line":79,"column":0},"end":{"line":80,"column":0}},"children":[{"type":"text","value":"So we have half of the equation discretized - the left hand side. Now we need to take care of the source: it contains two dirac delta functions - these are infinite at their origins, ","key":"KcECMPjFwO"},{"type":"inlineMath","value":"r_{s^+}","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003er\u003c/mi\u003e\u003cmsup\u003e\u003cmi\u003es\u003c/mi\u003e\u003cmo\u003e+\u003c/mo\u003e\u003c/msup\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003er_{s^+}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003er\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3419em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003es\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7027em;\"\u003e\u003cspan style=\"top:-2.786em;margin-right:0.0714em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.5em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size3 size1 mtight\"\u003e\u003cspan class=\"mbin mtight\"\u003e+\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"oGoTsymPvx"},{"type":"text","value":" and ","key":"whY4oxJBH8"},{"type":"inlineMath","value":"r_{s^-}","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003er\u003c/mi\u003e\u003cmsup\u003e\u003cmi\u003es\u003c/mi\u003e\u003cmo\u003e−\u003c/mo\u003e\u003c/msup\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003er_{s^-}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003er\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3419em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003es\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7027em;\"\u003e\u003cspan style=\"top:-2.786em;margin-right:0.0714em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.5em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size3 size1 mtight\"\u003e\u003cspan class=\"mbin mtight\"\u003e−\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"lVDNUcXcZd"},{"type":"text","value":". However, the volume integral of a delta function ","key":"cAmI1PbuXa"},{"type":"emphasis","children":[{"type":"text","value":"is","key":"rqVgmYwn4t"}],"key":"CXlETlx9Zb"},{"type":"text","value":" well defined: it is ","key":"UMC3ndfPlT"},{"type":"emphasis","children":[{"type":"text","value":"unity","key":"Q8TrCSXynT"}],"key":"hyuEnQzHQx"},{"type":"text","value":" if the volume contains the origin of the delta function otherwise it is ","key":"BHafEX4RV9"},{"type":"emphasis","children":[{"type":"text","value":"zero","key":"l5V6aQ2QML"}],"key":"uErtHvXgwR"},{"type":"text","value":".","key":"vm1VEriicM"}],"key":"MJksavBcnB"},{"type":"paragraph","position":{"start":{"line":81,"column":0},"end":{"line":82,"column":0}},"children":[{"type":"text","value":"As such, we can integrate both sides of the equation over the volume enclosed by the cell. Since ","key":"oj6awkQagJ"},{"type":"inlineMath","value":"\\mathbf{D}\\mathbf{j}","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eD\u003c/mi\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{D}\\mathbf{j}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eDj\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"aM6kBcF1oq"},{"type":"text","value":" is constant over the cell, the integral is simply a multiplication by the volume of the cell ","key":"Ca8VUMjNk4"},{"type":"inlineMath","value":"\\text{v} \\mathbf{D} \\mathbf{j}","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmtext\u003ev\u003c/mtext\u003e\u003cmi mathvariant=\"bold\"\u003eD\u003c/mi\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\text{v} \\mathbf{D} \\mathbf{j}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003ev\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eDj\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"EU5jEsqqvn"},{"type":"text","value":". The integral of the source is zero unless one of the source electrodes is located inside the cell, in which case it is ","key":"yZHNpgTUvb"},{"type":"inlineMath","value":"q = \\pm I","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eq\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmo\u003e±\u003c/mo\u003e\u003cmi\u003eI\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003eq = \\pm I\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eq\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e±\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.07847em;\"\u003eI\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"XYs4T25GNh"},{"type":"text","value":". Now we have a discrete description of equation 1 over a single cell:","key":"oXmvx51ZAA"}],"key":"kElmoN4KjK"},{"type":"math","identifier":"eq:div","label":"eq:div","html_id":"eq-div","value":"\\text{v} \\mathbf{D}\\mathbf{j} = q","position":{"start":{"line":83,"column":0},"end":{"line":84,"column":0}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmtext\u003ev\u003c/mtext\u003e\u003cmi mathvariant=\"bold\"\u003eD\u003c/mi\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi\u003eq\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\text{v} \\mathbf{D}\\mathbf{j} = q\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003ev\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eDj\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eq\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"1","key":"Xs52HcQlxL"},{"type":"heading","depth":2,"position":{"start":{"line":85,"column":0},"end":{"line":86,"column":0}},"children":[{"type":"text","value":"(2) Scalar equations only, please","key":"TnjSfKYnY6"}],"identifier":"id-2-scalar-equations-only-please","label":"(2) Scalar equations only, please","html_id":"id-2-scalar-equations-only-please","implicit":true,"key":"q9rmvJd2LR"},{"type":"paragraph","position":{"start":{"line":87,"column":0},"end":{"line":88,"column":0}},"children":[{"type":"text","value":"Equation ","key":"LOwvmlAAf1"},{"type":"crossReference","children":[{"type":"text","value":"(","key":"y1hWkLjLGP"},{"type":"text","value":"1","key":"XE97YoSiC2"},{"type":"text","value":")","key":"FXTwwWepfl"}],"urlSource":"#eq:div","identifier":"eq:div","label":"eq:div","kind":"equation","template":"(%s)","enumerator":"1","resolved":true,"key":"P2OV8Yc5KX"},{"type":"text","value":" is a vector equation, so really it is two or three equations involving multiple components of ","key":"d2uC1ushEj"},{"type":"inlineMath","value":"\\vec{j}","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmo\u003e⃗\u003c/mo\u003e\u003c/mover\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\vec{j}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.137em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9425em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.2285em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.2355em;\"\u003e\u003cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'\u003e\u003cpath d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1944em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"iovdb9eDtV"},{"type":"text","value":". We want to work with a single scalar equation, allow for anisotropic physical properties, and potentially work with non-axis-aligned meshes - how do we do this?! We can use the ","key":"UOPckaYdAh"},{"type":"strong","children":[{"type":"text","value":"weak formulation","key":"NKQe1WlnYC"}],"key":"MOEzqyqUDZ"},{"type":"text","value":" where we take the inner product (","key":"KkC1U9dM6V"},{"type":"inlineMath","value":"\\int \\vec{a} \\cdot \\vec{b} dv","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmo\u003e∫\u003c/mo\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003ea\u003c/mi\u003e\u003cmo\u003e⃗\u003c/mo\u003e\u003c/mover\u003e\u003cmo\u003e⋅\u003c/mo\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003eb\u003c/mi\u003e\u003cmo\u003e⃗\u003c/mo\u003e\u003c/mover\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmi\u003ev\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\int \\vec{a} \\cdot \\vec{b} dv\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.1111em;vertical-align:-0.3061em;\"\u003e\u003c/span\u003e\u003cspan class=\"mop op-symbol small-op\" style=\"margin-right:0.19445em;position:relative;top:-0.0006em;\"\u003e∫\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.714em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ea\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.2355em;\"\u003e\u003cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'\u003e\u003cpath d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⋅\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.9774em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9774em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eb\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.2634em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.2355em;\"\u003e\u003cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'\u003e\u003cpath d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ev\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"kHddBwTGJu"},{"type":"text","value":") of the equation with a generic face function, ","key":"UVT3uE4LlM"},{"type":"inlineMath","value":"\\vec{f}","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003ef\u003c/mi\u003e\u003cmo\u003e⃗\u003c/mo\u003e\u003c/mover\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\vec{f}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.1719em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9774em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.2634em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.0688em;\"\u003e\u003cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'\u003e\u003cpath d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1944em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"SoRUHJaByO"},{"type":"text","value":". This reduces requirements of differentiability on the original equation and also allows us to consider tensor anisotropy or curvilinear meshes .","key":"Ao1v3twSnu"}],"key":"iXkEZNdPYR"},{"type":"paragraph","position":{"start":{"line":89,"column":0},"end":{"line":90,"column":0}},"children":[{"type":"text","value":"In ","key":"eFpX2gGFh8"},{"type":"crossReference","children":[{"type":"text","value":"Figure ","key":"To9aWvjFVd"},{"type":"text","value":"5","key":"dOk4Ue9PP7"}],"urlSource":"#fig-weak-formulation","identifier":"fig-weak-formulation","label":"fig-weak-formulation","kind":"figure","template":"Figure %s","enumerator":"5","resolved":true,"key":"NmEaOuQH7P"},{"type":"text","value":", we visually walk through the discretization of equation (b). On the left hand side, a dot product requires a ","key":"EaQZXlB00A"},{"type":"emphasis","children":[{"type":"text","value":"single","key":"a5wYJLfSgQ"}],"key":"bpdSifXbza"},{"type":"text","value":" cartesian vector, ","key":"H5ZDlRy2Fj"},{"type":"inlineMath","value":"\\mathbf{j_x, j_y}","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003cmi mathvariant=\"bold\"\u003ex\u003c/mi\u003e\u003c/msub\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmsub\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003cmi mathvariant=\"bold\"\u003ey\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{j_x, j_y}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003ej\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1611em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathbf mtight\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003ej\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1611em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathbf mtight\" style=\"margin-right:0.01597em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"FJFq4HSUHQ"},{"type":"text","value":". However, we have a ","key":"X9lf5YlAD7"},{"type":"inlineMath","value":"j","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ej\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ej\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"xudOFkLMJN"},{"type":"text","value":" defined on each face (2 ","key":"xCFqU9fB7I"},{"type":"inlineMath","value":"j_x","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ej_x\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"QZZfVyUYVq"},{"type":"text","value":" and 2 ","key":"brFnN517rF"},{"type":"inlineMath","value":"j_y","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ej_y\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.9456em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"zA4h57idcv"},{"type":"text","value":" in 2D!). There are many different ways to evaluate this inner product: we could approximate the integral using trapezoidal, midpoint or higher order approximations. A simple method is to break the integral into four sections (or 8 in 3D) and apply the midpoint rule for each section using the closest ","key":"SiCxg50aBM"},{"type":"inlineMath","value":"\\mathbf{j}","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{j}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"BCbjxEkxWA"},{"type":"text","value":" components to compose a cartesian vector. A ","key":"lwmIT1ZOaf"},{"type":"inlineMath","value":"\\mathbf{P}_i","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi mathvariant=\"bold\"\u003eP\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{P}_i\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8361em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eP\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"wM8IoOiDgZ"},{"type":"text","value":" matrix (size ","key":"CewneC1Nfu"},{"type":"inlineMath","value":"2 \\times 4","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmn\u003e2\u003c/mn\u003e\u003cmo\u003e×\u003c/mo\u003e\u003cmn\u003e4\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e2 \\times 4\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e2\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e×\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e4\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Hac45fRQJM"},{"type":"text","value":") is used to pick out the appropriate faces and compose the corresponding vector (these matrices are shown with colors corresponding to the appropriate face in the figure). On the right hand side, we use a vector identity to integrate by parts. The second term will cancel over the entire mesh (as the normals of adjacent cell faces point in opposite directions) and ","key":"k3dG0jClr8"},{"type":"inlineMath","value":"\\phi","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eϕ\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\phi\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eϕ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"qJb3MxczWB"},{"type":"text","value":" on mesh boundary faces are zero by the Dirichlet boundary condition. This leaves us with the divergence, which we already know how to do!","key":"xQ7WiKaDO0"}],"key":"vCsYUvjN3i"},{"type":"container","kind":"figure","identifier":"fig-weak-formulation","label":"fig-weak-formulation","children":[{"type":"image","url":"/tle-finitevolume/build/weak-formulation-4b2a17d0b5767005d07fdb3714e0aa80.png","width":"100%","align":"center","alt":"Discretization using the weak formulation and inner products.","urlSource":"images/weak-formulation.png","key":"pNsbOUbWm4"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":96,"column":0},"end":{"line":97,"column":0}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-weak-formulation","identifier":"fig-weak-formulation","html_id":"fig-weak-formulation","enumerator":"5","children":[{"type":"text","value":"Figure ","key":"SjsQREnZoO"},{"type":"text","value":"5","key":"gszhiol66f"},{"type":"text","value":":","key":"Vz0YX2J6Y3"}],"template":"Figure %s:","key":"uL7BzgNtSk"},{"type":"text","value":"Discretization using the weak formulation and inner products.","key":"COdB25j57t"}],"key":"nm3imGWTAz"}],"key":"KjcE86ROgY"}],"enumerator":"5","html_id":"fig-weak-formulation","key":"G4WR0yF8CA"},{"type":"paragraph","position":{"start":{"line":99,"column":0},"end":{"line":100,"column":0}},"children":[{"type":"text","value":"The final step is to recognize that, now discretized, we can cancel the general face function ","key":"kQLHeMm6Oh"},{"type":"inlineMath","value":"\\mathbf{f}","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003ef\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{f}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\" style=\"margin-right:0.10903em;\"\u003ef\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"mBQlLEd9qt"},{"type":"text","value":" and transpose the result (for convention's sake):","key":"DIV4Af3zNi"}],"key":"nCLKiUp3pZ"},{"type":"math","value":"\\frac{1}{4} \\sum_{i=1}^4 \\mathbf{P}_i^\\top \\sqrt{v} \\mathbf{\\Sigma}^{-1} \\sqrt{v} \\mathbf{P}_i \\mathbf{j} = \\mathbf{D}^\\top v \\phi","position":{"start":{"line":101,"column":0},"end":{"line":102,"column":0}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmfrac\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmn\u003e4\u003c/mn\u003e\u003c/mfrac\u003e\u003cmunderover\u003e\u003cmo\u003e∑\u003c/mo\u003e\u003cmrow\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003cmn\u003e4\u003c/mn\u003e\u003c/munderover\u003e\u003cmsubsup\u003e\u003cmi mathvariant=\"bold\"\u003eP\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmi mathvariant=\"normal\"\u003e⊤\u003c/mi\u003e\u003c/msubsup\u003e\u003cmsqrt\u003e\u003cmi\u003ev\u003c/mi\u003e\u003c/msqrt\u003e\u003cmsup\u003e\u003cmi mathvariant=\"bold\"\u003eΣ\u003c/mi\u003e\u003cmrow\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003c/msup\u003e\u003cmsqrt\u003e\u003cmi\u003ev\u003c/mi\u003e\u003c/msqrt\u003e\u003cmsub\u003e\u003cmi mathvariant=\"bold\"\u003eP\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003c/msub\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmsup\u003e\u003cmi mathvariant=\"bold\"\u003eD\u003c/mi\u003e\u003cmi mathvariant=\"normal\"\u003e⊤\u003c/mi\u003e\u003c/msup\u003e\u003cmi\u003ev\u003c/mi\u003e\u003cmi\u003eϕ\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\frac{1}{4} \\sum_{i=1}^4 \\mathbf{P}_i^\\top \\sqrt{v} \\mathbf{\\Sigma}^{-1} \\sqrt{v} \\mathbf{P}_i \\mathbf{j} = \\mathbf{D}^\\top v \\phi\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:3.0788em;vertical-align:-1.2777em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3214em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e4\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mop op-limits\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.8011em;\"\u003e\u003cspan style=\"top:-1.8723em;margin-left:0em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.05em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003cspan class=\"mrel mtight\"\u003e=\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.05em;\"\u003e\u003c/span\u003e\u003cspan\u003e\u003cspan class=\"mop op-symbol large-op\"\u003e∑\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-4.3em;margin-left:0em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.05em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e4\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.2777em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eP\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8991em;\"\u003e\u003cspan style=\"top:-2.453em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.113em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e⊤\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.247em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord sqrt\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8492em;\"\u003e\u003cspan class=\"svg-align\" style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\" style=\"padding-left:0.833em;\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ev\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-2.8092em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'\u003e\u003cpath d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1908em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eΣ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8641em;\"\u003e\u003cspan style=\"top:-3.113em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e−\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord sqrt\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8492em;\"\u003e\u003cspan class=\"svg-align\" style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\" style=\"padding-left:0.833em;\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ev\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-2.8092em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'\u003e\u003cpath d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1908em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eP\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3117em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ei\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ej\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0935em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eD\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8991em;\"\u003e\u003cspan style=\"top:-3.113em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e⊤\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ev\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eϕ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"2","key":"JKwojxzYzP"},{"type":"heading","depth":1,"position":{"start":{"line":103,"column":0},"end":{"line":104,"column":0}},"children":[{"type":"text","value":"All together now","key":"wiS3JF4DR7"}],"identifier":"all-together-now","label":"All together now","html_id":"all-together-now","implicit":true,"key":"CcLOfHBSYj"},{"type":"paragraph","position":{"start":{"line":105,"column":0},"end":{"line":106,"column":0}},"children":[{"type":"text","value":"We have now discretized the two first order equations over a single cell. What is left is to assemble and solve the DC system over the entire mesh. To implement the divergence on the full mesh, the stencil of ±1's must index into ","key":"I5J4X5OyPa"},{"type":"inlineMath","value":"\\mathbf{j}","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{j}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"XqPWa1bJmK"},{"type":"text","value":" on the entire mesh (instead of four elements). Although this can be done in a ","key":"kG8rZTxEiZ"},{"type":"inlineCode","value":"for-loop","key":"oxMYBHwCl7"},{"type":"text","value":", it is conceptually, and often computationally, easier to create this stencil using nested Kronecker Products (see notebook). The volume and area terms in the divergence get expanded to diagonal matrices, and we multiply them together to get the discrete divergence operator. The discretization of the ","key":"vzXj5XJZTj"},{"type":"emphasis","children":[{"type":"text","value":"face","key":"AyoEqOwicg"}],"key":"NoX1t1QjFf"},{"type":"text","value":" inner product can be abstracted to a function, ","key":"w49mFD5bYf"},{"type":"inlineMath","value":"\\mathbf{M}_f(\\sigma^{-1})","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi mathvariant=\"bold\"\u003eM\u003c/mi\u003e\u003cmi\u003ef\u003c/mi\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsup\u003e\u003cmi\u003eσ\u003c/mi\u003e\u003cmrow\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003c/msup\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{M}_f(\\sigma^{-1})\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.1002em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eM\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eσ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e−\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"bpFp8IfLOd"},{"type":"text","value":", that completes the inner product on the entire mesh at once. The main difference when implementing this is the ","key":"DAaYPWPxGg"},{"type":"inlineMath","value":"\\mathbf{P}","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003eP\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{P}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eP\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"dON1mFHw8o"},{"type":"text","value":" matrices, which must index into the entire mesh. With the necessary operators defined for both equations on the entire mesh, we are left with two discrete equations:","key":"zs74kxaeLw"}],"key":"cnpWwIDJe4"},{"type":"math","value":"\\text{diag}(\\mathbf{v}) \\mathbf{D}\\mathbf{j} = \\mathbf{q}","position":{"start":{"line":107,"column":0},"end":{"line":108,"column":0}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmtext\u003ediag\u003c/mtext\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi mathvariant=\"bold\"\u003ev\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmi mathvariant=\"bold\"\u003eD\u003c/mi\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi mathvariant=\"bold\"\u003eq\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\text{diag}(\\mathbf{v}) \\mathbf{D}\\mathbf{j} = \\mathbf{q}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003ediag\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathbf\" style=\"margin-right:0.01597em;\"\u003ev\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eDj\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eq\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"3","key":"ekqNIgLcko"},{"type":"math","value":"\\mathbf{M}_f(\\sigma^{-1}) \\mathbf{j} = \\mathbf{D}^\\top \\text{diag}(\\mathbf{v})\\phi","position":{"start":{"line":109,"column":0},"end":{"line":110,"column":0}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi mathvariant=\"bold\"\u003eM\u003c/mi\u003e\u003cmi\u003ef\u003c/mi\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsup\u003e\u003cmi\u003eσ\u003c/mi\u003e\u003cmrow\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003c/msup\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmsup\u003e\u003cmi mathvariant=\"bold\"\u003eD\u003c/mi\u003e\u003cmi mathvariant=\"normal\"\u003e⊤\u003c/mi\u003e\u003c/msup\u003e\u003cmtext\u003ediag\u003c/mtext\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi mathvariant=\"bold\"\u003ev\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmi\u003eϕ\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{M}_f(\\sigma^{-1}) \\mathbf{j} = \\mathbf{D}^\\top \\text{diag}(\\mathbf{v})\\phi\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.1502em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eM\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eσ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8641em;\"\u003e\u003cspan style=\"top:-3.113em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e−\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ej\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.1491em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eD\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8991em;\"\u003e\u003cspan style=\"top:-3.113em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e⊤\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003ediag\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathbf\" style=\"margin-right:0.01597em;\"\u003ev\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eϕ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"4","key":"PegKRfb7TX"},{"type":"paragraph","position":{"start":{"line":111,"column":0},"end":{"line":112,"column":0}},"children":[{"type":"text","value":"Note that now all variables are defined over the entire mesh. We could solve this coupled system or we could eliminate ","key":"XSZ2OzE8oc"},{"type":"inlineMath","value":"\\mathbf{j}","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathbf{j}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"qK1PkBVLRi"},{"type":"text","value":" and solve for ","key":"lfBwk57zyn"},{"type":"inlineMath","value":"\\phi","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eϕ\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\phi\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eϕ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"lHg2oCmBWi"},{"type":"text","value":" directly (a smaller, second-order system).","key":"nrUwSvShgM"}],"key":"LbuWFgnVG1"}],"key":"TVeSgJr01k"},{"type":"block","position":{"start":{"line":113,"column":0},"end":{"line":114,"column":0}},"children":[{"type":"math","value":"\\text{diag}({\\mathbf{v}}) \\mathbf{D}\\mathbf{M}_f(\\sigma^{-1})^{-1}\\mathbf{D}^\\top\\text{diag}({\\mathbf{v}})\\phi = \\mathbf{q}","html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmtext\u003ediag\u003c/mtext\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi mathvariant=\"bold\"\u003ev\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmi mathvariant=\"bold\"\u003eD\u003c/mi\u003e\u003cmsub\u003e\u003cmi mathvariant=\"bold\"\u003eM\u003c/mi\u003e\u003cmi\u003ef\u003c/mi\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsup\u003e\u003cmi\u003eσ\u003c/mi\u003e\u003cmrow\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003c/msup\u003e\u003cmsup\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmrow\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003c/msup\u003e\u003cmsup\u003e\u003cmi mathvariant=\"bold\"\u003eD\u003c/mi\u003e\u003cmi mathvariant=\"normal\"\u003e⊤\u003c/mi\u003e\u003c/msup\u003e\u003cmtext\u003ediag\u003c/mtext\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi mathvariant=\"bold\"\u003ev\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmi\u003eϕ\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmi mathvariant=\"bold\"\u003eq\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\text{diag}({\\mathbf{v}}) \\mathbf{D}\\mathbf{M}_f(\\sigma^{-1})^{-1}\\mathbf{D}^\\top\\text{diag}({\\mathbf{v}})\\phi = \\mathbf{q}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.1852em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003ediag\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\" style=\"margin-right:0.01597em;\"\u003ev\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eD\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eM\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\"\u003ef\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eσ\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8641em;\"\u003e\u003cspan style=\"top:-3.113em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e−\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8641em;\"\u003e\u003cspan style=\"top:-3.113em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e−\u003c/span\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003eD\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8991em;\"\u003e\u003cspan style=\"top:-3.113em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e⊤\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003ediag\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\" style=\"margin-right:0.01597em;\"\u003ev\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eϕ\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathbf\"\u003eq\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"5","key":"k96AllU7uc"}],"data":{"class":"shaded"},"key":"NmRtLqTSkG"},{"type":"block","position":{"start":{"line":119,"column":0},"end":{"line":120,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":121,"column":0},"end":{"line":122,"column":0}},"children":[{"type":"text","value":"By solving this system matrix, we obtain a solution for the electric potential ","key":"coX6BSBvN9"},{"type":"inlineMath","value":"\\phi","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003eϕ\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\phi\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eϕ\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"DiNGuhSSO0"},{"type":"text","value":" everywhere in the domain. Creating predicted data from this requires an interpolation to the electrode locations and subtraction to obtain potential differences!","key":"Sben6Qcvx7"}],"key":"RVTyCfjDOD"},{"type":"container","kind":"figure","identifier":"fig-results","label":"fig-results","children":[{"type":"image","url":"/tle-finitevolume/build/dc-results-7f738d7d06a3b406848851da4f9586bd.png","width":"100%","align":"center","alt":"Electric potential on (a) tensor and (b) curvilinear meshes.","urlSource":"images/dc-results.png","key":"Jt1v82PvF0"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":128,"column":0},"end":{"line":129,"column":0}},"children":[{"type":"captionNumber","kind":"figure","label":"fig-results","identifier":"fig-results","html_id":"fig-results","enumerator":"6","children":[{"type":"text","value":"Figure ","key":"J3O56zGvCR"},{"type":"text","value":"6","key":"Rm76ICnsBc"},{"type":"text","value":":","key":"xTtHtFmz7L"}],"template":"Figure %s:","key":"cEC9lGES9B"},{"type":"text","value":"Electric potential on (a) tensor and (b) curvilinear meshes.","key":"ldbzdMLKm3"}],"key":"sBiA8RSlgC"}],"key":"X2yvCyQMF3"}],"enumerator":"6","html_id":"fig-results","key":"pQcmvhuDWa"},{"type":"paragraph","position":{"start":{"line":131,"column":0},"end":{"line":132,"column":0}},"children":[{"type":"text","value":"Moving from continuous equations to their discrete analogues is fundamental in geophysical simulations. In this tutorial, we have started from a continuous description of the governing equations for the DC resistivity problem, selected locations on the mesh to discretize the continuous functions, constructed differential operators by considering one cell at a time, assembled and solved the discrete DC equations. Composing the finite volume system in this way allows us to move to different meshes and incorporate various types of boundary conditions that are often necessary when solving these equations in practice.","key":"pr4DVtuMRE"}],"key":"we1liAZW6K"}],"key":"xs1eIvH1CD"},{"type":"block","position":{"start":{"line":133,"column":0},"end":{"line":134,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":135,"column":0},"end":{"line":136,"column":0}},"children":[{"type":"text","value":"Associated notebooks are available on ","key":"uI2ztw2AXj"},{"type":"link","url":"https://github.com/simpeg/tle-finitevolume","children":[{"type":"text","value":"GitHub","key":"HGK8raRdn9"}],"urlSource":"https://github.com/simpeg/tle-finitevolume","error":true,"key":"I8YeStHDGN"},{"type":"text","value":" and can be run online with ","key":"QL4iqHj327"},{"type":"link","url":"http://mybinder.org/repo/simpeg/tle-finitevolume","children":[{"type":"text","value":"MyBinder","key":"OW70fIv49r"}],"urlSource":"http://mybinder.org/repo/simpeg/tle-finitevolume","key":"yM5MyODE6G"},{"type":"text","value":".","key":"Z53B3xRcO9"}],"key":"p4btqPn93d"}],"data":{"part":"data_availability"},"key":"WQq2Pv0ejY"},{"type":"block","position":{"start":{"line":137,"column":0},"end":{"line":138,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":139,"column":0},"end":{"line":140,"column":0}},"children":[{"type":"text","value":"All article content, except where otherwise noted (including republished material), is licensed under a Creative Commons Attribution 3.0 Unported License (CC BY-SA). See ","key":"u1pzeh5sOD"},{"type":"link","url":"https://creativecommons.org/licenses/by-sa/3.0/","children":[{"type":"text","value":"https://​​creativecommons​​.org​​/licenses​​/by​​-sa​​/3​​.0​​/","key":"HhQfaJsSkj"}],"urlSource":"https://creativecommons.org/licenses/by-sa/3.0/","key":"v3oEWE1pNz"},{"type":"text","value":". Distribution or reproduction of this work in whole or in part commercially or noncommercially requires full attribution of the ","key":"NSOTHETv2Q"},{"type":"cite","url":"https://library.seg.org/doi/10.1190/tle35080703.1","children":[{"type":"text","value":"original publication","key":"d6rL3Tdjqt"}],"urlSource":"https://library.seg.org/doi/10.1190/tle35080703.1","kind":"narrative","label":"Cockett_2016","key":"VzA35JS5Lv"},{"type":"text","value":", including its digital object identifier (DOI). Derivatives of this work must carry the same license. All rights reserved.","key":"rJ9STbX0YL"}],"key":"k70FCy0Xyg"}],"data":{"part":"appendix"},"key":"l2pFYm01Xr"}],"key":"ergL7d10Qd"},"references":{"cite":{"order":["Cockett_2016"],"data":{"Cockett_2016":{"number":1,"doi":"10.1190/tle35080703.1","html":"Cockett, R., Heagy, L. J., \u0026amp; Oldenburg, D. W. (2016). Pixels and their neighbors: Finite volume. \u003ci\u003eThe Leading Edge\u003c/i\u003e, \u003ci\u003e35\u003c/i\u003e(8), 703–706. \u003ca target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1190/tle35080703.1\"\u003e10.1190/tle35080703.1\u003c/a\u003e"}}}},"footer":{},"domain":"http://localhost:3000"}},"actionData":null,"errors":null},"future":{"unstable_cssModules":false,"unstable_cssSideEffectImports":false,"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"unstable_vanillaExtract":false,"v2_errorBoundary":false,"v2_meta":false,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/tle-finitevolume/build/manifest-2E91AB14.js";
import * as route0 from "/tle-finitevolume/build/root-3VTM3HH5.js";
import * as route1 from "/tle-finitevolume/build/routes/$-OY73AADE.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/tle-finitevolume/build/entry.client-34LOLN62.js");</script></body></html>