<!DOCTYPE html><html lang="en" class="light scroll-p-20"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Divergence Operator - Pixels and Their Neighbours: Finite Volume</title><meta name="image" content="/tle-finitevolume/build/divergence-c0bef8172fc19fa7f262e78596c71990.png"/><meta property="og:title" content="Divergence Operator - Pixels and Their Neighbours: Finite Volume"/><meta property="og:image" content="/tle-finitevolume/build/divergence-c0bef8172fc19fa7f262e78596c71990.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Divergence Operator - Pixels and Their Neighbours: Finite Volume"/><meta name="twitter:image" content="/tle-finitevolume/build/divergence-c0bef8172fc19fa7f262e78596c71990.png"/><meta name="twitter:alt" content="Divergence Operator - Pixels and Their Neighbours: Finite Volume"/><link rel="stylesheet" href="/tle-finitevolume/build/_assets/app-ADU2AYLI.css"/><link rel="stylesheet" href="/tle-finitevolume/build/_assets/thebe-core-BKMFZL7Z.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 fixed w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-wrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="h-8 w-8 p-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 013.75 6h16.5a.75.75 0 010 1.5H3.75A.75.75 0 013 6.75zM3 12a.75.75 0 01.75-.75h16.5a.75.75 0 010 1.5H3.75A.75.75 0 013 12zm0 5.25a.75.75 0 01.75-.75h16.5a.75.75 0 010 1.5H3.75a.75.75 0 01-.75-.75z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center dark:text-white w-fit ml-3 md:ml-5 xl:ml-7" href="/tle-finitevolume/"><span class="text-md sm:text-xl tracking-tight sm:mr-5">Pixels and their neighbours</span></a></div><div class="flex-grow flex items-center w-auto"><div class="text-md flex-grow hidden lg:block"></div><div class="block flex-grow"></div><button class="theme rounded-full border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 mx-3 h-8 w-8" title="Change theme to dark mode." aria-label="Change theme to dark mode."><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="h-full w-full p-0.5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z"></path></svg></button><div class="block sm:hidden"><div class="relative" data-headlessui-state=""><div><button class="bg-transparent flex text-sm rounded-full focus:outline-none" id="headlessui-menu-button-:Rcj4p:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Open Menu</span><div class="flex items-center text-stone-200 hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="h-8 w-8 p-1"><path fill-rule="evenodd" d="M10.5 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zm0 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zm0 6a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0z" clip-rule="evenodd"></path></svg></div></button></div></div></div><div class="hidden sm:block"><a class="inline-block text-md px-4 py-2 mx-1 leading-none border rounded border-stone-700 dark:border-white text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 hover:bg-neutral-100 mt-0" href="/tle-finitevolume/build/cockett-heagy-oldenb-c6bbd4ad57b7a4be56ea2682a7fd4a03.pdf">Download PDF</a></div></div></nav></div><div class="fixed xl:article-grid article-grid-gap xl:w-screen z-30 xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><nav aria-label="Table of Contents" class="flex-grow overflow-y-auto transition-opacity mt-6 pb-3 ml-3 xl:ml-0 mr-3"><ul class="space-y-6 lg:space-y-2"><li class="text-slate-900 leading-5 dark:text-slate-100 font-semibold"><a title="Pixels and Their Neighbours" class="block break-words mb-8 lg:mb-3 font-semibold text-slate-900 dark:text-slate-200 border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/tle-finitevolume/">Pixels and Their Neighbours</a></li><li class=""><a title="Getting Started" class="block break-words border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/tle-finitevolume/index">Getting Started</a></li><li class=""><a title="Finite Volume Mesh" class="block break-words border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/tle-finitevolume/mesh">Finite Volume Mesh</a></li><li class=""><a title="Divergence Operator" class="block break-words border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/tle-finitevolume/divergence">Divergence Operator</a></li><li class=""><a title="Weak Formulation" class="block break-words border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/tle-finitevolume/weak-formulation">Weak Formulation</a></li><li class=""><a title="All Together Now" class="block break-words border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/tle-finitevolume/all-together-now">All Together Now</a></li></ul></nav><div class="flex-none py-4 opacity-0 transition-all duration-700 translate-y-6"><a class="flex w-fit mx-auto text-gray-700 hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://myst-tools.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center text-sm ml-2">Made with MyST</span></a></div></div></div><article class="article content article-grid article-grid-gap" style="margin-top:76px"><main class="article-grid article-subgrid-gap col-screen"><div class="mb-8"><div class="flex mt-3 mb-5 text-sm font-light items-center h-6"><div class="flex-none pr-2 smallcaps border-r mr-2">tutorial</div><div class="flex-none mr-2"><span class="smallcaps font-semibold">The Leading Edge</span></div><div class="flex-grow"></div><a href="https://creativecommons.org/licenses/by-sa/3.0/" target="_blank" rel="noopener noreferrer" class="opacity-50 hover:opacity-100 text-inherit hover:text-inherit" aria-label="Content License: Creative Commons Attribution Share Alike 3.0 Unported (CC-BY-SA-3.0)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="h-5 w-5 mx-1 inline-block"><title>Content License: Creative Commons Attribution Share Alike 3.0 Unported (CC-BY-SA-3.0)</title><path d="M12 2.2c2.7 0 5 1 7 2.9.9.9 1.6 2 2.1 3.1.5 1.2.7 2.4.7 3.8 0 1.3-.2 2.6-.7 3.8-.5 1.2-1.2 2.2-2.1 3.1-1 .9-2 1.7-3.2 2.2-1.2.5-2.5.7-3.7.7s-2.6-.3-3.8-.8c-1.2-.5-2.2-1.2-3.2-2.1s-1.6-2-2.1-3.2-.8-2.4-.8-3.7c0-1.3.2-2.5.7-3.7S4.2 6 5.1 5.1C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C5.6 7.1 5 8 4.6 9c-.4 1-.6 2-.6 3s.2 2.1.6 3c.4 1 1 1.8 1.8 2.6S8 19 9 19.4c1 .4 2 .6 3 .6s2.1-.2 3-.6c1-.4 1.9-1 2.7-1.8 1.5-1.5 2.3-3.3 2.3-5.6 0-1.1-.2-2.1-.6-3.1-.4-1-1-1.8-1.7-2.6C16.1 4.8 14.2 4 12 4zm-.1 6.4l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.5.3-1 .4-1.5.4-.9 0-1.6-.3-2.1-.8-.5-.6-.8-1.3-.8-2.3 0-.9.3-1.7.8-2.2.6-.6 1.3-.8 2.1-.8 1.2 0 2.1.4 2.6 1.4zm5.6 0l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.4.2-.9.3-1.4.3-.9 0-1.6-.3-2.1-.8s-.8-1.3-.8-2.2c0-.9.3-1.7.8-2.2.5-.5 1.2-.8 2-.8 1.2 0 2.1.4 2.6 1.4z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="h-5 w-5 mr-1 inline-block"><title>Credit must be given to the creator</title><path d="M12 2.2c2.7 0 5 .9 6.9 2.8 1.9 1.9 2.8 4.2 2.8 6.9s-.9 5-2.8 6.8c-2 1.9-4.3 2.9-7 2.9-2.6 0-4.9-1-6.9-2.9-1.8-1.7-2.8-4-2.8-6.7s1-5 2.9-6.9C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C4.8 8 4 9.9 4 12c0 2.2.8 4 2.4 5.6C8 19.2 9.8 20 12 20c2.2 0 4.1-.8 5.7-2.4 1.5-1.5 2.3-3.3 2.3-5.6 0-2.2-.8-4.1-2.3-5.7C16.1 4.8 14.2 4 12 4zm2.6 5.6v4h-1.1v4.7h-3v-4.7H9.4v-4c0-.2.1-.3.2-.4.1-.2.2-.2.4-.2h4c.2 0 .3.1.4.2.2.1.2.2.2.4zm-4-2.5c0-.9.5-1.4 1.4-1.4s1.4.5 1.4 1.4c0 .9-.5 1.4-1.4 1.4s-1.4-.5-1.4-1.4z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="h-5 w-5 mr-1 inline-block"><title>Adaptations must be shared under the same terms</title><path d="M12 2.2c2.7 0 5 .9 6.9 2.8 1.9 1.9 2.8 4.2 2.8 6.9s-.9 5-2.8 6.9c-2 1.9-4.3 2.9-7 2.9-2.6 0-4.9-1-6.9-2.9C3.2 17 2.2 14.7 2.2 12s1-5 2.9-6.9C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.4C4.8 8 4 9.9 4 12c0 2.2.8 4 2.4 5.6C8 19.2 9.8 20 12 20c2.2 0 4.1-.8 5.7-2.4 1.5-1.5 2.3-3.3 2.3-5.6 0-2.2-.8-4.1-2.3-5.6C16.1 4.8 14.2 4 12 4zm-4.3 6.6c.2-1.2.7-2.1 1.4-2.8.8-.7 1.7-1 2.8-1 1.5 0 2.8.5 3.7 1.5.9 1 1.4 2.3 1.4 3.8s-.5 2.7-1.4 3.7c-.9 1-2.2 1.5-3.7 1.5-1.1 0-2.1-.3-2.9-1-.8-.7-1.3-1.6-1.4-2.8h2.5c.1 1.2.8 1.8 2.1 1.8.7 0 1.2-.3 1.7-.9.4-.6.6-1.4.6-2.4s-.2-1.8-.6-2.4c-.4-.5-.9-.8-1.7-.8-1.3 0-2 .6-2.2 1.7h.7l-1.9 1.9-1.9-1.9.8.1z"></path></svg></a><a href="https://opensource.org/licenses/MIT" target="_blank" rel="noopener noreferrer" title="Code License: MIT License (MIT)" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="h-5 w-5 mx-1 inline-block opacity-60 hover:opacity-100 hover:text-[#599F46]"><path d="M13.2 15.6c1.4-.5 2.1-1.6 2.1-3.3S13.8 8.9 12 8.9c-1.9 0-3.3 1.6-3.3 3.3 0 1.8.8 3 2.2 3.4l-2.3 5.9c-3.1-.8-6.3-4.6-6.3-9.3 0-5.5 4.3-10 9.7-10s9.8 4.5 9.8 10c0 4.7-3.1 8.5-6.3 9.3l-2.3-5.9z"></path></svg></a><a href="https://en.wikipedia.org/wiki/Open_access" target="_blank" rel="noopener noreferrer" title="Open Access" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="w-5 h-5 mr-1 inline-block opacity-60 hover:opacity-100 hover:text-[#E18435]"><path d="M17.1 12.6h-2V7.5c0-1.7-1.4-3.1-3-3.1-.8 0-1.6.3-2.2.9-.6.5-.9 1.3-.9 2.2v.7H7v-.7c0-1.4.5-2.7 1.5-3.7s2.2-1.5 3.6-1.5 2.6.5 3.6 1.5 1.5 2.3 1.5 3.7v5.1z"></path><path d="M12 21.8c-.8 0-1.6-.2-2.3-.5-.7-.3-1.4-.8-1.9-1.3-.6-.6-1-1.2-1.3-2-.3-.8-.5-1.6-.5-2.4s.2-1.6.5-2.4c.3-.7.7-1.4 1.3-2s1.2-1 1.9-1.3c.7-.3 1.5-.5 2.3-.5.8 0 1.6.2 2.3.5.7.3 1.4.8 1.9 1.3.6.6 1 1.2 1.3 2 .3.8.5 1.6.5 2.4s-.2 1.6-.5 2.4c-.3.7-.7 1.4-1.3 2-.6.6-1.2 1-1.9 1.3-.7.3-1.5.5-2.3.5zm0-10.3c-2.2 0-4 1.8-4 4.1s1.8 4.1 4 4.1 4-1.8 4-4.1-1.8-4.1-4-4.1z"></path><circle cx="12" cy="15.6" r="1.7"></circle></svg></a><a href="https://github.com/simpeg/tle-finitevolume" title="GitHub Repository: simpeg/tle-finitevolume" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="w-5 h-5 mr-1 inline-block opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="h-5 w-5 inline-block"><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><div class="flex relative grow-0 inline-block mx-1" data-headlessui-state=""><button class="relative" id="headlessui-menu-button-:R1gaop:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-5 h-5 ml-2 -mr-1"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">Divergence Operator</h1><header class="not-prose mt-4"><div class="grid grid-cols-1 sm:grid-cols-2 gap-y-1"><div class="font-thin text-xs uppercase pb-2">Authors</div><div class="font-thin text-xs uppercase pb-2">Affiliations</div><div><span class="font-semibold text-sm">Rowan Cockett<a class="ml-1" href="mailto:rowan@curvenote.com" title="Rowan Cockett &lt;rowan@curvenote.com&gt;" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="w-4 h-4 inline-block text-gray-400 hover:text-blue-400 -translate-y-[0.1em]"><path d="M21.8 18c0 1.1-.9 2-1.9 2H4.2c-1.1 0-1.9-.9-1.9-2V9.9c0-.5.3-.7.8-.4l7.8 4.7c.7.4 1.7.4 2.4 0L21 9.5c.4-.2.8-.1.8.4V18z"></path><path d="M21.8 6c0-1.1-.9-2-1.9-2H4.2c-1.1 0-2 .9-2 2v.4c0 .5.3 1.1.8 1.3l8.5 5.1c.2.1.7.1.9 0l8.6-5c.4-.3.8-.9.8-1.3-.1-.1-.1-.5 0-.5z"></path></svg></a><a class="ml-1" href="https://orcid.org/0000-0002-7859-8394" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="w-4 h-4 inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span></div><div class="text-sm"><div>University of British Columbia</div></div><div><span class="font-semibold text-sm">Lindsey Heagy<a class="ml-1" href="https://orcid.org/0000-0002-1551-5926" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="w-4 h-4 inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span></div><div class="text-sm"><div>University of British Columbia</div></div><div><span class="font-semibold text-sm">Douglas Oldenburg<a class="ml-1" href="https://orcid.org/0000-0002-4327-2124" target="_blank" rel="noopener noreferrer" title="ORCID (Open Researcher and Contributor ID)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="w-4 h-4 inline-block text-gray-400 hover:text-[#A9C751] -translate-y-[0.1em]"><path d="M21.8 12c0 5.4-4.4 9.8-9.8 9.8S2.2 17.4 2.2 12 6.6 2.2 12 2.2s9.8 4.4 9.8 9.8zM8.2 5.8c-.4 0-.8.3-.8.8s.3.8.8.8.8-.4.8-.8-.3-.8-.8-.8zm2.3 9.6h1.2v-6h1.8c2.3 0 3.3 1.4 3.3 3s-1.5 3-3.3 3h-3v1.1H9V8.3H7.7v8.2h5.9c3.3 0 4.5-2.2 4.5-4.1s-1.2-4.1-4.3-4.1h-3.2l-.1 7.1z"></path></svg></a></span></div><div class="text-sm"><div>University of British Columbia</div></div></div></header><div class="flex mt-2 text-sm font-light"><time dateTime="2016/08/01" class="text-spacer">August 1, 2016</time><div class="flex-none" title="DOI (Digital Object Identifier)"><a class="font-light hover:font-light no-underline hover:underline text-inherit hover:text-inherit" target="_blank" rel="noopener noreferrer" href="https://doi.org/10.1190/tle35080703.1">https://doi.org/10.1190/tle35080703.1</a></div></div></div><div class="flex items-center"><div class="flex-grow"></div></div><div id="KcgpQL83yE" class="relative group/block article-grid article-subgrid-gap col-screen"><p>The divergence is the integral of a flux through a closed surface as that enclosed volume shrinks to a point. Since we have discretized and no longer have continuous functions, we cannot fully take the limit to a point; instead, we approximate it around some (finite!) volume: <em>a cell</em>. The flux out of the surface (<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>j</mi><mo>⃗</mo></mover><mo>⋅</mo><mover accent="true"><mi>n</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{j} \cdot \vec{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.137em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span><span style="top:-3.2285em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.714em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">n</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span></span></span></span></span>) is actually how we discretized <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>j</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.137em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span><span style="top:-3.2285em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span></span> onto our mesh (i.e. <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">j</mi></mrow><annotation encoding="application/x-tex">\bf{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">j</span></span></span></span></span></span></span>) except that the face normal points out of the cell (rather than in the axes direction). After fixing the direction of the face normal (multiplying by <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>±</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\pm 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">±</span><span class="mord">1</span></span></span></span></span>), we only need to calculate the face areas and cell volume to create the discrete divergence matrix.</p></div><div id="JUP8ciGh2s" class="relative group/block article-grid article-subgrid-gap col-screen"><h1 id="building-our-operators-the-face-divergence" class="relative group"><span class="heading-text">Building our operators: the Face Divergence</span><a class="select-none no-underline px-2 font-normal transition-opacity opacity-0 group-hover:opacity-70" href="#building-our-operators-the-face-divergence" title="Link to this Section" aria-label="Link to this Section">¶</a></h1><figure id="id-22570c81" class="figure"><img style="margin:0 auto" src="/tle-finitevolume/build/divergence-c0bef8172fc19fa7f262e78596c71990.png" alt="Geometrical definition of the divergence and the discretization." data-canonical-url="../images/divergence.png"/><figcaption class="group"><p><a class="select-none no-underline mr-1 text-inherit hover:text-inherit font-semibold hover:font-semibold hover:underline" href="#id-22570c81" title="Link to this figure" aria-label="Link to this figure">Figure <!-- -->1<!-- -->:</a>Geometrical definition of the divergence and the discretization.</p></figcaption></figure></div><div id="rcrNR8yubW" class="relative group/block article-grid article-subgrid-gap col-screen"><h2 id="implementation" class="relative group"><span class="heading-text">Implementation</span><a class="select-none no-underline px-2 font-normal transition-opacity opacity-0 group-hover:opacity-70" href="#implementation" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Although this is a really helpful way to think about conceptually what is happening, the implementation of that would be a huge for loop over each cell. In practice, this would be slow, so instead, we will take advantage of linear algebra. Let&#x27;s start by looking at this in 1 dimension using the SimPEG Mesh class.</p></div><div id="uITnsc2JUP" class="relative group/block article-grid article-subgrid-gap col-screen"><div class="relative group not-prose overflow-auto rounded shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:#fff;color:black"><code class="language-python" style="white-space:pre">import numpy as np
import discretize
import matplotlib.pyplot as plt</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-3-output" data-mdast-node-type="output" data-mdast-node-id="DPEbwl87qt" class="max-w-full overflow-auto m-0 group not-prose relative text-left"></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="lS0Eiv37Q6" class="relative group/block article-grid article-subgrid-gap col-screen"><div class="relative group not-prose overflow-auto rounded shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:#fff;color:black"><code class="language-python" style="white-space:pre"># define a 1D mesh
mesh1D = discretize.TensorMesh([5]) # with 5 cells 

fig, ax = plt.subplots(1,1, figsize=(12,2))
ax.plot(mesh1D.gridN, np.zeros(mesh1D.nN),&#x27;-k&#x27;,marker=&#x27;|&#x27;,markeredgewidth=2, markersize=16)
ax.plot(mesh1D.gridCC,np.zeros(mesh1D.nC),&#x27;o&#x27;)
ax.plot(mesh1D.gridFx,np.zeros(mesh1D.nFx),&#x27;&gt;&#x27;)
ax.set_title(&#x27;1D Mesh&#x27;);</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-4-output" data-mdast-node-type="output" data-mdast-node-id="GkYQJoO1SF" class="max-w-full overflow-auto m-0 group not-prose relative text-left"><img src="/tle-finitevolume/build/4b8525d131dba995667574f2e6f1633d.png" alt="&lt;Figure size 864x144 with 1 Axes&gt;"/></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="a5Fxlu1ELt" class="relative group/block article-grid article-subgrid-gap col-screen"><div class="relative group not-prose overflow-auto rounded shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:#fff;color:black"><code class="language-python" style="white-space:pre"># and define a vector of fluxes that live on the faces of the 1D mesh
face_vec = np.r_[0., 1., 2., 2., 1., 0.]  # vector of fluxes that live on the faces of the mesh
print(&quot;The flux on the faces is {}&quot;.format(face_vec))

plt.plot(mesh1D.gridFx, face_vec, &#x27;-o&#x27;)
plt.ylim([face_vec.min()-0.5, face_vec.max()+0.5])
plt.grid(which=&#x27;both&#x27;)
plt.title(&#x27;face_vec&#x27;);</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-5-output" data-mdast-node-type="output" data-mdast-node-id="l8ALvGpmSU" class="max-w-full overflow-auto m-0 group not-prose relative text-left"><div><pre class="text-sm font-thin font-system"><code><span>The flux on the faces is [0. 1. 2. 2. 1. 0.]
</span></code></pre></div><img src="/tle-finitevolume/build/0be4c56de9218e1f29926ecfeab4ecdf.png" alt="&lt;Figure size 432x288 with 1 Axes&gt;"/></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="nRHEeyLLmQ" class="relative group/block article-grid article-subgrid-gap col-screen"><p>Over a single cell, the divergence is</p><div id="KhCc2nuUH6" class="flex group my-5"><div class="overflow-x-auto flex-grow"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">∇</mi><mo>⋅</mo><mover accent="true"><mi>j</mi><mo>⃗</mo></mover><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>=</mo><munder><mrow><mi>lim</mi><mo>⁡</mo></mrow><mrow><mi>v</mi><mo>→</mo><mo stretchy="false">{</mo><mi>p</mi><mo stretchy="false">}</mo></mrow></munder><mo>=</mo><mo>∫</mo><msub><mo>∫</mo><mrow><mi>S</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></msub><mfrac><mrow><mover accent="true"><mi>j</mi><mo>⃗</mo></mover><mo>⋅</mo><mover accent="true"><mi>n</mi><mo>⃗</mo></mover></mrow><mi>v</mi></mfrac><mi>d</mi><mi>S</mi></mrow><annotation encoding="application/x-tex">\nabla \cdot \vec{j}(p) = \lim_{v \to \{p\}} = \int \int_{S(v)} \frac{\vec{j}\cdot \vec{n}}{v} dS</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">∇</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1925em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span><span style="top:-3.2285em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.6604em;vertical-align:-0.966em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-2.309em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mrel mtight">→</span><span class="mopen mtight">{</span><span class="mord mathnormal mtight">p</span><span class="mclose mtight">}</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">lim</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.966em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.7065em;vertical-align:-1.0869em;"></span><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:-0.3869em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0869em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6195em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span><span style="top:-3.2285em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">n</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span></span></div><div class="flex-none text-right m-0 pl-2 self-center relative select-none"><a class="select-none no-underline text-inherit hover:text-inherit hover:underline" href="#KhCc2nuUH6" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->1<!-- -->)</a></div></div><p>in 1D, this collapses to taking a single difference - how much is going out of the cell vs coming in?</p><div id="bxKvPaafXv" class="flex group my-5"><div class="overflow-x-auto flex-grow"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">∇</mi><mo>⋅</mo><mover accent="true"><mi>j</mi><mo>⃗</mo></mover><mo>≈</mo><mfrac><mn>1</mn><mi>v</mi></mfrac><mo stretchy="false">(</mo><mo>−</mo><msub><mi>j</mi><mtext>left</mtext></msub><mo>+</mo><msub><mi>j</mi><mtext>right</mtext></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\nabla \cdot \vec{j} \approx \frac{1}{v}(-j_{\text{left}} + j_{\text{right}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">∇</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.137em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span><span style="top:-3.2285em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord">−</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">left</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">right</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></div><div class="flex-none text-right m-0 pl-2 self-center relative select-none"><a class="select-none no-underline text-inherit hover:text-inherit hover:underline" href="#bxKvPaafXv" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->2<!-- -->)</a></div></div><p>Since the normal of the x-face on the left side of the cell points in the positive x-direction, we multiply by -1 to get the flux going out of the cell. On the right, the normal defining the x-face is point out of the cell, so it is positive.</p></div><div id="Q5517GbRs4" class="relative group/block article-grid article-subgrid-gap col-screen"><div class="relative group not-prose overflow-auto rounded shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:#fff;color:black"><code class="language-python" style="white-space:pre"># We can take the divergence over the entire mesh by looping over each cell
div_face_vec = np.zeros(mesh1D.nC) # allocate for each cell

for i in range(mesh1D.nC):  #  loop over each cell and 
    div_face_vec[i] = 1.0/mesh1D.cell_volumes[i] * (-face_vec[i] + face_vec[i+1])

print(&quot;The face div of the 1D flux is {}&quot;.format(div_face_vec))</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-7-output" data-mdast-node-type="output" data-mdast-node-id="q67tUk9FXQ" class="max-w-full overflow-auto m-0 group not-prose relative text-left"><div><pre class="text-sm font-thin font-system"><code><span>The face div of the 1D flux is [ 5.  5.  0. -5. -5.]
</span></code></pre></div></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="Yift1RtmL9" class="relative group/block article-grid article-subgrid-gap col-screen"><p>Doing it as a for loop is easy to program for the first time,
but is difficult to see what is going on and could be slow!
Instead, we can build a face_divergence matrix (note: this is a silly way to do this!)</p></div><div id="MQTlzMWpHP" class="relative group/block article-grid article-subgrid-gap col-screen"><div class="relative group not-prose overflow-auto rounded shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:#fff;color:black"><code class="language-python" style="white-space:pre">face_divergence = np.zeros([mesh1D.nC, mesh1D.nF]) # allocate space for a face div matrix
for i in range(mesh1D.nC):  #  loop over each cell
    face_divergence[i, [i, i+1]] = 1.0/mesh1D.cell_volumes[i] * np.r_[-1,+1]

print(&quot;The 1D face div matrix for this mesh is \n{}&quot;.format(face_divergence))

assert np.all(face_divergence.dot(face_vec) == div_face_vec)  # make sure we get the same result! 

print(&quot;\nThe face div of the 1D flux is still {}!&quot;.format(div_face_vec))</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-9-output" data-mdast-node-type="output" data-mdast-node-id="JD7yNOUXSk" class="max-w-full overflow-auto m-0 group not-prose relative text-left"><div><pre class="text-sm font-thin font-system"><code><span>The 1D face div matrix for this mesh is 
[[-5.  5.  0.  0.  0.  0.]
 [ 0. -5.  5.  0.  0.  0.]
 [ 0.  0. -5.  5.  0.  0.]
 [ 0.  0.  0. -5.  5.  0.]
 [ 0.  0.  0.  0. -5.  5.]]

The face div of the 1D flux is still [ 5.  5.  0. -5. -5.]!
</span></code></pre></div></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="xbhXpyQBF6" class="relative group/block article-grid article-subgrid-gap col-screen"><p>the above is still a loop... (and python is not a fan of loops).
Also, if the mesh gets big, we are storing a lot of unnecessary zeros</p></div><div id="Y4etm7JHWN" class="relative group/block article-grid article-subgrid-gap col-screen"><div class="relative group not-prose overflow-auto rounded shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:#fff;color:black"><code class="language-python" style="white-space:pre">print(&quot;There are {nnz} zeros (too many!) that we are storing&quot;.format(nnz = np.sum(face_divergence == 0)))</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-11-output" data-mdast-node-type="output" data-mdast-node-id="lfptMhvoSO" class="max-w-full overflow-auto m-0 group not-prose relative text-left"><div><pre class="text-sm font-thin font-system"><code><span>There are 20 zeros (too many!) that we are storing
</span></code></pre></div></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="OlpWpe6CyM" class="relative group/block article-grid article-subgrid-gap col-screen"><h3 id="working-in-sparse" class="relative group"><span class="heading-text">Working in Sparse</span><a class="select-none no-underline px-2 font-normal transition-opacity opacity-0 group-hover:opacity-70" href="#working-in-sparse" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>We will use instead <em>sparse</em> matrices instead. These are in scipy and act almost the same as numpy arrays (except they default to matrix multiplication), and they don&#x27;t store all of those pesky zeros! We use <a target="_blank" href="http://docs.scipy.org/doc/scipy/reference/sparse.html" rel="noreferrer">scipy.sparse</a> to build these matrices.</p></div><div id="brHiwszhrO" class="relative group/block article-grid article-subgrid-gap col-screen"><div class="relative group not-prose overflow-auto rounded shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:#fff;color:black"><code class="language-python" style="white-space:pre">import scipy.sparse as sp
from SimPEG.utils import sdiag # we are often building sparse diagonal matrices, so we made a functio in SimPEG!</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-13-output" data-mdast-node-type="output" data-mdast-node-id="sn3NQndVzB" class="max-w-full overflow-auto m-0 group not-prose relative text-left"></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="QqfxRs0x29" class="relative group/block article-grid article-subgrid-gap col-screen"><div class="relative group not-prose overflow-auto rounded shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:#fff;color:black"><code class="language-python" style="white-space:pre"># construct differencing matrix with diagonals -1, +1
sparse_diff = sp.spdiags((np.ones((mesh1D.nC+1, 1))*[-1, 1]).T, [0, 1], mesh1D.nC, mesh1D.nC+1, format=&quot;csr&quot;)
print(&quot;the sparse differencing matrix is \n{}&quot;.format(sparse_diff.todense()))

# account for the volume
face_divergence_sparse = sdiag(1./mesh1D.cell_volumes) * sparse_diff  # account for volume 
print(&quot;\n and the face divergence is \n{}&quot;.format(face_divergence_sparse.todense()))

print(&quot;\n but now we are only storing {nnz} nonzeros&quot;.format(nnz=face_divergence_sparse.nnz))

assert np.all(face_divergence_sparse.dot(face_vec) == div_face_vec) 
print(&quot;\n and we get the same answer! {}&quot;.format(face_divergence_sparse * face_vec))</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-14-output" data-mdast-node-type="output" data-mdast-node-id="sCvESTV3qb" class="max-w-full overflow-auto m-0 group not-prose relative text-left"><div><pre class="text-sm font-thin font-system"><code><span>the sparse differencing matrix is 
[[-1.  1.  0.  0.  0.  0.]
 [ 0. -1.  1.  0.  0.  0.]
 [ 0.  0. -1.  1.  0.  0.]
 [ 0.  0.  0. -1.  1.  0.]
 [ 0.  0.  0.  0. -1.  1.]]

 and the face divergence is 
[[-5.  5.  0.  0.  0.  0.]
 [ 0. -5.  5.  0.  0.  0.]
 [ 0.  0. -5.  5.  0.  0.]
 [ 0.  0.  0. -5.  5.  0.]
 [ 0.  0.  0.  0. -5.  5.]]

 but now we are only storing 10 nonzeros

 and we get the same answer! [ 5.  5.  0. -5. -5.]
</span></code></pre></div></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="v7Chb7gmXH" class="relative group/block article-grid article-subgrid-gap col-screen"><p>In SimPEG, this is stored as the <code>face_divergence</code> property on the mesh</p></div><div id="Z7x8OzPZga" class="relative group/block article-grid article-subgrid-gap col-screen"><div class="relative group not-prose overflow-auto rounded shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:#fff;color:black"><code class="language-python" style="white-space:pre">print(mesh1D.face_divergence * face_vec) # and still gives us the same answer!</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-16-output" data-mdast-node-type="output" data-mdast-node-id="PPtoOO54ZA" class="max-w-full overflow-auto m-0 group not-prose relative text-left"><div><pre class="text-sm font-thin font-system"><code><span>[ 5.  5.  0. -5. -5.]
</span></code></pre></div></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="S3gdZaS5UD" class="relative group/block article-grid article-subgrid-gap col-screen"><h2 id="moving-to-2d" class="relative group"><span class="heading-text">Moving to 2D</span><a class="select-none no-underline px-2 font-normal transition-opacity opacity-0 group-hover:opacity-70" href="#moving-to-2d" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="mmGA7489GW" class="relative group/block article-grid article-subgrid-gap col-screen"><p>To move up in dimensionality, we build a 2D mesh which has both x and y faces</p></div><div id="bqKUeX7i1H" class="relative group/block article-grid article-subgrid-gap col-screen"><div class="relative group not-prose overflow-auto rounded shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:#fff;color:black"><code class="language-python" style="white-space:pre">mesh2D = discretize.TensorMesh([100, 80])
mesh2D.plot_grid()
plt.axis(&#x27;tight&#x27;);</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-19-output" data-mdast-node-type="output" data-mdast-node-id="p1Mqk0FPgi" class="max-w-full overflow-auto m-0 group not-prose relative text-left"><img src="/tle-finitevolume/build/c163dfe4cc4be0504849a4c3cca57f4c.png" alt="&lt;Figure size 432x288 with 1 Axes&gt;"/></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="lOfBX5e4Mb" class="relative group/block article-grid article-subgrid-gap col-screen"><p>We define 2 face functions, one in the x-direction and one in the y-direction. Here, we choose to work with sine functions as the continuous divergence is easy to compute, meaning we can test it!</p></div><div id="jm6oy7wQqe" class="relative group/block article-grid article-subgrid-gap col-screen"><div class="relative group not-prose overflow-auto rounded shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:#fff;color:black"><code class="language-python" style="white-space:pre">jx_fct = lambda x, y: -np.sin(2.*np.pi*x)
jy_fct = lambda x, y: -np.sin(2.*np.pi*y)

jx_vec = jx_fct(mesh2D.gridFx[:,0], mesh2D.gridFx[:,1])
jy_vec = jy_fct(mesh2D.gridFy[:,0], mesh2D.gridFy[:,1])

j_vec = np.r_[jx_vec, jy_vec]

print(&quot;There are {nFx} x-faces and {nFy} y-faces, so the length of the &quot;
      &quot;face function, j, is {lenj}&quot;.format(
        nFx=mesh2D.nFx, 
        nFy=mesh2D.nFy,
        lenj=len(j_vec)
     ))

plt.colorbar(mesh2D.plot_image(j_vec, &#x27;F&#x27;, view=&#x27;vec&#x27;)[0]);</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-21-output" data-mdast-node-type="output" data-mdast-node-id="RUvOBH1RwL" class="max-w-full overflow-auto m-0 group not-prose relative text-left"><div><pre class="text-sm font-thin font-system"><code><span>There are 8080 x-faces and 8100 y-faces, so the length of the face function, j, is 16180
</span></code></pre></div><img src="/tle-finitevolume/build/c6900e9dffb779002ed5c80748635ad6.png" alt="&lt;Figure size 432x288 with 2 Axes&gt;"/></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="hSKmZsv2PV" class="relative group/block article-grid article-subgrid-gap col-screen"><h3 id="but-first-what-does-the-matrix-look-like" class="relative group"><span class="heading-text">But first... what does the matrix look like?</span><a class="select-none no-underline px-2 font-normal transition-opacity opacity-0 group-hover:opacity-70" href="#but-first-what-does-the-matrix-look-like" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Now, we know that we do not want to loop over each of the cells and instead want to work with matrix-vector products. In this case, each row of the divergence matrix should pick out the two relevant faces in the x-direction and two in the y-direction (4 total).</p><p>When we unwrap our face function, we unwrap using column major ordering, so all of the x-faces are adjacent to one another, while the y-faces are separated by the number of cells in the x-direction (see <span><span><a href="/tle-finitevolume/mesh">Finite Volume Mesh</a></span><span class="exclude-from-outline absolute z-30 sm:max-w-[500px]" style="position:absolute;left:0;top:0"></span></span> for more details!).</p><p>When we plot the divergence matrix, there will be 4 &quot;diagonals&quot;,</p><ul><li>2 that are due to the x-contribution</li><li>2 that are due to the y-contribution</li></ul><p>Here, we define a small 2D mesh so that it is easier to see the matrix structure.</p></div><div id="K7hGL9P8Vz" class="relative group/block article-grid article-subgrid-gap col-screen"><div class="relative group not-prose overflow-auto rounded shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:#fff;color:black"><code class="language-python" style="white-space:pre">small_mesh2D = discretize.TensorMesh([3, 4])

print(&quot;Each y-face is {} entries apart&quot;.format(small_mesh2D.shape_cells[0]))
print(&quot;and the total number of x-faces is {}&quot;.format(small_mesh2D.nFx))
print(&quot;So in the first row of the face_divergence, we have non-zero entries at \n{}&quot;.format(
        small_mesh2D.face_divergence[0,:]))</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-23-output" data-mdast-node-type="output" data-mdast-node-id="NZ1HbBTmjX" class="max-w-full overflow-auto m-0 group not-prose relative text-left"><div><pre class="text-sm font-thin font-system"><code><span>Each y-face is 3 entries apart
and the total number of x-faces is 16
So in the first row of the face_divergence, we have non-zero entries at 
  (0, 0)	-3.0
  (0, 1)	3.0
  (0, 16)	-4.0
  (0, 19)	4.0
</span></code></pre></div></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="zD3uuLAIwc" class="relative group/block article-grid article-subgrid-gap col-screen"><p>Now, lets look at the matrix structure</p></div><div id="ArbQGR1ybW" class="relative group/block article-grid article-subgrid-gap col-screen"><div class="relative group not-prose overflow-auto rounded shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:#fff;color:black"><code class="language-python" style="white-space:pre">fig, ax = plt.subplots(1,2, figsize=(12,4))

# plot the non-zero entries in the face_divergence
ax[0].spy(small_mesh2D.face_divergence, ms=2)
ax[0].set_xlabel(&#x27;2D face_divergence&#x27;)
small_mesh2D.plot_grid(ax=ax[1])

# Number the faces and plot. (We should really add this to SimPEG... pull request anyone!?)
xys = zip(
    small_mesh2D.gridFx[:,0], 
    small_mesh2D.gridFx[:,1], 
    range(small_mesh2D.nFx)
)
for x,y,ii in xys:
    ax[1].plot(x, y, &#x27;r&gt;&#x27;)
    ax[1].text(x+0.01, y-0.02, ii, color=&#x27;r&#x27;)

xys = zip(
    small_mesh2D.gridFy[:,0], 
    small_mesh2D.gridFy[:,1], 
    range(small_mesh2D.nFy)
)
for x,y,ii in xys:
    ax[1].plot(x, y, &#x27;g^&#x27;)
    ax[1].text(x-0.02, y+0.02, ii+small_mesh2D.nFx, color=&#x27;g&#x27;)
ax[1].set_xlim((-0.1,1.1));
ax[1].set_ylim((-0.1,1.1));</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-25-output" data-mdast-node-type="output" data-mdast-node-id="cevctnMl1s" class="max-w-full overflow-auto m-0 group not-prose relative text-left"><img src="/tle-finitevolume/build/bdf6f5e3df0535ee7815a8c69ad46f4d.png" alt="&lt;Figure size 864x288 with 2 Axes&gt;"/></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="yWd9aCcphw" class="relative group/block article-grid article-subgrid-gap col-screen"><p>How did we construct the matrix? - Kronecker products.
There is a handy identity that relates the vectorized face function to its matrix form (<span><span><a href="https://en.wikipedia.org/wiki/Vectorization_(mathematics)#Compatibility_with_Kronecker_products" class="italic" target="_blank" rel="noreferrer">see Wikipedia</a></span><span class="exclude-from-outline absolute z-30 sm:max-w-[500px]" style="position:absolute;left:0;top:0"></span></span>)</p><div id="TzJLMHOqPT" class="flex group my-5"><div class="overflow-x-auto flex-grow"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>vec</mtext><mo stretchy="false">(</mo><mi>A</mi><mi>U</mi><msup><mi>B</mi><mi mathvariant="normal">⊤</mi></msup><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>B</mi><mo>⊗</mo><mi>A</mi><mo stretchy="false">)</mo><mtext>vec</mtext><mo stretchy="false">(</mo><mi>U</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{vec}(AUB^\top) = (B \otimes A) \text{vec}(U)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1491em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">vec</span></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mord text"><span class="mord">vec</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mclose">)</span></span></span></span></span></div><div class="flex-none text-right m-0 pl-2 self-center relative select-none"><a class="select-none no-underline text-inherit hover:text-inherit hover:underline" href="#TzJLMHOqPT" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->3<!-- -->)</a></div></div><p>For the x-contribution:</p><ul><li>A is our 1D differential operator ([-1, +1] on the diagonals)</li><li>U is <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>j</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">j_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> (the x-face function as a matrix)</li><li>B is just an identity, so</li></ul><div id="BblMLrHmn9" class="flex group my-5"><div class="overflow-x-auto flex-grow"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mtext>Div</mtext><mi>x</mi></msub><mtext>vec</mtext><mo stretchy="false">(</mo><msub><mi>j</mi><mi>x</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>I</mi><mo>⊗</mo><mi>D</mi><mi>i</mi><msub><mi>v</mi><mrow><mn>1</mn><mi>D</mi></mrow></msub><mo stretchy="false">)</mo><mtext>vec</mtext><mo stretchy="false">(</mo><msub><mi>j</mi><mi>x</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Div}_x \text{vec}(j_x) = (I \otimes Div_{1D}) \text{vec}(j_x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord text"><span class="mord">Div</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord text"><span class="mord">vec</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">i</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord text"><span class="mord">vec</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></div><div class="flex-none text-right m-0 pl-2 self-center relative select-none"><a class="select-none no-underline text-inherit hover:text-inherit hover:underline" href="#BblMLrHmn9" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->4<!-- -->)</a></div></div><p>For the y-contribution:</p><ul><li>A is just an identity!</li><li>U is <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>j</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">j_y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9456em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span> (the y-face function as a matrix)</li><li>B is our 1D differential operator ([-1, +1] on the diagonals), so</li></ul><div id="LpRwDYoEbH" class="flex group my-5"><div class="overflow-x-auto flex-grow"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mtext>Div</mtext><mi>y</mi></msub><mtext>vec</mtext><mo stretchy="false">(</mo><msub><mi>j</mi><mi>y</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><msub><mtext>Div</mtext><mrow><mn>1</mn><mi>D</mi></mrow></msub><mo>⊗</mo><mi>I</mi><mo stretchy="false">)</mo><mtext>vec</mtext><mo stretchy="false">(</mo><msub><mi>j</mi><mi>y</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Div}_y \text{vec}(j_y) = (\text{Div}_{1D} \otimes I) \text{vec}(j_y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord text"><span class="mord">Div</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord text"><span class="mord">vec</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">Div</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose">)</span><span class="mord text"><span class="mord">vec</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></div><div class="flex-none text-right m-0 pl-2 self-center relative select-none"><a class="select-none no-underline text-inherit hover:text-inherit hover:underline" href="#LpRwDYoEbH" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->5<!-- -->)</a></div></div><div id="JZAl57s5jB" class="flex group my-5"><div class="overflow-x-auto flex-grow"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Div</mtext><mo>⋅</mo><mi>j</mi><mo>=</mo><msub><mtext>Div</mtext><mi>x</mi></msub><mo>⋅</mo><msub><mi>j</mi><mi>x</mi></msub><mo>+</mo><msub><mtext>Div</mtext><mi>y</mi></msub><mo>⋅</mo><msub><mi>j</mi><mi>y</mi></msub><mo>=</mo><mo stretchy="false">[</mo><msub><mtext>Div</mtext><mi>x</mi></msub><mo separator="true">,</mo><msub><mtext>Div</mtext><mi>y</mi></msub><mo stretchy="false">]</mo><mo>⋅</mo><mo stretchy="false">[</mo><msub><mi>j</mi><mi>x</mi></msub><mo separator="true">;</mo><msub><mi>j</mi><mi>y</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\text{Div} \cdot j  = \text{Div}_x \cdot j_x + \text{Div}_y \cdot j_y = [\text{Div}_x, \text{Div}_y] \cdot [j_x; j_y]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">Div</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord">Div</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord text"><span class="mord">Div</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9456em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mopen">[</span><span class="mord"><span class="mord text"><span class="mord">Div</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord text"><span class="mord">Div</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span></div><div class="flex-none text-right m-0 pl-2 self-center relative select-none"><a class="select-none no-underline text-inherit hover:text-inherit hover:underline" href="#JZAl57s5jB" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->6<!-- -->)</a></div></div><p>And <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span></span> is just <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi>j</mi><mi>x</mi></msub><mo separator="true">;</mo><msub><mi>j</mi><mi>y</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[j_x; j_y]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span>, so we can horizontally stack <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>Div</mtext><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">\text{Div}_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord">Div</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>, <span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>Div</mtext><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">\text{Div}_y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord text"><span class="mord">Div</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span></p><div id="UiF9t9qD7A" class="flex group my-5"><div class="overflow-x-auto flex-grow"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Div</mtext><mo>=</mo><mo stretchy="false">[</mo><msub><mtext>Div</mtext><mi>x</mi></msub><mo separator="true">,</mo><msub><mtext>Div</mtext><mi>y</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\text{Div} = [\text{Div}_x, \text{Div}_y]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">Div</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mopen">[</span><span class="mord"><span class="mord text"><span class="mord">Div</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord text"><span class="mord">Div</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span></div><div class="flex-none text-right m-0 pl-2 self-center relative select-none"><a class="select-none no-underline text-inherit hover:text-inherit hover:underline" href="#UiF9t9qD7A" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->7<!-- -->)</a></div></div><p>You can check this out in the SimPEG docs by running <strong>small_mesh2D.face_divergence??</strong></p></div><div id="vCiAQ56HRG" class="relative group/block article-grid article-subgrid-gap col-screen"><div class="relative group not-prose overflow-auto rounded shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:#fff;color:black"><code class="language-python" style="white-space:pre"># check out the code!
small_mesh2D.face_divergence??</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-27-output" data-mdast-node-type="output" data-mdast-node-id="qf8m7ywPIm" class="max-w-full overflow-auto m-0 group not-prose relative text-left"><div><pre class="text-sm font-thin font-system"><code><span style="color:rgb(187, 0, 0)">Type:</span><span>        property
</span><span style="color:rgb(187, 0, 0)">String form:</span><span> &lt;property object at 0x7fd5e03cb450&gt;
</span><span style="color:rgb(187, 0, 0)">Source:</span><span>     
</span><span style="color:rgb(187, 0, 0)"># small_mesh2D.face_divergence.fget</span><span>
</span><span style="color:rgb(0, 0, 187)">@</span><span>property</span><span>
</span><span style="color:rgb(0, 187, 0)">def</span><span> </span><span>face_divergence</span><span style="color:rgb(0, 0, 187)">(</span><span>self</span><span style="color:rgb(0, 0, 187)">)</span><span style="color:rgb(0, 0, 187)">:</span><span>
</span><span>    </span><span style="color:rgb(0, 187, 0)">if</span><span> </span><span>getattr</span><span style="color:rgb(0, 0, 187)">(</span><span>self</span><span style="color:rgb(0, 0, 187)">,</span><span> </span><span style="color:rgb(0, 0, 187)">&quot;_face_divergence&quot;</span><span style="color:rgb(0, 0, 187)">,</span><span> </span><span style="color:rgb(0, 187, 0)">None</span><span style="color:rgb(0, 0, 187)">)</span><span> </span><span style="color:rgb(0, 187, 0)">is</span><span> </span><span style="color:rgb(0, 187, 0)">None</span><span style="color:rgb(0, 0, 187)">:</span><span>
</span><span>        </span><span style="color:rgb(187, 0, 0)"># Get the stencil of +1, -1&#x27;s</span><span>
</span><span>        </span><span>D</span><span> </span><span style="color:rgb(0, 0, 187)">=</span><span> </span><span>self</span><span style="color:rgb(0, 0, 187)">.</span><span>_face_divergence_stencil</span><span>
</span><span>        </span><span style="color:rgb(187, 0, 0)"># Compute areas of cell faces &amp; volumes</span><span>
</span><span>        </span><span>S</span><span> </span><span style="color:rgb(0, 0, 187)">=</span><span> </span><span>self</span><span style="color:rgb(0, 0, 187)">.</span><span>face_areas</span><span>
</span><span>        </span><span>V</span><span> </span><span style="color:rgb(0, 0, 187)">=</span><span> </span><span>self</span><span style="color:rgb(0, 0, 187)">.</span><span>cell_volumes</span><span>
</span><span>        </span><span>self</span><span style="color:rgb(0, 0, 187)">.</span><span>_face_divergence</span><span> </span><span style="color:rgb(0, 0, 187)">=</span><span> </span><span>sdiag</span><span style="color:rgb(0, 0, 187)">(</span><span style="color:rgb(0, 187, 187)">1</span><span> </span><span style="color:rgb(0, 0, 187)">/</span><span> </span><span>V</span><span style="color:rgb(0, 0, 187)">)</span><span> </span><span style="color:rgb(0, 0, 187)">*</span><span> </span><span>D</span><span> </span><span style="color:rgb(0, 0, 187)">*</span><span> </span><span>sdiag</span><span style="color:rgb(0, 0, 187)">(</span><span>S</span><span style="color:rgb(0, 0, 187)">)</span><span>
</span><span>    </span><span style="color:rgb(0, 187, 0)">return</span><span> </span><span>self</span><span style="color:rgb(0, 0, 187)">.</span><span>_face_divergence</span><span>
</span></code></pre></div></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="psSMB4tAx7" class="relative group/block article-grid article-subgrid-gap col-screen"><p>Now that we have a discrete divergence, lets check out the divergence of  the face function we defined earlier.</p></div><div id="n1wD7BdpzK" class="relative group/block article-grid article-subgrid-gap col-screen"><div class="relative group not-prose overflow-auto rounded shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:#fff;color:black"><code class="language-python" style="white-space:pre">Div_j = mesh2D.face_divergence * j_vec

fig, ax = plt.subplots(1,2, figsize=(8,4))
plt.colorbar(mesh2D.plot_image(j_vec, &#x27;F&#x27;, view=&#x27;vec&#x27;, ax=ax[0])[0],ax=ax[0])
plt.colorbar(mesh2D.plot_image(Div_j, ax=ax[1])[0],ax=ax[1])

ax[0].set_title(&#x27;j&#x27;)
ax[1].set_title(&#x27;Div j&#x27;)
plt.tight_layout()</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-29-output" data-mdast-node-type="output" data-mdast-node-id="H37x0WjuvE" class="max-w-full overflow-auto m-0 group not-prose relative text-left"><div><pre class="text-sm font-thin font-system"><code><span>/opt/anaconda3/envs/simpeg/lib/python3.8/site-packages/discretize/base/base_tensor_mesh.py:785: FutureWarning: The zerosOutside keyword argument has been deprecated, please use zeros_outside. This will be removed in discretize 1.0.0
  warnings.warn(
</span></code></pre></div><img src="/tle-finitevolume/build/7f3fe3cc121ed536dcb954287558ae74.png" alt="&lt;Figure size 576x288 with 4 Axes&gt;"/></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="CHeROSGwBt" class="relative group/block article-grid article-subgrid-gap col-screen"><h3 id="are-we-right" class="relative group"><span class="heading-text">Are we right??</span><a class="select-none no-underline px-2 font-normal transition-opacity opacity-0 group-hover:opacity-70" href="#are-we-right" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Since we chose a simple function,</p><div id="TwfWuH9Xyn" class="flex group my-5"><div class="overflow-x-auto flex-grow"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mi>j</mi><mo>⃗</mo></mover><mo>=</mo><mo>−</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><mi>x</mi><mo stretchy="false">)</mo><mover accent="true"><mi>x</mi><mo>^</mo></mover><mo>−</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><mi>y</mi><mo stretchy="false">)</mo><mover accent="true"><mi>y</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\vec{j} = - \sin(2\pi x) \hat{x} - \sin(2\pi y) \hat{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.137em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span><span style="top:-3.2285em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span></span></span></span></span></div><div class="flex-none text-right m-0 pl-2 self-center relative select-none"><a class="select-none no-underline text-inherit hover:text-inherit hover:underline" href="#TwfWuH9Xyn" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->8<!-- -->)</a></div></div><p>we know the continuous divergence...</p><div id="pDIjOREdQs" class="flex group my-5"><div class="overflow-x-auto flex-grow"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">∇</mi><mo>⋅</mo><mover accent="true"><mi>j</mi><mo>⃗</mo></mover><mo>=</mo><mo>−</mo><mn>2</mn><mi>π</mi><mo stretchy="false">(</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><mi>y</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\nabla \cdot \vec{j} = -2\pi (\cos(2\pi x) + \cos(2\pi y))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">∇</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.137em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span><span style="top:-3.2285em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mopen">(</span><span class="mop">cos</span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">))</span></span></span></span></span></div><div class="flex-none text-right m-0 pl-2 self-center relative select-none"><a class="select-none no-underline text-inherit hover:text-inherit hover:underline" href="#pDIjOREdQs" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->9<!-- -->)</a></div></div><p>So lets plot it and take a look</p></div><div id="vuAKwPPmYo" class="relative group/block article-grid article-subgrid-gap col-screen"><div class="relative group not-prose overflow-auto rounded shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:#fff;color:black"><code class="language-python" style="white-space:pre"># from earlier
# jx_fct = lambda x, y: -np.sin(2*np.pi*x)
# jy_fct = lambda x, y: -np.sin(2*np.pi*y)

sol = lambda x, y: -2*np.pi*(np.cos(2*np.pi*x)+np.cos(2*np.pi*y))

cont_div_j = sol(mesh2D.gridCC[:,0], mesh2D.gridCC[:,1])

Div_j = mesh2D.face_divergence * j_vec

fig, ax = plt.subplots(1,2, figsize=(8,4))
plt.colorbar(mesh2D.plot_image(Div_j, ax=ax[0])[0],ax=ax[0])
plt.colorbar(mesh2D.plot_image(cont_div_j, ax=ax[1])[0],ax=ax[1])

ax[0].set_title(&#x27;Discrete Div j&#x27;)
ax[1].set_title(&#x27;Continuous Div j&#x27;)
plt.tight_layout()</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-31-output" data-mdast-node-type="output" data-mdast-node-id="a0z9MdcqFG" class="max-w-full overflow-auto m-0 group not-prose relative text-left"><img src="/tle-finitevolume/build/7c3e9a987e08a8b6e0e067640246fa91.png" alt="&lt;Figure size 576x288 with 4 Axes&gt;"/></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="exYUwrJRZb" class="relative group/block article-grid article-subgrid-gap col-screen"><p>Those look similar! 🚀</p></div><div id="n4GRXu7GDP" class="relative group/block article-grid article-subgrid-gap col-screen"><h3 id="order-test" class="relative group"><span class="heading-text">Order Test</span><a class="select-none no-underline px-2 font-normal transition-opacity opacity-0 group-hover:opacity-70" href="#order-test" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>We can do better than just an eye-ball comparison - since we are using a a staggered grid, with centered differences, the discretization should be second-order (<span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">O</mi><mo stretchy="false">(</mo><msup><mi>h</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{O}(h^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>). That is, as we refine the mesh, our approximation of the divergence should improve by a factor of 2.</p><p>SimPEG has a number of testing functions for
<a target="_blank" href="http://docs.simpeg.xyz/content/api_core/api_Tests.html#SimPEG.Tests.checkDerivative" rel="noreferrer">derivatives</a>
and
<a target="_blank" href="http://docs.simpeg.xyz/content/api_core/api_Tests.html#SimPEG.Tests.OrderTest" rel="noreferrer">order of convergence</a>
to make our lives easier!</p></div><div id="giF2F7xESV" class="relative group/block article-grid article-subgrid-gap col-screen"><div class="relative group not-prose overflow-auto rounded shadow-md dark:shadow-2xl dark:shadow-neutral-900 my-5 text-sm border border-l-4 border-l-blue-400 border-gray-200 dark:border-l-blue-400 dark:border-gray-800"><pre style="display:block;overflow-x:auto;padding:0.8rem;background:#fff;color:black"><code class="language-python" style="white-space:pre">import unittest
from discretize.tests import OrderTest

jx = lambda x, y: -np.sin(2*np.pi*x)
jy = lambda x, y: -np.sin(2*np.pi*y)
sol = lambda x, y: -2*np.pi*(np.cos(2*np.pi*x)+np.cos(2*np.pi*y))

class Testify(OrderTest):
    meshDimension = 2
    
    def getError(self):
        j = np.r_[jx(self.M.gridFx[:,0], self.M.gridFx[:,1]),
                  jy(self.M.gridFy[:,0], self.M.gridFy[:,1])]
        num = self.M.face_divergence * j # numeric answer
        ans = sol(self.M.gridCC[:,0], self.M.gridCC[:,1]) # note M is a 2D mesh
        return np.linalg.norm((num - ans), np.inf) # look at the infinity norm 
                                                   # (as we refine the mesh, the number of cells 
                                                   # changes, so need to be careful if using a 2-norm)
    def test_order(self):
        self.orderTest()

# This just runs the unittest:
suite = unittest.TestLoader().loadTestsFromTestCase( Testify )
unittest.TextTestRunner().run( suite );</code></pre><div class="absolute hidden top-1 right-1 group-hover:block"><button title="Copy to Clipboard" class="inline-flex items-center opacity-60 hover:opacity-100 active:opacity-40 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-500 border-blue-500" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="w-[24px] h-[24px]"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path></svg></button></div></div><figure id="nb-cell-34-output" data-mdast-node-type="output" data-mdast-node-id="yFsQaB22G7" class="max-w-full overflow-auto m-0 group not-prose relative text-left"><div><pre class="text-sm font-thin font-system"><code><span>/opt/anaconda3/envs/simpeg/lib/python3.8/site-packages/discretize/utils/code_utils.py:247: FutureWarning: setupMesh has been deprecated, please use setup_mesh. It will be removed in version 1.0.0 of discretize.
  warnings.warn(
.</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>
uniformTensorMesh:  Order Test
_____________________________________________
   h  |    error    | e(i-1)/e(i) |  order
~~~~~~|~~~~~~~~~~~~~|~~~~~~~~~~~~~|~~~~~~~~~~
   4  |  8.86e-01   |
   8  |  2.96e-01   |   2.9914    |  1.5808
  16  |  7.90e-02   |   3.7462    |  1.9054
  32  |  2.01e-02   |   3.9364    |  1.9769
---------------------------------------------
Happy little convergence test!

</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>
----------------------------------------------------------------------
Ran 1 test in 0.010s

OK
</span></code></pre></div></figure><div class="hidden group-hover/block:flex md:flex-col absolute -top-[28px] md:top-0 right-0 md:-right-[28px] mt-8"></div></div><div id="ChjFjkJHGq" class="relative group/block article-grid article-subgrid-gap col-screen"><p>Looks good - Second order convergence!</p></div><div id="e7zarC5iyC" class="relative group/block article-grid article-subgrid-gap col-screen"><p><strong>Next up...</strong></p><p>In the <span><span><a href="/tle-finitevolume/weak-formulation">next notebook</a></span><span class="exclude-from-outline absolute z-30 sm:max-w-[500px]" style="position:absolute;left:0;top:0"></span></span>, we will explore how to use the weak formulation to discretize the DC equations.</p></div><div class="flex space-x-4 my-10"></div><nav></nav></main></article><script>((d,f)=>{if(!window.history.state||!window.history.state.key){let m=Math.random().toString(32).slice(2);window.history.replaceState({key:m},"")}try{let _=JSON.parse(sessionStorage.getItem(d)||"{}")[f||window.history.state.key];typeof _=="number"&&window.scrollTo(0,_)}catch(m){console.error(m),sessionStorage.removeItem(d)}})("positions", null)</script><link rel="modulepreload" href="/tle-finitevolume/build/manifest-2E91AB14.js"/><link rel="modulepreload" href="/tle-finitevolume/build/entry.client-34LOLN62.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-STCNRLUL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RAQ24GF6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-GATM77RM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3TZSZRI6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KDXZNC3T.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-A22JXTHK.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ZSIJYUGB.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CBNYJD3L.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DVCLQKI7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WNJSKYG3.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PJMGMBEF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-K4RCRPLV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MRIGPM2R.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-22THSYFL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MMC7DYY7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QCCLA5MS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-GKEX5P47.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PEZFBKC5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-GTDPPE5F.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WJAI73GQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-K3TZNCZM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LDZM4ZQD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EOJFZMT2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RHXQDGRU.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SGOFNTDL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JRSC6QBF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5ZPDX7PC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-I6CDKV3U.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-2SVF2XVU.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-YEQXTS7N.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-6Q25IZ5I.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LAXY2Z7G.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-STDT2SES.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-YPFJUWOK.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RNKF7ZYK.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Y3YNFCGX.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-2LSBMUX5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3WL2G4JH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-INCGFJJF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LAPR5CPM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WSGNN42Q.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LU3YBBX7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IO4TB7PQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TSDPYKGF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-OMZ63QZB.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ZBISOK7U.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-BFBSQVLM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-6NCTOO7H.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-35WHJMWC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-YSHWLRE5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-AFEAABZJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-H7ARGAD6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-NBX3MV4B.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LMIZNBNM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DIMQGE5G.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IAVLWJTK.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-HDQQIMKH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PPT3ZRQO.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DNTJS3HB.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-S4ASJ6WF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RWHSI6SS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TNC2IPU2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-HFKBYAKP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PE33EVMV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FHO2R5HQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7C63K5ZS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WLUE5D5N.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VGRADKJH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-OWFODDTP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IW66K23Q.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KYNTYNCC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PI75YC4W.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EL6N5MSU.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QBHOJFHW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4BX5SM52.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QWH7N7D5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-NHIRP2UW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-6KSP4KLH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VBEDDNKJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-B2HWZEB2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-I7JFPAYF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FW7ZENTV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IJHX74IM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-X4KFDT3J.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-I34TMOY6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-242IW4WY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EK6E5JAG.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-65GQPTAP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-OVRHUZZH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5I37TIZC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3N5EHFNM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-BIWPEXNE.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IBCYTMNP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-POO5RHVM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-OF6DTJRZ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QR7ET4LW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7ZRRD45L.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TL55OYNZ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SCCI2NO7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EPJQPYA2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-L6C7BXKA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QDETX3JT.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RH4EV35E.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5KHJHUOA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EQFQMUSV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-NPAKE72N.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PHOSHZFJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Y3PIPDQ7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-XKEJZ5C2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JQBCSWND.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ZUMT74W6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LFWDUXHM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-OXKZZVGI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CTZWZHUQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-D6SYBG5Y.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3GF2HD7O.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7JHMMAVX.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-UQ6TCMQE.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ZWPTSOKS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RGMPOWKL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FO7QNBMJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5OAXYVES.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ULBOFEUJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-BGY2PCTD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RLEXZ676.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5XGARS2D.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EOG3HBB2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-UDALPQXN.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CMQNPUMD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ZTHCIUYW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-HD4XYXOQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-6REJDOM5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-P6CCROY3.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JPIL6CZA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WUGZA3GJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-R6VMYYLS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FIUXFW2P.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-XYG5SNFW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5D2C2ZDA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SW6XFMQD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5CYLIJGM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3Q2KBA6X.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TPIWPMHX.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Z4TDC2YQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LA2YA4XX.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JIVCDPO2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-35IRQLNA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5K545OGO.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3L3Z3F6X.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-AD4PBXM6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-XKDLTTDF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-2PWAQOA6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VJ3VAB3H.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CYAOAKX5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-AAY5LSVK.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-B23JCRYQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MPIN2NQF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LD53Z7OK.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FBK434DZ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-GGT4H2PL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Z7P6TLAI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TH6IRUKI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MKLGTMZG.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-X4YOA4FP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-GQ5F3JOI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-X7APFMBA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QGQCU7Z5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-XWH5YON6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-L5HMB5WH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FLGTY6ML.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MYHK3VFC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3OOET6B3.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7NDTMEBY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JTFUE3TU.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-NPNO47VJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CEJPUMDN.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3UCYOZRC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QW3YGU7K.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4IDUKFNS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-BHAGSTTY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-NVGCL4ST.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CAPUTC5J.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FCUGECQA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-T5LEH3GP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QYFXPV5P.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ICZ2IBMN.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-2LGL2A76.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JW5HIPWL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WPIFJFBP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EI7MM2ZM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CPP55WXY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CMHA6RZZ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-737BPBEV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3A5424CL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JBWUJHML.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5EU2WZ4K.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-U4JP6WYN.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-6VMC3C6H.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DPD34KFT.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-P3HINRLA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-OEMWIF5I.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3ICMK33L.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-UVDURX6W.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EW2JJMFI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3IRPCF34.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MTWD2M7E.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-H7DOBPSH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FBVPMWWA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QMWX2HBM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JECYL6B6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7VXWSOTE.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-OFRX2LO7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IZ74E2PR.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LYZU5FLL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4QSJGUBC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-6NQHZQ5K.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3QPZ4I6A.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ID6MLM44.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ONF5ZEGX.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DCFHNYE2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WJC2TMC3.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Z4DXDTUR.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QJ653JTH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JB3B6A6E.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-GSHJN3MF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FEKTRG3M.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MPEWCBTI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-M6K2JCPM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FOUTP5HW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-OTRPIZML.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IKIZ2PYB.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VBLH3B7N.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-E724CIFR.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-F7RAUHZW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-577UU5TB.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-H5PDIPNZ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4R3JC4QW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-GNWNFVG7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JDKLS2ST.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RG2LYK5A.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7LUKHWIG.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KMNLZGTB.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-2KDE3HUQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-T7CNODMI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-UDP4Q2IW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SJW5G5ZV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-HGNYMY75.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5N53WRE2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IMXUHBPL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3ZCVCFNE.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-BN7JUA2J.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ILC5MFOH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WE62QWZJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TJKSLYFR.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KHHVIB5E.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MIEZSYDG.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DGWOMBJL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Q6WM2H72.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ZIMHSXAS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SUG474HR.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PCOW4WWS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CIYXD62H.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MDFBER5W.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-GX3CRW3F.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DGXGRRYX.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SSPVJ6IS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-HSSYMLB3.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-K4SMJ7WJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5GXFTTWI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PTBOR72Y.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LFO3DTKE.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-73RIUVPQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-G3WMP5TT.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Q7I77NW3.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RBSMNSRG.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TUTQC6ID.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5UGH6N65.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PZ433YLG.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SE6PSEOU.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EGAOT2MX.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-J4DVQC56.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-2HJQA6UR.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-AGF2AH6W.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-NQTTBETD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-HBD5TQ2W.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-BACRIHFA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-243ERP6K.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KVJXK4XS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4N3NM4UF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KEHCZZC6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IUFDJPNC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RHRSIKTF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LFJ5TAP5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5PKXRQNT.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IOD7UDJW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-UWNWXDHD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KKTDCDBD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EVHKG4ID.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-HZZT2QMW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SW2DO3HC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-UND5NCGU.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-N7BF3QMQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7DGHQJFM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-27JJJT5J.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7QILXESG.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QCI56KOS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IXXNFT7F.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FWUCSQCC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IRAY7AJW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DFU4VUYA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-AHRRAAFU.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FESZSXW4.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3VZJTP67.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-BE4WR3U4.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DFWGE7D2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7LKNMJOX.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VBOASNGM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-NVJX6L3I.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MUFDH4AZ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PCR5CMRA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KWT6S4ZV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5EGBKIHD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4BM4EP7Z.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-2K3JD7CH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-RYSRWBFG.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-R76BX44Y.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EK6V5TFM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WIU3N2FZ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EUE65WU3.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4UPEPJRI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3HC64KIS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-E7XN57I6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VD4LJQH2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-67TXQYDP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-BEK3ZAYS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ZUMZ7YJB.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KQ7IVWBF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-C7ZQ7QWM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EFKCDIR4.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Y2A4AEYV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-UDIA6SFH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DXS5MIF7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CU3ZAA3J.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DLV26HDB.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-YWKBZMKK.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IXBCY7Z5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-XPKNF2GY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EXKS2N3U.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4CEEQ2WE.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-NNZYS7WL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3PWB3N72.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KDJ5AN5I.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IUKUVFD7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VI4FDREV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DRI5LEAT.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PXNDIUUW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WCSHVD66.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-44BZ4THS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KB6HQ3EV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-2IYZCRU7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ZC7GDBHQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MCW2X7P7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DBUVFRIJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-6GVV3CEI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-2ABAEOW6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3FPQWUCY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QOWH7JTY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4UQMVVJD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-57KO4L4Z.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PFDMZH4N.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JEBEDPBU.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3UFOYY7A.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DIUUOJG4.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-6KM7QLBA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QPEXGL65.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QOOYPE7X.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TYPZLHDR.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-NA5I5QSJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SVTVILDP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-NQOKPCQW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LBLFO2HD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-YBORSE7I.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-BNGMH6DJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TZEP4DU4.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WCZT4D6O.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EPZEB247.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-V36SVQOY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4NAMW6WM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Q7C3UT7I.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4NBANXMK.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-B6HZCSXG.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KYUAMBOV.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QXS4MDGE.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-XO4MHCV5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-K23AXNVS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MNH6Q45X.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KHSXAZVY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-I5HZ6ZYD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DD3EWMVQ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-K3DINP7C.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SZCYG5DL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-G6K2WDLD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TT6A6KRU.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FFELNGZL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-XCR3PWHN.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KESEDRO7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3DPXFF7X.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-P2KWQRNH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-HE2JMOB7.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7DAB7OQH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7BNPYNPF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-F6PJ5VKY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VEB4DE47.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3Z7Y2QVW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MJ2VZ5KW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-M5AYHQJ4.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EFVWKFVT.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ICIFS5EX.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ZOSHAV3A.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-5RZV4TWL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4KTLW4ZP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-T5E3KDVE.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-G4EWYFK2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ERF5MWXM.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CFFS7EVD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QUDMGLFB.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-7P32TNPW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-JNYJ45RP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QINAB234.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-XXXALNY2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-74EWDK7I.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Q4IILUOS.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-23WVLS7Q.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TL662EAH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MTQ2LD43.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-H6F4WG4L.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3WQU5EXB.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LDELMZ4A.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WDVSZKGW.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-YBLFDHYD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-AGHHASP5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VAFNTHPE.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-GSQMQQYC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MWV6DYON.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-DAFCVUAF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WXZLAVXJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4VFJTBR6.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-FKLMBUGG.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-Q7PP7CGY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-56EHYZPP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-AJUK5WL4.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-XCY37IJJ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-4JJCRQLI.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-6KRBY7ML.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-QGRYECQP.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-A5LRZ46O.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TFVFGSAC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CUXHMWVY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VLWCT2QF.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-6AZYACTL.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3K4C4EPY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-BMYASLMN.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-WYLJH6RZ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-ZJYHOD4M.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-STYFKBEC.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-K6CGA3JU.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-26ODLRKY.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-GQVYEF7L.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-O2ZMCC5B.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-EGDTKE4G.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TZM7LRM3.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-CUPAVG4I.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-PBNVY5X4.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-SHFEZ3LD.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-U4F6TERZ.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-LIGNPJJR.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-KIIZZSG2.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-UV53JTY3.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-VB6MEWRX.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-32OQE7MH.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-3VPM6F4D.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-P34ZT5AA.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-MTBRW4O3.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-TTGWMB65.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IWHXKN3M.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-2LPZT57S.js"/><link rel="modulepreload" href="/tle-finitevolume/build/root-3VTM3HH5.js"/><link rel="modulepreload" href="/tle-finitevolume/build/_shared/chunk-IPZA66IR.js"/><link rel="modulepreload" href="/tle-finitevolume/build/routes/$-OY73AADE.js"/><script>window.__remixContext = {"state":{"loaderData":{"root":{"theme":"light","config":{"title":"Pixels and Their Neighbours: Finite Volume","logo_text":"Pixels and their neighbours","myst":"v1","nav":[],"actions":[{"title":"Download PDF","filename":"cockett-heagy-oldenburg-2016.pdf","url":"/tle-finitevolume/build/cockett-heagy-oldenb-c6bbd4ad57b7a4be56ea2682a7fd4a03.pdf","static":true}],"projects":[{"date":"2016/08/01","doi":"10.1190/tle35080703.1","open_access":true,"license":{"content":{"id":"CC-BY-SA-3.0","name":"Creative Commons Attribution Share Alike 3.0 Unported","CC":true,"url":"https://creativecommons.org/licenses/by-sa/3.0/"},"code":{"id":"MIT","name":"MIT License","osi":true,"free":true,"url":"https://opensource.org/licenses/MIT"}},"subject":"tutorial","exports":[{"format":"pdf","article":"paper.md"},{"format":"docx","article":"paper.md"},{"format":"xml","article":"paper.md","sub_articles":["notebooks/overview.ipynb","notebooks/mesh.ipynb","notebooks/divergence.ipynb","notebooks/weak-formulation.ipynb","notebooks/all-together-now.ipynb"]}],"title":"Pixels and Their Neighbours","subtitle":"Methods for Finite Volume Simulations","authors":[{"name":"Rowan Cockett","orcid":"0000-0002-7859-8394","corresponding":true,"email":"rowan@curvenote.com","affiliations":["University of British Columbia"]},{"name":"Lindsey Heagy","orcid":"0000-0002-1551-5926","affiliations":["University of British Columbia"]},{"name":"Douglas Oldenburg","orcid":"0000-0002-4327-2124","affiliations":["University of British Columbia"]}],"venue":{"title":"The Leading Edge"},"github":"https://github.com/simpeg/tle-finitevolume","bibliography":[],"index":"paper","pages":[{"slug":"index","title":"Getting Started","description":"","date":"2016/08/01","thumbnail":"/tle-finitevolume/build/dc-setup-613da4e1507fa3e37aae2ebfe06df13a.png","thumbnailOptimized":"","tags":[],"level":1},{"slug":"mesh","title":"Finite Volume Mesh","description":"","date":"2016/08/01","thumbnail":"/tle-finitevolume/build/mesh-e776e801e0f099683f149fbe1d1c92f5.png","thumbnailOptimized":"","tags":[],"level":1},{"slug":"divergence","title":"Divergence Operator","description":"","date":"2016/08/01","thumbnail":"/tle-finitevolume/build/divergence-c0bef8172fc19fa7f262e78596c71990.png","thumbnailOptimized":"","tags":[],"level":1},{"slug":"weak-formulation","title":"Weak Formulation","description":"","date":"2016/08/01","thumbnail":"/tle-finitevolume/build/weak-formulation-4b2a17d0b5767005d07fdb3714e0aa80.png","thumbnailOptimized":"","tags":[],"level":1},{"slug":"all-together-now","title":"All Together Now","description":"We will use our knowledge of the mesh and the divergence implementations to bring the DC resistivity equations together and show some pretty figures.","date":"2016/08/01","thumbnail":"/tle-finitevolume/build/all-together-now-b0ea50a11da3eab8c7ff01e4d07eae45.png","thumbnailOptimized":"","tags":[],"level":1}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/tle-finitevolume"},"routes/$":{"kind":"Notebook","sha256":"9e1b0df1d19263f10d5c92a8d60bcf3cfa0ec9875cc554a05fdc98f17378d9f1","slug":"divergence","dependencies":[],"frontmatter":{"title":"Divergence Operator","authors":[{"name":"Rowan Cockett","orcid":"0000-0002-7859-8394","corresponding":true,"email":"rowan@curvenote.com","affiliations":["University of British Columbia"]},{"name":"Lindsey Heagy","orcid":"0000-0002-1551-5926","affiliations":["University of British Columbia"]},{"name":"Douglas Oldenburg","orcid":"0000-0002-4327-2124","affiliations":["University of British Columbia"]}],"date":"2016/08/01","doi":"10.1190/tle35080703.1","open_access":true,"license":{"content":{"id":"CC-BY-SA-3.0","name":"Creative Commons Attribution Share Alike 3.0 Unported","CC":true,"url":"https://creativecommons.org/licenses/by-sa/3.0/"},"code":{"id":"MIT","name":"MIT License","osi":true,"free":true,"url":"https://opensource.org/licenses/MIT"}},"github":"https://github.com/simpeg/tle-finitevolume","subject":"tutorial","venue":{"title":"The Leading Edge"},"thumbnail":"/tle-finitevolume/build/divergence-c0bef8172fc19fa7f262e78596c71990.png","exports":[{"format":"ipynb","filename":"divergence.ipynb","url":"/tle-finitevolume/build/divergence-c6ddd3c3a4c44e1068ea7d2ce136c6e8.ipynb"}]},"mdast":{"type":"root","children":[{"type":"block","position":{"start":{"line":0,"column":0},"end":{"line":1,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":0},"end":{"line":5,"column":0}},"children":[{"type":"text","value":"The divergence is the integral of a flux through a closed surface as that enclosed volume shrinks to a point. Since we have discretized and no longer have continuous functions, we cannot fully take the limit to a point; instead, we approximate it around some (finite!) volume: ","key":"PyI0Qt6KZ4"},{"type":"emphasis","children":[{"type":"text","value":"a cell","key":"Dhq3SW8eOu"}],"key":"Ek4Cljv3R3"},{"type":"text","value":". The flux out of the surface (","key":"T2bH5RipOb"},{"type":"inlineMath","value":"\\vec{j} \\cdot \\vec{n}","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmo\u003e⃗\u003c/mo\u003e\u003c/mover\u003e\u003cmo\u003e⋅\u003c/mo\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmo\u003e⃗\u003c/mo\u003e\u003c/mover\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\vec{j} \\cdot \\vec{n}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.137em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9425em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.2285em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.2355em;\"\u003e\u003cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'\u003e\u003cpath d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1944em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⋅\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.714em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.714em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.2355em;\"\u003e\u003cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'\u003e\u003cpath d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"HwDoxApNPv"},{"type":"text","value":") is actually how we discretized ","key":"mXIZlBx9Be"},{"type":"inlineMath","value":"\\vec{j}","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmo\u003e⃗\u003c/mo\u003e\u003c/mover\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\vec{j}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.137em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9425em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.2285em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.2355em;\"\u003e\u003cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'\u003e\u003cpath d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1944em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"jftVYjv869"},{"type":"text","value":" onto our mesh (i.e. ","key":"nK5Y1XK0sM"},{"type":"inlineMath","value":"\\bf{j}","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"bold\"\u003ej\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\bf{j}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathbf\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"L5l3KsEVXg"},{"type":"text","value":") except that the face normal points out of the cell (rather than in the axes direction). After fixing the direction of the face normal (multiplying by ","key":"AP6wJ24B8j"},{"type":"inlineMath","value":"\\pm 1","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmo\u003e±\u003c/mo\u003e\u003cmn\u003e1\u003c/mn\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\pm 1\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e±\u003c/span\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"IYcnwfYclM"},{"type":"text","value":"), we only need to calculate the face areas and cell volume to create the discrete divergence matrix.","key":"fhJWBndnl1"}],"key":"GFCrYFQjEQ"}],"data":{"id":"nb-cell-0","type":"notebook-content","iooxa":{"id":{"block":"nKfiCCQl0i4NxAg9AUPc","project":"5dxSs15hZtvQDKSzFgjP","version":3}}},"identifier":"nb-cell-0","label":"nb-cell-0","html_id":"nb-cell-0","key":"KcgpQL83yE"},{"type":"block","position":{"start":{"line":6,"column":0},"end":{"line":7,"column":0}},"children":[{"type":"heading","depth":1,"position":{"start":{"line":8,"column":0},"end":{"line":9,"column":0}},"children":[{"type":"text","value":"Building our operators: the Face Divergence","key":"zDh1UdUHJd"}],"identifier":"building-our-operators-the-face-divergence","label":"Building our operators: the Face Divergence","html_id":"building-our-operators-the-face-divergence","implicit":true,"key":"K2Kbh0Hjlk"},{"type":"container","kind":"figure","identifier":"22570c81","label":"22570c81","children":[{"type":"image","url":"/tle-finitevolume/build/divergence-c0bef8172fc19fa7f262e78596c71990.png","alt":"Geometrical definition of the divergence and the discretization.","urlSource":"../images/divergence.png","key":"jbrW8NLlv2"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":12,"column":0},"end":{"line":13,"column":0}},"children":[{"type":"captionNumber","kind":"figure","label":"22570c81","identifier":"22570c81","html_id":"id-22570c81","enumerator":"1","children":[{"type":"text","value":"Figure ","key":"C1QbAsutb3"},{"type":"text","value":"1","key":"LgYt8Cqa2t"},{"type":"text","value":":","key":"IsMxzVLOX0"}],"template":"Figure %s:","key":"mShf5mseJK"},{"type":"text","value":"Geometrical definition of the divergence and the discretization.","key":"KEqFLOrLMk"}],"key":"vg4wZPidhP"}],"key":"KmDbv67y8Q"}],"enumerator":"1","html_id":"id-22570c81","key":"vTC2wtiHup"}],"data":{"id":"nb-cell-1","type":"notebook-content","iooxa":{"id":{"block":"oOiLGQcS0svLOalNSTf1","project":"5dxSs15hZtvQDKSzFgjP","version":2}}},"identifier":"nb-cell-1","label":"nb-cell-1","html_id":"nb-cell-1","key":"JUP8ciGh2s"},{"type":"block","position":{"start":{"line":15,"column":0},"end":{"line":16,"column":0}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":17,"column":0},"end":{"line":18,"column":0}},"children":[{"type":"text","value":"Implementation","key":"papEdC1PDN"}],"identifier":"implementation","label":"Implementation","html_id":"implementation","implicit":true,"key":"fOXfpKHF4f"},{"type":"paragraph","position":{"start":{"line":19,"column":0},"end":{"line":20,"column":0}},"children":[{"type":"text","value":"Although this is a really helpful way to think about conceptually what is happening, the implementation of that would be a huge for loop over each cell. In practice, this would be slow, so instead, we will take advantage of linear algebra. Let's start by looking at this in 1 dimension using the SimPEG Mesh class.","key":"AB0qsFdN2I"}],"key":"A27Mj7ffkp"}],"data":{"id":"nb-cell-2","type":"notebook-content","iooxa":{"id":{"block":"eeAxDflDGPkdOrAgHuuc","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-2","label":"nb-cell-2","html_id":"nb-cell-2","key":"rcrNR8yubW"},{"type":"block","position":{"start":{"line":21,"column":0},"end":{"line":22,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport discretize\nimport matplotlib.pyplot as plt","identifier":"nb-cell-3-code","enumerator":"1","html_id":"nb-cell-3-code","key":"kGEQPeAtWm"},{"type":"output","id":"Y0CY5OZeeRNW06JH22Rk2","data":[],"identifier":"nb-cell-3-output","html_id":"nb-cell-3-output","key":"DPEbwl87qt"}],"data":{"id":"nb-cell-3","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"I4kyvafNPwP1ceD3UYe2","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"OPes5mhyogExjjUGG60P","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-3","label":"nb-cell-3","html_id":"nb-cell-3","key":"uITnsc2JUP"},{"type":"block","position":{"start":{"line":33,"column":0},"end":{"line":34,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"# define a 1D mesh\nmesh1D = discretize.TensorMesh([5]) # with 5 cells \n\nfig, ax = plt.subplots(1,1, figsize=(12,2))\nax.plot(mesh1D.gridN, np.zeros(mesh1D.nN),'-k',marker='|',markeredgewidth=2, markersize=16)\nax.plot(mesh1D.gridCC,np.zeros(mesh1D.nC),'o')\nax.plot(mesh1D.gridFx,np.zeros(mesh1D.nFx),'\u003e')\nax.set_title('1D Mesh');","identifier":"nb-cell-4-code","enumerator":"2","html_id":"nb-cell-4-code","key":"UUkuXRjNWO"},{"type":"output","id":"MNTHO0haVwdCDWhd1fZ4T","data":[{"output_type":"display_data","metadata":{"needs_background":"light"},"data":{"image/png":{"content_type":"image/png","hash":"4b8525d131dba995667574f2e6f1633d","path":"/tle-finitevolume/build/4b8525d131dba995667574f2e6f1633d.png"},"text/plain":{"content":"\u003cFigure size 864x144 with 1 Axes\u003e","content_type":"text/plain"}}}],"identifier":"nb-cell-4-output","html_id":"nb-cell-4-output","key":"GkYQJoO1SF"}],"data":{"id":"nb-cell-4","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"KrMUDYN80yajASOjw6E6","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"FJli27YyFqCTAPfsq6O2","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-4","label":"nb-cell-4","html_id":"nb-cell-4","key":"lS0Eiv37Q6"},{"type":"block","position":{"start":{"line":50,"column":0},"end":{"line":51,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"# and define a vector of fluxes that live on the faces of the 1D mesh\nface_vec = np.r_[0., 1., 2., 2., 1., 0.]  # vector of fluxes that live on the faces of the mesh\nprint(\"The flux on the faces is {}\".format(face_vec))\n\nplt.plot(mesh1D.gridFx, face_vec, '-o')\nplt.ylim([face_vec.min()-0.5, face_vec.max()+0.5])\nplt.grid(which='both')\nplt.title('face_vec');","identifier":"nb-cell-5-code","enumerator":"3","html_id":"nb-cell-5-code","key":"jVOZT49ET9"},{"type":"output","id":"lnE8OzFZnSGdyw1O9PyZ7","data":[{"name":"stdout","output_type":"stream","text":"The flux on the faces is [0. 1. 2. 2. 1. 0.]\n"},{"output_type":"display_data","metadata":{"needs_background":"light"},"data":{"image/png":{"content_type":"image/png","hash":"0be4c56de9218e1f29926ecfeab4ecdf","path":"/tle-finitevolume/build/0be4c56de9218e1f29926ecfeab4ecdf.png"},"text/plain":{"content":"\u003cFigure size 432x288 with 1 Axes\u003e","content_type":"text/plain"}}}],"identifier":"nb-cell-5-output","html_id":"nb-cell-5-output","key":"l8ALvGpmSU"}],"data":{"id":"nb-cell-5","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"UcEj2TwHUfsKCmWOD9bH","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"aJK46VMEGjhwbzauXeEX","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-5","label":"nb-cell-5","html_id":"nb-cell-5","key":"a5Fxlu1ELt"},{"type":"block","position":{"start":{"line":67,"column":0},"end":{"line":68,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":69,"column":0},"end":{"line":70,"column":0}},"children":[{"type":"text","value":"Over a single cell, the divergence is","key":"EmGSD0x0C6"}],"key":"FeqtsxZAEC"},{"type":"math","value":"\\nabla \\cdot \\vec{j}(p) = \\lim_{v \\to \\{p\\}} = \\int \\int_{S(v)} \\frac{\\vec{j}\\cdot \\vec{n}}{v} dS","position":{"start":{"line":71,"column":0},"end":{"line":74,"column":0}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"normal\"\u003e∇\u003c/mi\u003e\u003cmo\u003e⋅\u003c/mo\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmo\u003e⃗\u003c/mo\u003e\u003c/mover\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003ep\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmunder\u003e\u003cmrow\u003e\u003cmi\u003elim\u003c/mi\u003e\u003cmo\u003e⁡\u003c/mo\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi\u003ev\u003c/mi\u003e\u003cmo\u003e→\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e{\u003c/mo\u003e\u003cmi\u003ep\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e}\u003c/mo\u003e\u003c/mrow\u003e\u003c/munder\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmo\u003e∫\u003c/mo\u003e\u003cmsub\u003e\u003cmo\u003e∫\u003c/mo\u003e\u003cmrow\u003e\u003cmi\u003eS\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003ev\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmo\u003e⃗\u003c/mo\u003e\u003c/mover\u003e\u003cmo\u003e⋅\u003c/mo\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003en\u003c/mi\u003e\u003cmo\u003e⃗\u003c/mo\u003e\u003c/mover\u003e\u003c/mrow\u003e\u003cmi\u003ev\u003c/mi\u003e\u003c/mfrac\u003e\u003cmi\u003ed\u003c/mi\u003e\u003cmi\u003eS\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\nabla \\cdot \\vec{j}(p) = \\lim_{v \\to \\{p\\}} = \\int \\int_{S(v)} \\frac{\\vec{j}\\cdot \\vec{n}}{v} dS\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e∇\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⋅\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.1925em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9425em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.2285em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.2355em;\"\u003e\u003cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'\u003e\u003cpath d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1944em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ep\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.6604em;vertical-align:-0.966em;\"\u003e\u003c/span\u003e\u003cspan class=\"mop op-limits\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.6944em;\"\u003e\u003cspan style=\"top:-2.309em;margin-left:0em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003ev\u003c/span\u003e\u003cspan class=\"mrel mtight\"\u003e→\u003c/span\u003e\u003cspan class=\"mopen mtight\"\u003e{\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ep\u003c/span\u003e\u003cspan class=\"mclose mtight\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan\u003e\u003cspan class=\"mop\"\u003elim\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.966em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.7065em;vertical-align:-1.0869em;\"\u003e\u003c/span\u003e\u003cspan class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\"\u003e∫\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mop\"\u003e\u003cspan class=\"mop op-symbol large-op\" style=\"margin-right:0.44445em;position:relative;top:-0.0011em;\"\u003e∫\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:-0.3869em;\"\u003e\u003cspan style=\"top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.05764em;\"\u003eS\u003c/span\u003e\u003cspan class=\"mopen mtight\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003ev\u003c/span\u003e\u003cspan class=\"mclose mtight\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.0869em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.6195em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ev\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9425em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.2285em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.2355em;\"\u003e\u003cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'\u003e\u003cpath d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1944em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⋅\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.714em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003en\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.2355em;\"\u003e\u003cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'\u003e\u003cpath d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ed\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05764em;\"\u003eS\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"1","key":"KhCc2nuUH6"},{"type":"paragraph","position":{"start":{"line":75,"column":0},"end":{"line":76,"column":0}},"children":[{"type":"text","value":"in 1D, this collapses to taking a single difference - how much is going out of the cell vs coming in?","key":"p6YXtamGLC"}],"key":"RFrRTIqjgV"},{"type":"math","value":"\\nabla \\cdot \\vec{j} \\approx \\frac{1}{v}(-j_{\\text{left}} + j_{\\text{right}})","position":{"start":{"line":77,"column":0},"end":{"line":80,"column":0}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"normal\"\u003e∇\u003c/mi\u003e\u003cmo\u003e⋅\u003c/mo\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmo\u003e⃗\u003c/mo\u003e\u003c/mover\u003e\u003cmo\u003e≈\u003c/mo\u003e\u003cmfrac\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmi\u003ev\u003c/mi\u003e\u003c/mfrac\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmtext\u003eleft\u003c/mtext\u003e\u003c/msub\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmtext\u003eright\u003c/mtext\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\nabla \\cdot \\vec{j} \\approx \\frac{1}{v}(-j_{\\text{left}} + j_{\\text{right}})\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e∇\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⋅\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.137em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9425em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.2285em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.2355em;\"\u003e\u003cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'\u003e\u003cpath d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1944em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e≈\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.0074em;vertical-align:-0.686em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3214em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ev\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e−\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003eleft\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3361em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord text mtight\"\u003e\u003cspan class=\"mord mtight\"\u003eright\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"2","key":"bxKvPaafXv"},{"type":"paragraph","position":{"start":{"line":81,"column":0},"end":{"line":82,"column":0}},"children":[{"type":"text","value":"Since the normal of the x-face on the left side of the cell points in the positive x-direction, we multiply by -1 to get the flux going out of the cell. On the right, the normal defining the x-face is point out of the cell, so it is positive.","key":"HxC3X6V8Hl"}],"key":"Xfq0OnkQYn"}],"data":{"id":"nb-cell-6","type":"notebook-content","iooxa":{"id":{"block":"yHXAjkwmvv2aYeV5xAaX","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-6","label":"nb-cell-6","html_id":"nb-cell-6","key":"nRHEeyLLmQ"},{"type":"block","position":{"start":{"line":83,"column":0},"end":{"line":84,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"# We can take the divergence over the entire mesh by looping over each cell\ndiv_face_vec = np.zeros(mesh1D.nC) # allocate for each cell\n\nfor i in range(mesh1D.nC):  #  loop over each cell and \n    div_face_vec[i] = 1.0/mesh1D.cell_volumes[i] * (-face_vec[i] + face_vec[i+1])\n\nprint(\"The face div of the 1D flux is {}\".format(div_face_vec))","identifier":"nb-cell-7-code","enumerator":"4","html_id":"nb-cell-7-code","key":"eecHmp87W7"},{"type":"output","id":"U4yIitpOW0e0e6WY5iOfJ","data":[{"name":"stdout","output_type":"stream","text":"The face div of the 1D flux is [ 5.  5.  0. -5. -5.]\n"}],"identifier":"nb-cell-7-output","html_id":"nb-cell-7-output","key":"q67tUk9FXQ"}],"data":{"id":"nb-cell-7","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"XgNg21eJlh2qjEpr1jlV","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"mdoDntxjoU1cWAVwSBkA","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-7","label":"nb-cell-7","html_id":"nb-cell-7","key":"Q5517GbRs4"},{"type":"block","position":{"start":{"line":99,"column":0},"end":{"line":100,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":101,"column":0},"end":{"line":104,"column":0}},"children":[{"type":"text","value":"Doing it as a for loop is easy to program for the first time,\nbut is difficult to see what is going on and could be slow!\nInstead, we can build a face_divergence matrix (note: this is a silly way to do this!)","key":"xce2smRpDZ"}],"key":"zjjtQuHMyt"}],"data":{"id":"nb-cell-8","type":"notebook-content","iooxa":{"id":{"block":"s9P8ct5qaxTQtPLZeVZy","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-8","label":"nb-cell-8","html_id":"nb-cell-8","key":"Yift1RtmL9"},{"type":"block","position":{"start":{"line":105,"column":0},"end":{"line":106,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"face_divergence = np.zeros([mesh1D.nC, mesh1D.nF]) # allocate space for a face div matrix\nfor i in range(mesh1D.nC):  #  loop over each cell\n    face_divergence[i, [i, i+1]] = 1.0/mesh1D.cell_volumes[i] * np.r_[-1,+1]\n\nprint(\"The 1D face div matrix for this mesh is \\n{}\".format(face_divergence))\n\nassert np.all(face_divergence.dot(face_vec) == div_face_vec)  # make sure we get the same result! \n\nprint(\"\\nThe face div of the 1D flux is still {}!\".format(div_face_vec))","identifier":"nb-cell-9-code","enumerator":"5","html_id":"nb-cell-9-code","key":"sK1hO6tFpX"},{"type":"output","id":"1RuWgH73J0QZ7PpTtTiPK","data":[{"name":"stdout","output_type":"stream","text":"The 1D face div matrix for this mesh is \n[[-5.  5.  0.  0.  0.  0.]\n [ 0. -5.  5.  0.  0.  0.]\n [ 0.  0. -5.  5.  0.  0.]\n [ 0.  0.  0. -5.  5.  0.]\n [ 0.  0.  0.  0. -5.  5.]]\n\nThe face div of the 1D flux is still [ 5.  5.  0. -5. -5.]!\n"}],"identifier":"nb-cell-9-output","html_id":"nb-cell-9-output","key":"JD7yNOUXSk"}],"data":{"id":"nb-cell-9","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"Od46G6oAgVqe5C4GpGj2","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"cvVzOufBCzk8UqaCt95m","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-9","label":"nb-cell-9","html_id":"nb-cell-9","key":"MQTlzMWpHP"},{"type":"block","position":{"start":{"line":123,"column":0},"end":{"line":124,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":125,"column":0},"end":{"line":127,"column":0}},"children":[{"type":"text","value":"the above is still a loop... (and python is not a fan of loops).\nAlso, if the mesh gets big, we are storing a lot of unnecessary zeros","key":"DaWVlvUBcK"}],"key":"Xo7HuyV1Mi"}],"data":{"id":"nb-cell-10","type":"notebook-content","iooxa":{"id":{"block":"jdq8u8dXJLTkpsiu0UxF","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-10","label":"nb-cell-10","html_id":"nb-cell-10","key":"xbhXpyQBF6"},{"type":"block","position":{"start":{"line":128,"column":0},"end":{"line":129,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(\"There are {nnz} zeros (too many!) that we are storing\".format(nnz = np.sum(face_divergence == 0)))","identifier":"nb-cell-11-code","enumerator":"6","html_id":"nb-cell-11-code","key":"QBmA43uL03"},{"type":"output","id":"VolXzbn-YC32_6NnAB5yU","data":[{"name":"stdout","output_type":"stream","text":"There are 20 zeros (too many!) that we are storing\n"}],"identifier":"nb-cell-11-output","html_id":"nb-cell-11-output","key":"lfptMhvoSO"}],"data":{"id":"nb-cell-11","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"n29rX9nI47rDtXmSMEr0","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"hPm8VXETlzJiwxo7OpkT","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-11","label":"nb-cell-11","html_id":"nb-cell-11","key":"Y4etm7JHWN"},{"type":"block","position":{"start":{"line":138,"column":0},"end":{"line":139,"column":0}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":140,"column":0},"end":{"line":141,"column":0}},"children":[{"type":"text","value":"Working in Sparse","key":"sqIWoIkULV"}],"identifier":"working-in-sparse","label":"Working in Sparse","html_id":"working-in-sparse","implicit":true,"key":"OVOB5lrG6U"},{"type":"paragraph","position":{"start":{"line":142,"column":0},"end":{"line":143,"column":0}},"children":[{"type":"text","value":"We will use instead ","key":"c9nSLb736H"},{"type":"emphasis","children":[{"type":"text","value":"sparse","key":"ZukX459Pku"}],"key":"EtY4aWbUeq"},{"type":"text","value":" matrices instead. These are in scipy and act almost the same as numpy arrays (except they default to matrix multiplication), and they don't store all of those pesky zeros! We use ","key":"hhAhKTy6XA"},{"type":"link","url":"http://docs.scipy.org/doc/scipy/reference/sparse.html","children":[{"type":"text","value":"scipy.sparse","key":"zHekRwnEZt"}],"urlSource":"http://docs.scipy.org/doc/scipy/reference/sparse.html","key":"c5BJ1R1xHf"},{"type":"text","value":" to build these matrices.","key":"w3VNhMOBZO"}],"key":"XXxFJc9mmA"}],"data":{"id":"nb-cell-12","type":"notebook-content","iooxa":{"id":{"block":"Pgf0tUa8m83skvdq6xZV","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-12","label":"nb-cell-12","html_id":"nb-cell-12","key":"OlpWpe6CyM"},{"type":"block","position":{"start":{"line":144,"column":0},"end":{"line":145,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"import scipy.sparse as sp\nfrom SimPEG.utils import sdiag # we are often building sparse diagonal matrices, so we made a functio in SimPEG!","identifier":"nb-cell-13-code","enumerator":"7","html_id":"nb-cell-13-code","key":"P14LWhx4fP"},{"type":"output","id":"SqZ-LWzaNXVMMyLt7RX6m","data":[],"identifier":"nb-cell-13-output","html_id":"nb-cell-13-output","key":"sn3NQndVzB"}],"data":{"id":"nb-cell-13","type":"notebook-code","collapsed":true,"iooxa":{"id":{"block":"iggGtG34OkkLiEZWqRBp","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"0fWydswneLLXMcOTdGrA","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":true}},"identifier":"nb-cell-13","label":"nb-cell-13","html_id":"nb-cell-13","key":"brHiwszhrO"},{"type":"block","position":{"start":{"line":155,"column":0},"end":{"line":156,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"# construct differencing matrix with diagonals -1, +1\nsparse_diff = sp.spdiags((np.ones((mesh1D.nC+1, 1))*[-1, 1]).T, [0, 1], mesh1D.nC, mesh1D.nC+1, format=\"csr\")\nprint(\"the sparse differencing matrix is \\n{}\".format(sparse_diff.todense()))\n\n# account for the volume\nface_divergence_sparse = sdiag(1./mesh1D.cell_volumes) * sparse_diff  # account for volume \nprint(\"\\n and the face divergence is \\n{}\".format(face_divergence_sparse.todense()))\n\nprint(\"\\n but now we are only storing {nnz} nonzeros\".format(nnz=face_divergence_sparse.nnz))\n\nassert np.all(face_divergence_sparse.dot(face_vec) == div_face_vec) \nprint(\"\\n and we get the same answer! {}\".format(face_divergence_sparse * face_vec))","identifier":"nb-cell-14-code","enumerator":"8","html_id":"nb-cell-14-code","key":"GDJPdtG4xI"},{"type":"output","id":"tmqm8649j6V3GH4qvEp0a","data":[{"name":"stdout","output_type":"stream","text":"the sparse differencing matrix is \n[[-1.  1.  0.  0.  0.  0.]\n [ 0. -1.  1.  0.  0.  0.]\n [ 0.  0. -1.  1.  0.  0.]\n [ 0.  0.  0. -1.  1.  0.]\n [ 0.  0.  0.  0. -1.  1.]]\n\n and the face divergence is \n[[-5.  5.  0.  0.  0.  0.]\n [ 0. -5.  5.  0.  0.  0.]\n [ 0.  0. -5.  5.  0.  0.]\n [ 0.  0.  0. -5.  5.  0.]\n [ 0.  0.  0.  0. -5.  5.]]\n\n but now we are only storing 10 nonzeros\n\n and we get the same answer! [ 5.  5.  0. -5. -5.]\n"}],"identifier":"nb-cell-14-output","html_id":"nb-cell-14-output","key":"sCvESTV3qb"}],"data":{"id":"nb-cell-14","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"6mvD37V5OTVVZ0XgFQr0","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"lqI4a0hkpkh2upH2PC0y","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false},"scrolled":true},"identifier":"nb-cell-14","label":"nb-cell-14","html_id":"nb-cell-14","key":"QqfxRs0x29"},{"type":"block","position":{"start":{"line":176,"column":0},"end":{"line":177,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":178,"column":0},"end":{"line":179,"column":0}},"children":[{"type":"text","value":"In SimPEG, this is stored as the ","key":"LmoRS10wyt"},{"type":"inlineCode","value":"face_divergence","key":"glSOni8Dfz"},{"type":"text","value":" property on the mesh","key":"h94ndC86nP"}],"key":"AjxIFndYAZ"}],"data":{"id":"nb-cell-15","type":"notebook-content","iooxa":{"id":{"block":"bQe15fAHreSIeSmntSVV","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-15","label":"nb-cell-15","html_id":"nb-cell-15","key":"v7Chb7gmXH"},{"type":"block","position":{"start":{"line":180,"column":0},"end":{"line":181,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"print(mesh1D.face_divergence * face_vec) # and still gives us the same answer!","identifier":"nb-cell-16-code","enumerator":"9","html_id":"nb-cell-16-code","key":"VmfQczlTL3"},{"type":"output","id":"8qF7ezPtQ3PkLgnG9qrAn","data":[{"name":"stdout","output_type":"stream","text":"[ 5.  5.  0. -5. -5.]\n"}],"identifier":"nb-cell-16-output","html_id":"nb-cell-16-output","key":"PPtoOO54ZA"}],"data":{"id":"nb-cell-16","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"zkTsSUdbmN0Mc0dt9hP0","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"ZxjsTpo462PV9SGcbUVb","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-16","label":"nb-cell-16","html_id":"nb-cell-16","key":"Z7x8OzPZga"},{"type":"block","position":{"start":{"line":190,"column":0},"end":{"line":191,"column":0}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":192,"column":0},"end":{"line":193,"column":0}},"children":[{"type":"text","value":"Moving to 2D","key":"SdTFSanRDx"}],"identifier":"moving-to-2d","label":"Moving to 2D","html_id":"moving-to-2d","implicit":true,"key":"fMbKTQerJV"}],"data":{"id":"nb-cell-17","type":"notebook-content","iooxa":{"id":{"block":"kdbZr5yVmhZnw1W6RbcY","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-17","label":"nb-cell-17","html_id":"nb-cell-17","key":"S3gdZaS5UD"},{"type":"block","position":{"start":{"line":194,"column":0},"end":{"line":195,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":196,"column":0},"end":{"line":197,"column":0}},"children":[{"type":"text","value":"To move up in dimensionality, we build a 2D mesh which has both x and y faces","key":"QuwSqe822W"}],"key":"WKEDwgTkhx"}],"data":{"id":"nb-cell-18","type":"notebook-content","iooxa":{"id":{"block":"Z7p6qywo3VYVsUFXBwiA","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-18","label":"nb-cell-18","html_id":"nb-cell-18","key":"mmGA7489GW"},{"type":"block","position":{"start":{"line":198,"column":0},"end":{"line":199,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"mesh2D = discretize.TensorMesh([100, 80])\nmesh2D.plot_grid()\nplt.axis('tight');","identifier":"nb-cell-19-code","enumerator":"10","html_id":"nb-cell-19-code","key":"y4CbVFnjVh"},{"type":"output","id":"M2a-Otm0ZVqglAWN6wdDb","data":[{"output_type":"display_data","metadata":{"needs_background":"light"},"data":{"image/png":{"content_type":"image/png","hash":"c163dfe4cc4be0504849a4c3cca57f4c","path":"/tle-finitevolume/build/c163dfe4cc4be0504849a4c3cca57f4c.png"},"text/plain":{"content":"\u003cFigure size 432x288 with 1 Axes\u003e","content_type":"text/plain"}}}],"identifier":"nb-cell-19-output","html_id":"nb-cell-19-output","key":"p1Mqk0FPgi"}],"data":{"id":"nb-cell-19","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"ePmEVcPu45VaiZ4iySo2","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"Te1e50NOTpP1m84K6IOn","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-19","label":"nb-cell-19","html_id":"nb-cell-19","key":"bqKUeX7i1H"},{"type":"block","position":{"start":{"line":210,"column":0},"end":{"line":211,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":212,"column":0},"end":{"line":213,"column":0}},"children":[{"type":"text","value":"We define 2 face functions, one in the x-direction and one in the y-direction. Here, we choose to work with sine functions as the continuous divergence is easy to compute, meaning we can test it!","key":"juPa9c30DC"}],"key":"LvIBQKZjxn"}],"data":{"id":"nb-cell-20","type":"notebook-content","iooxa":{"id":{"block":"E3V1eLMjpPyWwJwhKs40","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-20","label":"nb-cell-20","html_id":"nb-cell-20","key":"lOfBX5e4Mb"},{"type":"block","position":{"start":{"line":214,"column":0},"end":{"line":215,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"jx_fct = lambda x, y: -np.sin(2.*np.pi*x)\njy_fct = lambda x, y: -np.sin(2.*np.pi*y)\n\njx_vec = jx_fct(mesh2D.gridFx[:,0], mesh2D.gridFx[:,1])\njy_vec = jy_fct(mesh2D.gridFy[:,0], mesh2D.gridFy[:,1])\n\nj_vec = np.r_[jx_vec, jy_vec]\n\nprint(\"There are {nFx} x-faces and {nFy} y-faces, so the length of the \"\n      \"face function, j, is {lenj}\".format(\n        nFx=mesh2D.nFx, \n        nFy=mesh2D.nFy,\n        lenj=len(j_vec)\n     ))\n\nplt.colorbar(mesh2D.plot_image(j_vec, 'F', view='vec')[0]);","identifier":"nb-cell-21-code","enumerator":"11","html_id":"nb-cell-21-code","key":"oGXaHdL13u"},{"type":"output","id":"9odNmn6Tr_TpK-dM4nhw3","data":[{"name":"stdout","output_type":"stream","text":"There are 8080 x-faces and 8100 y-faces, so the length of the face function, j, is 16180\n"},{"output_type":"display_data","metadata":{"needs_background":"light"},"data":{"image/png":{"content_type":"image/png","hash":"c6900e9dffb779002ed5c80748635ad6","path":"/tle-finitevolume/build/c6900e9dffb779002ed5c80748635ad6.png"},"text/plain":{"content":"\u003cFigure size 432x288 with 2 Axes\u003e","content_type":"text/plain"}}}],"identifier":"nb-cell-21-output","html_id":"nb-cell-21-output","key":"RUvOBH1RwL"}],"data":{"id":"nb-cell-21","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"A1au7WuOH2jGDyuDba5t","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"1ipNn5keUvuAaL7RoUvb","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-21","label":"nb-cell-21","html_id":"nb-cell-21","key":"jm6oy7wQqe"},{"type":"block","position":{"start":{"line":239,"column":0},"end":{"line":240,"column":0}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":241,"column":0},"end":{"line":242,"column":0}},"children":[{"type":"text","value":"But first... what does the matrix look like?","key":"bdKkEcSVh7"}],"identifier":"but-first-what-does-the-matrix-look-like","label":"But first... what does the matrix look like?","html_id":"but-first-what-does-the-matrix-look-like","implicit":true,"key":"DFk0nn9SmS"},{"type":"paragraph","position":{"start":{"line":243,"column":0},"end":{"line":244,"column":0}},"children":[{"type":"text","value":"Now, we know that we do not want to loop over each of the cells and instead want to work with matrix-vector products. In this case, each row of the divergence matrix should pick out the two relevant faces in the x-direction and two in the y-direction (4 total).","key":"oQJqEveaVu"}],"key":"wg50hj3s6n"},{"type":"paragraph","position":{"start":{"line":245,"column":0},"end":{"line":246,"column":0}},"children":[{"type":"text","value":"When we unwrap our face function, we unwrap using column major ordering, so all of the x-faces are adjacent to one another, while the y-faces are separated by the number of cells in the x-direction (see ","key":"bunM9QPSPJ"},{"type":"link","url":"/mesh","children":[{"type":"text","value":"Finite Volume Mesh","key":"gvrrQB6Ivz"}],"urlSource":"mesh.ipynb","internal":true,"dataUrl":"/mesh.json","protocol":"file","key":"o1H1hvPyFL"},{"type":"text","value":" for more details!).","key":"ZtBMftr7Od"}],"key":"fhWwvV0ycn"},{"type":"paragraph","position":{"start":{"line":247,"column":0},"end":{"line":248,"column":0}},"children":[{"type":"text","value":"When we plot the divergence matrix, there will be 4 \"diagonals\",","key":"UrpVvhJIVx"}],"key":"q2kr9Zw5sk"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":248,"column":0},"end":{"line":251,"column":0}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":248,"column":0},"end":{"line":249,"column":0}},"children":[{"type":"text","value":"2 that are due to the x-contribution","key":"gpQDJ5DApt"}],"key":"dVlx0imDw3"},{"type":"listItem","spread":true,"position":{"start":{"line":249,"column":0},"end":{"line":251,"column":0}},"children":[{"type":"text","value":"2 that are due to the y-contribution","key":"bpF3Zspy2D"}],"key":"hjWNJaRxNC"}],"key":"eYEBZkwQ2D"},{"type":"paragraph","position":{"start":{"line":251,"column":0},"end":{"line":252,"column":0}},"children":[{"type":"text","value":"Here, we define a small 2D mesh so that it is easier to see the matrix structure.","key":"TVttRl9kW2"}],"key":"DB7acEHsRe"}],"data":{"id":"nb-cell-22","type":"notebook-content","iooxa":{"id":{"block":"6USJcIPTF75SdDWAyvcC","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-22","label":"nb-cell-22","html_id":"nb-cell-22","key":"hSKmZsv2PV"},{"type":"block","position":{"start":{"line":253,"column":0},"end":{"line":254,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"small_mesh2D = discretize.TensorMesh([3, 4])\n\nprint(\"Each y-face is {} entries apart\".format(small_mesh2D.shape_cells[0]))\nprint(\"and the total number of x-faces is {}\".format(small_mesh2D.nFx))\nprint(\"So in the first row of the face_divergence, we have non-zero entries at \\n{}\".format(\n        small_mesh2D.face_divergence[0,:]))","identifier":"nb-cell-23-code","enumerator":"12","html_id":"nb-cell-23-code","key":"bdGiKYHt9x"},{"type":"output","id":"2IdntXCiuuDdFPPwmC8v_","data":[{"name":"stdout","output_type":"stream","text":"Each y-face is 3 entries apart\nand the total number of x-faces is 16\nSo in the first row of the face_divergence, we have non-zero entries at \n  (0, 0)\t-3.0\n  (0, 1)\t3.0\n  (0, 16)\t-4.0\n  (0, 19)\t4.0\n"}],"identifier":"nb-cell-23-output","html_id":"nb-cell-23-output","key":"NZ1HbBTmjX"}],"data":{"id":"nb-cell-23","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"4XzIANGORIjDIJqUlgSW","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"hNs5MlCVEZ7kH7WL2hjA","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-23","label":"nb-cell-23","html_id":"nb-cell-23","key":"K7hGL9P8Vz"},{"type":"block","position":{"start":{"line":268,"column":0},"end":{"line":269,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":270,"column":0},"end":{"line":271,"column":0}},"children":[{"type":"text","value":"Now, lets look at the matrix structure","key":"CV503bggcV"}],"key":"aSRuiF44wl"}],"data":{"id":"nb-cell-24","type":"notebook-content","iooxa":{"id":{"block":"A5C1ITpQonG1NxgAZZqA","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-24","label":"nb-cell-24","html_id":"nb-cell-24","key":"zD3uuLAIwc"},{"type":"block","position":{"start":{"line":272,"column":0},"end":{"line":273,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(1,2, figsize=(12,4))\n\n# plot the non-zero entries in the face_divergence\nax[0].spy(small_mesh2D.face_divergence, ms=2)\nax[0].set_xlabel('2D face_divergence')\nsmall_mesh2D.plot_grid(ax=ax[1])\n\n# Number the faces and plot. (We should really add this to SimPEG... pull request anyone!?)\nxys = zip(\n    small_mesh2D.gridFx[:,0], \n    small_mesh2D.gridFx[:,1], \n    range(small_mesh2D.nFx)\n)\nfor x,y,ii in xys:\n    ax[1].plot(x, y, 'r\u003e')\n    ax[1].text(x+0.01, y-0.02, ii, color='r')\n\nxys = zip(\n    small_mesh2D.gridFy[:,0], \n    small_mesh2D.gridFy[:,1], \n    range(small_mesh2D.nFy)\n)\nfor x,y,ii in xys:\n    ax[1].plot(x, y, 'g^')\n    ax[1].text(x-0.02, y+0.02, ii+small_mesh2D.nFx, color='g')\nax[1].set_xlim((-0.1,1.1));\nax[1].set_ylim((-0.1,1.1));","identifier":"nb-cell-25-code","enumerator":"13","html_id":"nb-cell-25-code","key":"fxBfYwudlv"},{"type":"output","id":"VcW4ivf92LyVhkwKhFOem","data":[{"output_type":"display_data","metadata":{"needs_background":"light"},"data":{"image/png":{"content_type":"image/png","hash":"bdf6f5e3df0535ee7815a8c69ad46f4d","path":"/tle-finitevolume/build/bdf6f5e3df0535ee7815a8c69ad46f4d.png"},"text/plain":{"content":"\u003cFigure size 864x288 with 2 Axes\u003e","content_type":"text/plain"}}}],"identifier":"nb-cell-25-output","html_id":"nb-cell-25-output","key":"cevctnMl1s"}],"data":{"id":"nb-cell-25","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"NLQRlTUmkMSh6mbkNwWw","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"3UjOmeynUI8HvbP1r44x","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-25","label":"nb-cell-25","html_id":"nb-cell-25","key":"ArbQGR1ybW"},{"type":"block","position":{"start":{"line":308,"column":0},"end":{"line":309,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":310,"column":0},"end":{"line":312,"column":0}},"children":[{"type":"text","value":"How did we construct the matrix? - Kronecker products.\nThere is a handy identity that relates the vectorized face function to its matrix form (","key":"tGu5X6N8oe"},{"type":"link","url":"https://en.wikipedia.org/wiki/Vectorization_(mathematics)#Compatibility_with_Kronecker_products","children":[{"type":"text","value":"see Wikipedia","key":"Nb9TgKsnW0"}],"urlSource":"https://en.wikipedia.org/wiki/Vectorization_(mathematics)#Compatibility_with_Kronecker_products","data":{"page":"Vectorization_(mathematics)#Compatibility_with_Kronecker_products","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"v9w46xpbaP"},{"type":"text","value":")","key":"UVHJ1QnLEW"}],"key":"QZfKMHG3s9"},{"type":"math","value":"\\text{vec}(AUB^\\top) = (B \\otimes A) \\text{vec}(U)","position":{"start":{"line":313,"column":0},"end":{"line":316,"column":0}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmtext\u003evec\u003c/mtext\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003eA\u003c/mi\u003e\u003cmi\u003eU\u003c/mi\u003e\u003cmsup\u003e\u003cmi\u003eB\u003c/mi\u003e\u003cmi mathvariant=\"normal\"\u003e⊤\u003c/mi\u003e\u003c/msup\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003eB\u003c/mi\u003e\u003cmo\u003e⊗\u003c/mo\u003e\u003cmi\u003eA\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmtext\u003evec\u003c/mtext\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003eU\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\text{vec}(AUB^\\top) = (B \\otimes A) \\text{vec}(U)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.1491em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003evec\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eA\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\"\u003eU\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05017em;\"\u003eB\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8991em;\"\u003e\u003cspan style=\"top:-3.113em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e⊤\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05017em;\"\u003eB\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⊗\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003eA\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003evec\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\"\u003eU\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"3","key":"TzJLMHOqPT"},{"type":"paragraph","position":{"start":{"line":317,"column":0},"end":{"line":318,"column":0}},"children":[{"type":"text","value":"For the x-contribution:","key":"VnkSdUGCRX"}],"key":"X71rU7dXbA"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":318,"column":0},"end":{"line":322,"column":0}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":318,"column":0},"end":{"line":319,"column":0}},"children":[{"type":"text","value":"A is our 1D differential operator ([-1, +1] on the diagonals)","key":"ZPTf1MZNYP"}],"key":"XcRM8vZdzJ"},{"type":"listItem","spread":true,"position":{"start":{"line":319,"column":0},"end":{"line":320,"column":0}},"children":[{"type":"text","value":"U is ","key":"QSwwfhQFAk"},{"type":"inlineMath","value":"j_x","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ej_x\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"Z2fboHmcHV"},{"type":"text","value":" (the x-face function as a matrix)","key":"phu3ltO2IZ"}],"key":"Siz3DBxaOC"},{"type":"listItem","spread":true,"position":{"start":{"line":320,"column":0},"end":{"line":322,"column":0}},"children":[{"type":"text","value":"B is just an identity, so","key":"U5I1Sv01Jc"}],"key":"C4jQP7m8gu"}],"key":"z8FRBEbDMk"},{"type":"math","value":"\\text{Div}_x \\text{vec}(j_x) = (I \\otimes Div_{1D}) \\text{vec}(j_x)","position":{"start":{"line":322,"column":0},"end":{"line":325,"column":0}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmtext\u003eDiv\u003c/mtext\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/msub\u003e\u003cmtext\u003evec\u003c/mtext\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003eI\u003c/mi\u003e\u003cmo\u003e⊗\u003c/mo\u003e\u003cmi\u003eD\u003c/mi\u003e\u003cmi\u003ei\u003c/mi\u003e\u003cmsub\u003e\u003cmi\u003ev\u003c/mi\u003e\u003cmrow\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmi\u003eD\u003c/mi\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmtext\u003evec\u003c/mtext\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\text{Div}_x \\text{vec}(j_x) = (I \\otimes Div_{1D}) \\text{vec}(j_x)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eDiv\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003evec\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.07847em;\"\u003eI\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⊗\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.02778em;\"\u003eD\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ei\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ev\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3283em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\"\u003eD\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003evec\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"4","key":"BblMLrHmn9"},{"type":"paragraph","position":{"start":{"line":326,"column":0},"end":{"line":327,"column":0}},"children":[{"type":"text","value":"For the y-contribution:","key":"kn6bboVWzb"}],"key":"o0C4oCFsDA"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":327,"column":0},"end":{"line":331,"column":0}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":327,"column":0},"end":{"line":328,"column":0}},"children":[{"type":"text","value":"A is just an identity!","key":"cZCaOVibqu"}],"key":"FNAaTyFkia"},{"type":"listItem","spread":true,"position":{"start":{"line":328,"column":0},"end":{"line":329,"column":0}},"children":[{"type":"text","value":"U is ","key":"KTVpDYNs2O"},{"type":"inlineMath","value":"j_y","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ej_y\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.9456em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"hc4dFff1Bk"},{"type":"text","value":" (the y-face function as a matrix)","key":"KPcLzF9SEu"}],"key":"GFeTy8BJoi"},{"type":"listItem","spread":true,"position":{"start":{"line":329,"column":0},"end":{"line":331,"column":0}},"children":[{"type":"text","value":"B is our 1D differential operator ([-1, +1] on the diagonals), so","key":"Dv6j2knICx"}],"key":"ZoS8CVfpj7"}],"key":"P8FC2txJmz"},{"type":"math","value":"\\text{Div}_y \\text{vec}(j_y) = (\\text{Div}_{1D} \\otimes I) \\text{vec}(j_y)","position":{"start":{"line":331,"column":0},"end":{"line":334,"column":0}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmtext\u003eDiv\u003c/mtext\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/msub\u003e\u003cmtext\u003evec\u003c/mtext\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsub\u003e\u003cmtext\u003eDiv\u003c/mtext\u003e\u003cmrow\u003e\u003cmn\u003e1\u003c/mn\u003e\u003cmi\u003eD\u003c/mi\u003e\u003c/mrow\u003e\u003c/msub\u003e\u003cmo\u003e⊗\u003c/mo\u003e\u003cmi\u003eI\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmtext\u003evec\u003c/mtext\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\text{Div}_y \\text{vec}(j_y) = (\\text{Div}_{1D} \\otimes I) \\text{vec}(j_y)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eDiv\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003evec\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eDiv\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.3283em;\"\u003e\u003cspan style=\"top:-2.55em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e1\u003c/span\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\"\u003eD\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⊗\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.07847em;\"\u003eI\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003evec\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"5","key":"LpRwDYoEbH"},{"type":"math","value":"\\text{Div} \\cdot j  = \\text{Div}_x \\cdot j_x + \\text{Div}_y \\cdot j_y = [\\text{Div}_x, \\text{Div}_y] \\cdot [j_x; j_y]","position":{"start":{"line":335,"column":0},"end":{"line":338,"column":0}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmtext\u003eDiv\u003c/mtext\u003e\u003cmo\u003e⋅\u003c/mo\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmsub\u003e\u003cmtext\u003eDiv\u003c/mtext\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/msub\u003e\u003cmo\u003e⋅\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/msub\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmsub\u003e\u003cmtext\u003eDiv\u003c/mtext\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/msub\u003e\u003cmo\u003e⋅\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/msub\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e[\u003c/mo\u003e\u003cmsub\u003e\u003cmtext\u003eDiv\u003c/mtext\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/msub\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmsub\u003e\u003cmtext\u003eDiv\u003c/mtext\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e]\u003c/mo\u003e\u003cmo\u003e⋅\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e[\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/msub\u003e\u003cmo separator=\"true\"\u003e;\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e]\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\text{Div} \\cdot j  = \\text{Div}_x \\cdot j_x + \\text{Div}_y \\cdot j_y = [\\text{Div}_x, \\text{Div}_y] \\cdot [j_x; j_y]\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eDiv\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⋅\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eDiv\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⋅\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eDiv\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⋅\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.9456em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e[\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eDiv\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eDiv\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e]\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⋅\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e[\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e;\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e]\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"6","key":"JZAl57s5jB"},{"type":"paragraph","position":{"start":{"line":339,"column":0},"end":{"line":340,"column":0}},"children":[{"type":"text","value":"And ","key":"qmZXf0EcrK"},{"type":"inlineMath","value":"j","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi\u003ej\u003c/mi\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003ej\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.854em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"jxmSddZfmB"},{"type":"text","value":" is just ","key":"gyZEoKJN0G"},{"type":"inlineMath","value":"[j_x; j_y]","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmo stretchy=\"false\"\u003e[\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/msub\u003e\u003cmo separator=\"true\"\u003e;\u003c/mo\u003e\u003cmsub\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e]\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e[j_x; j_y]\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e[\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e;\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-left:-0.0572em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e]\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"s3xW4Av5IL"},{"type":"text","value":", so we can horizontally stack ","key":"TTUtFqGEcu"},{"type":"inlineMath","value":"\\text{Div}_x","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmtext\u003eDiv\u003c/mtext\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\text{Div}_x\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eDiv\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"uwcTSCuQcq"},{"type":"text","value":", ","key":"DLnvVq7nq7"},{"type":"inlineMath","value":"\\text{Div}_y","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmsub\u003e\u003cmtext\u003eDiv\u003c/mtext\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/msub\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\text{Div}_y\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.9694em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eDiv\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"FLzJBDlp4E"}],"key":"kbTYHIJKQC"},{"type":"math","value":"\\text{Div} = [\\text{Div}_x, \\text{Div}_y]","position":{"start":{"line":341,"column":0},"end":{"line":344,"column":0}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmtext\u003eDiv\u003c/mtext\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e[\u003c/mo\u003e\u003cmsub\u003e\u003cmtext\u003eDiv\u003c/mtext\u003e\u003cmi\u003ex\u003c/mi\u003e\u003c/msub\u003e\u003cmo separator=\"true\"\u003e,\u003c/mo\u003e\u003cmsub\u003e\u003cmtext\u003eDiv\u003c/mtext\u003e\u003cmi\u003ey\u003c/mi\u003e\u003c/msub\u003e\u003cmo stretchy=\"false\"\u003e]\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\text{Div} = [\\text{Div}_x, \\text{Div}_y]\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eDiv\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e[\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eDiv\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.15em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mpunct\"\u003e,\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eDiv\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1514em;\"\u003e\u003cspan style=\"top:-2.55em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.2861em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e]\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"7","key":"UiF9t9qD7A"},{"type":"paragraph","position":{"start":{"line":345,"column":0},"end":{"line":346,"column":0}},"children":[{"type":"text","value":"You can check this out in the SimPEG docs by running ","key":"NroE6IOtP7"},{"type":"strong","children":[{"type":"text","value":"small_mesh2D.face_divergence??","key":"DkXaDzwYaY"}],"key":"JFY4IYvUlK"}],"key":"vRka0opcyJ"}],"data":{"id":"nb-cell-26","type":"notebook-content","iooxa":{"id":{"block":"aOOlNZjNUZ7kdkfIFPHR","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-26","label":"nb-cell-26","html_id":"nb-cell-26","key":"yWd9aCcphw"},{"type":"block","position":{"start":{"line":347,"column":0},"end":{"line":348,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"# check out the code!\nsmall_mesh2D.face_divergence??","identifier":"nb-cell-27-code","enumerator":"14","html_id":"nb-cell-27-code","key":"U7ft0SXOFU"},{"type":"output","id":"A9zy8uN_lHFfQl3pF2Ui8","data":[{"name":"stdout","output_type":"stream","text":"\u001b[0;31mType:\u001b[0m        property\n\u001b[0;31mString form:\u001b[0m \u003cproperty object at 0x7fd5e03cb450\u003e\n\u001b[0;31mSource:\u001b[0m     \n\u001b[0;31m# small_mesh2D.face_divergence.fget\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m\u001b[0;34m@\u001b[0m\u001b[0mproperty\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m\u001b[0;32mdef\u001b[0m \u001b[0mface_divergence\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m    \u001b[0;32mif\u001b[0m \u001b[0mgetattr\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m\"_face_divergence\"\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m        \u001b[0;31m# Get the stencil of +1, -1's\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m        \u001b[0mD\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_face_divergence_stencil\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m        \u001b[0;31m# Compute areas of cell faces \u0026 volumes\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m        \u001b[0mS\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mface_areas\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m        \u001b[0mV\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcell_volumes\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m        \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_face_divergence\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0msdiag\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;36m1\u001b[0m \u001b[0;34m/\u001b[0m \u001b[0mV\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m*\u001b[0m \u001b[0mD\u001b[0m \u001b[0;34m*\u001b[0m \u001b[0msdiag\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mS\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m    \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_face_divergence\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n"}],"identifier":"nb-cell-27-output","html_id":"nb-cell-27-output","key":"qf8m7ywPIm"}],"data":{"id":"nb-cell-27","type":"notebook-code","iooxa":{"id":{"block":"gSfEfpCYCXa6fYefRTmU","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"BrcTtus5S1kiLvRNa7jJ","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"tags":[]},"identifier":"nb-cell-27","label":"nb-cell-27","html_id":"nb-cell-27","key":"vCiAQ56HRG"},{"type":"block","position":{"start":{"line":358,"column":0},"end":{"line":359,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":360,"column":0},"end":{"line":361,"column":0}},"children":[{"type":"text","value":"Now that we have a discrete divergence, lets check out the divergence of  the face function we defined earlier.","key":"c2Ce8Qa0QJ"}],"key":"wOqVVpXJ5T"}],"data":{"id":"nb-cell-28","type":"notebook-content","iooxa":{"id":{"block":"WHVVo3M2HmurIwDe2dIN","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-28","label":"nb-cell-28","html_id":"nb-cell-28","key":"psSMB4tAx7"},{"type":"block","position":{"start":{"line":362,"column":0},"end":{"line":363,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"Div_j = mesh2D.face_divergence * j_vec\n\nfig, ax = plt.subplots(1,2, figsize=(8,4))\nplt.colorbar(mesh2D.plot_image(j_vec, 'F', view='vec', ax=ax[0])[0],ax=ax[0])\nplt.colorbar(mesh2D.plot_image(Div_j, ax=ax[1])[0],ax=ax[1])\n\nax[0].set_title('j')\nax[1].set_title('Div j')\nplt.tight_layout()","identifier":"nb-cell-29-code","enumerator":"15","html_id":"nb-cell-29-code","key":"z3sWOwLkCt"},{"type":"output","id":"RDSkxbLpot6yTWvg9bzft","data":[{"name":"stderr","output_type":"stream","text":"/opt/anaconda3/envs/simpeg/lib/python3.8/site-packages/discretize/base/base_tensor_mesh.py:785: FutureWarning: The zerosOutside keyword argument has been deprecated, please use zeros_outside. This will be removed in discretize 1.0.0\n  warnings.warn(\n"},{"output_type":"display_data","metadata":{"needs_background":"light"},"data":{"image/png":{"content_type":"image/png","hash":"7f3fe3cc121ed536dcb954287558ae74","path":"/tle-finitevolume/build/7f3fe3cc121ed536dcb954287558ae74.png"},"text/plain":{"content":"\u003cFigure size 576x288 with 4 Axes\u003e","content_type":"text/plain"}}}],"identifier":"nb-cell-29-output","html_id":"nb-cell-29-output","key":"H37x0WjuvE"}],"data":{"id":"nb-cell-29","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"uB6q9kdjkk5V4tTHaBES","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"Nyo6g0fMndfudyB5W2gu","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-29","label":"nb-cell-29","html_id":"nb-cell-29","key":"n1wD7BdpzK"},{"type":"block","position":{"start":{"line":380,"column":0},"end":{"line":381,"column":0}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":382,"column":0},"end":{"line":383,"column":0}},"children":[{"type":"text","value":"Are we right??","key":"zTPlWydyuy"}],"identifier":"are-we-right","label":"Are we right??","html_id":"are-we-right","implicit":true,"key":"ctlvaz0hQp"},{"type":"paragraph","position":{"start":{"line":384,"column":0},"end":{"line":385,"column":0}},"children":[{"type":"text","value":"Since we chose a simple function,","key":"Hg3Gi9rKod"}],"key":"MJsqUsXQAb"},{"type":"math","value":"\\vec{j} = - \\sin(2\\pi x) \\hat{x} - \\sin(2\\pi y) \\hat{y}","position":{"start":{"line":386,"column":0},"end":{"line":389,"column":0}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmo\u003e⃗\u003c/mo\u003e\u003c/mover\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmi\u003esin\u003c/mi\u003e\u003cmo\u003e⁡\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmn\u003e2\u003c/mn\u003e\u003cmi\u003eπ\u003c/mi\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmo\u003e^\u003c/mo\u003e\u003c/mover\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmi\u003esin\u003c/mi\u003e\u003cmo\u003e⁡\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmn\u003e2\u003c/mn\u003e\u003cmi\u003eπ\u003c/mi\u003e\u003cmi\u003ey\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003ey\u003c/mi\u003e\u003cmo\u003e^\u003c/mo\u003e\u003c/mover\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\vec{j} = - \\sin(2\\pi x) \\hat{x} - \\sin(2\\pi y) \\hat{y}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.137em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9425em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.2285em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.2355em;\"\u003e\u003cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'\u003e\u003cpath d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1944em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.1667em;\"\u003e\u003c/span\u003e\u003cspan class=\"mop\"\u003esin\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e2\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eπ\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.6944em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.2222em;\"\u003e\u003cspan class=\"mord\"\u003e^\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e−\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mop\"\u003esin\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e2\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eπ\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.6944em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.1944em;\"\u003e\u003cspan class=\"mord\"\u003e^\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1944em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"8","key":"TwfWuH9Xyn"},{"type":"paragraph","position":{"start":{"line":390,"column":0},"end":{"line":391,"column":0}},"children":[{"type":"text","value":"we know the continuous divergence...","key":"mOcnyDPDI3"}],"key":"h0ZS5hesB7"},{"type":"math","value":"\\nabla \\cdot \\vec{j} = -2\\pi (\\cos(2\\pi x) + \\cos(2\\pi y))","position":{"start":{"line":392,"column":0},"end":{"line":395,"column":0}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"normal\"\u003e∇\u003c/mi\u003e\u003cmo\u003e⋅\u003c/mo\u003e\u003cmover accent=\"true\"\u003e\u003cmi\u003ej\u003c/mi\u003e\u003cmo\u003e⃗\u003c/mo\u003e\u003c/mover\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmo\u003e−\u003c/mo\u003e\u003cmn\u003e2\u003c/mn\u003e\u003cmi\u003eπ\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmi\u003ecos\u003c/mi\u003e\u003cmo\u003e⁡\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmn\u003e2\u003c/mn\u003e\u003cmi\u003eπ\u003c/mi\u003e\u003cmi\u003ex\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmi\u003ecos\u003c/mi\u003e\u003cmo\u003e⁡\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmn\u003e2\u003c/mn\u003e\u003cmi\u003eπ\u003c/mi\u003e\u003cmi\u003ey\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\nabla \\cdot \\vec{j} = -2\\pi (\\cos(2\\pi x) + \\cos(2\\pi y))\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e∇\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⋅\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.137em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord accent\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.9425em;\"\u003e\u003cspan style=\"top:-3em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.05724em;\"\u003ej\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.2285em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"accent-body\" style=\"left:-0.2355em;\"\u003e\u003cspan class=\"overlay\" style=\"height:0.714em;width:0.471em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'\u003e\u003cpath d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.1944em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e−\u003c/span\u003e\u003cspan class=\"mord\"\u003e2\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eπ\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mop\"\u003ecos\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e2\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eπ\u003c/span\u003e\u003cspan class=\"mord mathnormal\"\u003ex\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mop\"\u003ecos\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e2\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003eπ\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.03588em;\"\u003ey\u003c/span\u003e\u003cspan class=\"mclose\"\u003e))\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"9","key":"pDIjOREdQs"},{"type":"paragraph","position":{"start":{"line":396,"column":0},"end":{"line":397,"column":0}},"children":[{"type":"text","value":"So lets plot it and take a look","key":"DRQdOJojMg"}],"key":"NIMMKrCOhU"}],"data":{"id":"nb-cell-30","type":"notebook-content","iooxa":{"id":{"block":"hpGeTcYVG4GcvxPnI5jn","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-30","label":"nb-cell-30","html_id":"nb-cell-30","key":"CHeROSGwBt"},{"type":"block","position":{"start":{"line":398,"column":0},"end":{"line":399,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"# from earlier\n# jx_fct = lambda x, y: -np.sin(2*np.pi*x)\n# jy_fct = lambda x, y: -np.sin(2*np.pi*y)\n\nsol = lambda x, y: -2*np.pi*(np.cos(2*np.pi*x)+np.cos(2*np.pi*y))\n\ncont_div_j = sol(mesh2D.gridCC[:,0], mesh2D.gridCC[:,1])\n\nDiv_j = mesh2D.face_divergence * j_vec\n\nfig, ax = plt.subplots(1,2, figsize=(8,4))\nplt.colorbar(mesh2D.plot_image(Div_j, ax=ax[0])[0],ax=ax[0])\nplt.colorbar(mesh2D.plot_image(cont_div_j, ax=ax[1])[0],ax=ax[1])\n\nax[0].set_title('Discrete Div j')\nax[1].set_title('Continuous Div j')\nplt.tight_layout()","identifier":"nb-cell-31-code","enumerator":"16","html_id":"nb-cell-31-code","key":"DwIy2ewzNU"},{"type":"output","id":"GizBWbfEAg7vMMpH-Mvg4","data":[{"output_type":"display_data","metadata":{"needs_background":"light"},"data":{"image/png":{"content_type":"image/png","hash":"7c3e9a987e08a8b6e0e067640246fa91","path":"/tle-finitevolume/build/7c3e9a987e08a8b6e0e067640246fa91.png"},"text/plain":{"content":"\u003cFigure size 576x288 with 4 Axes\u003e","content_type":"text/plain"}}}],"identifier":"nb-cell-31-output","html_id":"nb-cell-31-output","key":"a0z9MdcqFG"}],"data":{"id":"nb-cell-31","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"DruoQp4QpjwnURKR6vMr","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"ZvXZKlpkFYAPMPlPCXIz","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-31","label":"nb-cell-31","html_id":"nb-cell-31","key":"vuAKwPPmYo"},{"type":"block","position":{"start":{"line":424,"column":0},"end":{"line":425,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":426,"column":0},"end":{"line":427,"column":0}},"children":[{"type":"text","value":"Those look similar! 🚀","key":"BT4sGaqkSb"}],"key":"qC2ovCLJX1"}],"data":{"id":"nb-cell-32","type":"notebook-content","iooxa":{"id":{"block":"hhzUNnwy5dN5VX82zKDh","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-32","label":"nb-cell-32","html_id":"nb-cell-32","key":"exYUwrJRZb"},{"type":"block","position":{"start":{"line":428,"column":0},"end":{"line":429,"column":0}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":430,"column":0},"end":{"line":431,"column":0}},"children":[{"type":"text","value":"Order Test","key":"WuxtlqQbCQ"}],"identifier":"order-test","label":"Order Test","html_id":"order-test","implicit":true,"key":"He3kC5TmWV"},{"type":"paragraph","position":{"start":{"line":432,"column":0},"end":{"line":433,"column":0}},"children":[{"type":"text","value":"We can do better than just an eye-ball comparison - since we are using a a staggered grid, with centered differences, the discretization should be second-order (","key":"YKyNRVOiRm"},{"type":"inlineMath","value":"\\mathcal{O}(h^2)","html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmi mathvariant=\"script\"\u003eO\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmsup\u003e\u003cmi\u003eh\u003c/mi\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\mathcal{O}(h^2)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathcal\" style=\"margin-right:0.02778em;\"\u003eO\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\"\u003eh\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.8141em;\"\u003e\u003cspan style=\"top:-3.063em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"mkk7kZUr1S"},{"type":"text","value":"). That is, as we refine the mesh, our approximation of the divergence should improve by a factor of 2.","key":"p4UcLpauyN"}],"key":"YHh1UILvOW"},{"type":"paragraph","position":{"start":{"line":434,"column":0},"end":{"line":439,"column":0}},"children":[{"type":"text","value":"SimPEG has a number of testing functions for\n","key":"Ld6aJW9xkU"},{"type":"link","url":"http://docs.simpeg.xyz/content/api_core/api_Tests.html#SimPEG.Tests.checkDerivative","children":[{"type":"text","value":"derivatives","key":"I9XXckAyX3"}],"urlSource":"http://docs.simpeg.xyz/content/api_core/api_Tests.html#SimPEG.Tests.checkDerivative","key":"H6hjJYUBDl"},{"type":"text","value":"\nand\n","key":"kU65IewRmz"},{"type":"link","url":"http://docs.simpeg.xyz/content/api_core/api_Tests.html#SimPEG.Tests.OrderTest","children":[{"type":"text","value":"order of convergence","key":"CkMkzHHEkH"}],"urlSource":"http://docs.simpeg.xyz/content/api_core/api_Tests.html#SimPEG.Tests.OrderTest","key":"DQj45katYZ"},{"type":"text","value":"\nto make our lives easier!","key":"ZWBwwjFRid"}],"key":"HfxgECZxT7"}],"data":{"id":"nb-cell-33","type":"notebook-content","iooxa":{"id":{"block":"dWKbp4GkcXQLBCFELURo","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-33","label":"nb-cell-33","html_id":"nb-cell-33","key":"n4GRXu7GDP"},{"type":"block","position":{"start":{"line":440,"column":0},"end":{"line":441,"column":0}},"children":[{"type":"code","lang":"python","executable":true,"value":"import unittest\nfrom discretize.tests import OrderTest\n\njx = lambda x, y: -np.sin(2*np.pi*x)\njy = lambda x, y: -np.sin(2*np.pi*y)\nsol = lambda x, y: -2*np.pi*(np.cos(2*np.pi*x)+np.cos(2*np.pi*y))\n\nclass Testify(OrderTest):\n    meshDimension = 2\n    \n    def getError(self):\n        j = np.r_[jx(self.M.gridFx[:,0], self.M.gridFx[:,1]),\n                  jy(self.M.gridFy[:,0], self.M.gridFy[:,1])]\n        num = self.M.face_divergence * j # numeric answer\n        ans = sol(self.M.gridCC[:,0], self.M.gridCC[:,1]) # note M is a 2D mesh\n        return np.linalg.norm((num - ans), np.inf) # look at the infinity norm \n                                                   # (as we refine the mesh, the number of cells \n                                                   # changes, so need to be careful if using a 2-norm)\n    def test_order(self):\n        self.orderTest()\n\n# This just runs the unittest:\nsuite = unittest.TestLoader().loadTestsFromTestCase( Testify )\nunittest.TextTestRunner().run( suite );","identifier":"nb-cell-34-code","enumerator":"17","html_id":"nb-cell-34-code","key":"kWDEJGXGm8"},{"type":"output","id":"8uvKBWJtsFS7pd0uIXF0S","data":[{"name":"stderr","output_type":"stream","text":"/opt/anaconda3/envs/simpeg/lib/python3.8/site-packages/discretize/utils/code_utils.py:247: FutureWarning: setupMesh has been deprecated, please use setup_mesh. It will be removed in version 1.0.0 of discretize.\n  warnings.warn(\n."},{"name":"stdout","output_type":"stream","text":"\nuniformTensorMesh:  Order Test\n_____________________________________________\n   h  |    error    | e(i-1)/e(i) |  order\n~~~~~~|~~~~~~~~~~~~~|~~~~~~~~~~~~~|~~~~~~~~~~\n   4  |  8.86e-01   |\n   8  |  2.96e-01   |   2.9914    |  1.5808\n  16  |  7.90e-02   |   3.7462    |  1.9054\n  32  |  2.01e-02   |   3.9364    |  1.9769\n---------------------------------------------\nHappy little convergence test!\n\n"},{"name":"stderr","output_type":"stream","text":"\n----------------------------------------------------------------------\nRan 1 test in 0.010s\n\nOK\n"}],"identifier":"nb-cell-34-output","html_id":"nb-cell-34-output","key":"yFsQaB22G7"}],"data":{"id":"nb-cell-34","type":"notebook-code","collapsed":false,"iooxa":{"id":{"block":"0ZarfpVD1EGskE5RVnpW","project":"5dxSs15hZtvQDKSzFgjP","version":1},"outputId":{"block":"FUMd7pX0BXnAPYI9k5Ms","project":"5dxSs15hZtvQDKSzFgjP","version":1}},"jupyter":{"outputs_hidden":false}},"identifier":"nb-cell-34","label":"nb-cell-34","html_id":"nb-cell-34","key":"giF2F7xESV"},{"type":"block","position":{"start":{"line":473,"column":0},"end":{"line":474,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":475,"column":0},"end":{"line":476,"column":0}},"children":[{"type":"text","value":"Looks good - Second order convergence!","key":"kLWevBWbqR"}],"key":"D4cLT64GFQ"}],"data":{"id":"nb-cell-35","type":"notebook-content","iooxa":{"id":{"block":"GB24Nl2vYn6DUpUuA73D","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-35","label":"nb-cell-35","html_id":"nb-cell-35","key":"ChjFjkJHGq"},{"type":"block","position":{"start":{"line":477,"column":0},"end":{"line":478,"column":0}},"children":[{"type":"paragraph","position":{"start":{"line":479,"column":0},"end":{"line":480,"column":0}},"children":[{"type":"strong","children":[{"type":"text","value":"Next up...","key":"Is7a9mJc4K"}],"key":"E5iMPeYKh5"}],"key":"moEF4r6LKG"},{"type":"paragraph","position":{"start":{"line":481,"column":0},"end":{"line":482,"column":0}},"children":[{"type":"text","value":"In the ","key":"cDisl3n7AR"},{"type":"link","url":"/weak-formulation","children":[{"type":"text","value":"next notebook","key":"BtjRquux6X"}],"urlSource":"weak-formulation.ipynb","internal":true,"dataUrl":"/weak-formulation.json","protocol":"file","key":"ufeOadFktq"},{"type":"text","value":", we will explore how to use the weak formulation to discretize the DC equations.","key":"cerBFwMGNw"}],"key":"FjI0F0Y2MH"}],"data":{"id":"nb-cell-36","type":"notebook-content","iooxa":{"id":{"block":"idngyxmrLM3e3YKsmEZC","project":"5dxSs15hZtvQDKSzFgjP","version":1}}},"identifier":"nb-cell-36","label":"nb-cell-36","html_id":"nb-cell-36","key":"e7zarC5iyC"}],"key":"D8dwXNZElt"},"references":{"cite":{"order":[],"data":{}}},"footer":{},"domain":"http://localhost:3000"}},"actionData":null,"errors":null},"future":{"unstable_cssModules":false,"unstable_cssSideEffectImports":false,"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"unstable_vanillaExtract":false,"v2_errorBoundary":false,"v2_meta":false,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/tle-finitevolume/build/manifest-2E91AB14.js";
import * as route0 from "/tle-finitevolume/build/root-3VTM3HH5.js";
import * as route1 from "/tle-finitevolume/build/routes/$-OY73AADE.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/tle-finitevolume/build/entry.client-34LOLN62.js");</script></body></html>